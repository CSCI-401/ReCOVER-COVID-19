(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{425:function(e,a,t){},493:function(e,a,t){e.exports=t(761)},498:function(e,a,t){},661:function(e,a,t){},748:function(e,a,t){},749:function(e,a,t){},752:function(e,a,t){},761:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),i=t(38),s=t.n(i),c=(t(498),t(39)),o=t(37),l=t(72),u=t(71),d=(t(289),t(142)),h=(t(291),t(100)),m=(t(352),t(275)),p=(t(501),t(112)),f=(t(503),t(454)),v=(t(505),t(281)),y=(t(353),t(273)),g=(t(354),t(110)),b=(t(355),t(274)),S=(t(292),t(140)),D=t(124),k=t(125),E=t(156),C=t(51),O=(t(426),t(159)),w=t(81),A=t(427),M=t(220),j=t.n(M),x=t(264),I=t.n(x),P=t(144);var _=function(e){var a=e.series,t=e.lineGenerator,r=e.xScale,i=e.yScale;return a.map((function(e){var a=e.id,s=e.data,c=e.color,o=e.predicted,l=e.distancing,u={strokeWidth:3};return o&&(u.strokeDasharray=l?"6, 4":"2, 6"),n.a.createElement("path",{key:a,d:t(s.map((function(e){return{x:r(e.data.x),y:i(e.data.y)}}))),fill:"none",stroke:c,style:u})}))},N={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},V=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"parseDate",value:function(e){var a=e.split("-").map(Number),t=Object(w.a)(a,3),r=t[0],n=t[1],i=t[2];return new Date(r,n-=1,i)}},{key:"getCumulativeData",value:function(e){var a=this;return e.map((function(e){return{x:a.parseDate(e.date),y:e.value}}))}},{key:"getDeltaData",value:function(e,a){var t=this;return e.map((function(r,n){return 0===n?{x:t.parseDate(r.date),y:r.value-a}:{x:t.parseDate(r.date),y:r.value-e[n-1].value}}))}},{key:"processData",value:function(e,a){var t=a.statistic,r=a.yScale,n=a.initialVal,i="delta"===t?this.getDeltaData(e,n):this.getCumulativeData(e);return"log"===r&&(i=i.filter((function(e){e.x;return e.y>0}))),i}},{key:"getDataMax",value:function(){var e=this.props.data,a=0;return Object.keys(e).forEach((function(t){var r=e[t],n=r.observed,i=r.predictions;a=Math.max(a,Math.max.apply(Math,Object(E.a)(n.map((function(e){return e.value}))))),i.forEach((function(e){var t=e.time_series;a=Math.max(a,Math.max.apply(Math,Object(E.a)(t.map((function(e){return e.value})))))}))})),a}},{key:"getYAxisProps",value:function(){for(var e=this.props,a=e.statistic,t=e.yScale,r={format:function(e){return I()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===a?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},n=[],i=0;i<=Math.ceil(Math.log10(this.getDataMax()));i++)n.push(Math.pow(10,i));var s=Object(k.a)({},r,{tickValues:n});return"log"===t?{axisLeft:s,gridYValues:n,yScale:{type:"log",base:10,min:Math.min.apply(Math,n),max:Math.max.apply(Math,n)}}:{axisLeft:r,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,a=this.props.data,t=this.props,r=t.statistic,i=t.yScale,s=t.dataType,c=[],o=[];Object.keys(a).sort().forEach((function(t,n){var l=function(e){var a=[P.red.primary,P.gold.primary,P.lime.primary,P.cyan.primary,P.geekblue.primary,P.purple.primary,P.magenta.primary];return a[e%a.length]}(n),u="confirmed"==s?a[t].observed:a[t].observed_deaths;c.push({id:t,data:e.processData(u,{statistic:r,yScale:i,initialVal:0}),predicted:!1}),o.push(l),a[t].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(a){a.model.name;var n=a.distancing,s=a.time_series;c.push({id:"".concat(t," (").concat(a.model.name,", distancing=").concat(n,")"),data:e.processData(s,{statistic:r,yScale:i,initialVal:u[u.length-1].value}),predicted:!0,distancing:n}),o.push(l)}))}));var l="every week";if(c.length>0){var u=c[0].data[0].x,d=c[0].data[0].x;c.forEach((function(e){e.data.forEach((function(e){var a=e.x;u=Math.min(u,a),d=Math.max(d,a)}))})),u=j()(u),(d=j()(d)).diff(u,"days")>150&&(l="every month")}return n.a.createElement(A.a,Object.assign({data:c,colors:o,margin:{top:10,right:50,bottom:70,left:100},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:l,format:function(e){return j()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var a=e.slice;return n.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},n.a.createElement("div",null,j()(a.points[0].data.x).format("MMM Do YYYY")),a.points.map((function(e){return n.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},n.a.createElement("strong",null,e.serieId),"[",I()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",_,"slices","points","axes","legends"],theme:N}))}}]),t}(r.Component),R=t(84),T=t.n(R),B="https://dslab-covid19-backend.herokuapp.com/api",F=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var a="".concat(B,"/areas");T.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"models",value:function(e){var a="".concat(B,"/models");T.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"infection_models",value:function(e){var a="".concat(B,"/infection_models");T.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"death_models",value:function(e){var a="".concat(B,"/death_models");T.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"cumulative_infections",value:function(e){var a="".concat(B,"/cumulative_infections");T.a.get(a).then((function(a){return e(a.data)}))}},{key:"predict_all",value:function(e,a){var t="".concat(B,"/predict_all");T.a.get(t,{params:e}).then((function(e){return a(e.data)}))}},{key:"predict",value:function(e,a){var t="".concat(B,"/predict");T.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"getCurrentDate",value:function(e){var a="".concat(B,"/current_date");T.a.get(a).then((function(a){var t=a.data;e(t)}))}},{key:"checkHistory",value:function(e,a){var t="".concat(B,"/check_history");T.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"history_cumulative",value:function(e,a){var t="".concat(B,"/history_cumulative");T.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"scores_all",value:function(e,a){var t="".concat(B,"/scores_all");T.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"scores",value:function(e,a){var t="".concat(B,"/scores");T.a.get(t,{params:e}).then((function(e){a(e.data)}))}},{key:"latest_score_date",value:function(e){var a="".concat(B,"/latest_score_date");T.a.get(a).then((function(a){var t=a.data;e(t)}))}}]),e}();function G(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}function L(e){var a=e.split("/");return{country:a[0].trim(),state:2===a.length?a[1].trim():""}}var W=t(52),z=t(109),Y=t(191),U=t(192),q=t(335),H=t(336),J=t(337),Q=t(276);W.e(Q.a);var X=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(c.a)(this,t),(e=a.call(this)).onShowState=function(a){e.setState({showState:a})},e.modelAPI=new F,e.state={areasList:[],showState:!1},e.modelAPI.areas((function(a){return e.setState({areasList:a})})),e}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn)}},{key:"fetchData",value:function(e){var a=this;e&&""!==this.props.model?"cumulative"===this.props.statistic?this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:this.props.model},(function(e){console.log(e);var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.resetChart)})):this.modelAPI.history_cumulative({days:this.props.days},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.resetChart)})):this.props.days>0?this.modelAPI.predict_all({days:this.props.days,model:this.props.model},(function(e){a.props.days>1?a.modelAPI.predict_all({days:a.props.days-1,model:a.props.model},(function(t){var r=e.map((function(e,a){return{id:e.area.iso_2,value:e.value-t[a].value>0?Math.log(e.value-t[a].value):0,valueTrue:e.value-t[a].value,area:e.area}}));a.setState({heatmapData:r},a.resetChart)})):a.modelAPI.history_cumulative({days:a.props.days-1},(function(t){var r=e.map((function(e,a){return{id:e.area.iso_2,value:e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value>0?Math.log(e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value):0,valueTrue:e.value-t.find((function(a){return a.area.iso_2===e.area.iso_2})).value,area:e.area}}));a.setState({heatmapData:r},a.resetChart)}))})):this.modelAPI.history_cumulative({days:this.props.days,model:this.props.model},(function(e){a.modelAPI.history_cumulative({days:a.props.days-1,model:a.props.model},(function(t){var r=e.map((function(e,a){return{id:e.area.iso_2,value:e.value-t[a].value>0?Math.log(e.value-t[a].value):0,valueTrue:e.value-t[a].value,area:e.area}}));a.setState({heatmapData:r},a.resetChart)}))})):this.modelAPI.cumulative_infections((function(e){console.log(e);var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.createChart)}))}},{key:"initChart",value:function(){this.chart=W.d("chartdiv",z.a),this.chart.projection=new z.d.Mercator}},{key:"createChartSeries",value:function(e){var a=this.props.statistic,t=this.chart.series.push(new z.b),r=(t=Object.assign(t,e)).mapPolygons.template;"cumulative"===a?t.heatRules.push({property:"fill",target:r,min:W.c("#fcbba0"),max:W.c("#66000d"),minValue:0,maxValue:Math.log(5e6)}):t.heatRules.push({property:"fill",target:r,min:W.c("#fcbba0"),max:W.c("#66000d"),minValue:0,maxValue:Math.log(1e6)}),r.tooltipText="{name}: {valueTrue}",r.nonScalingStroke=!0,r.strokeWidth=.5,r.states.create("hover").properties.fill=W.c("#e43027"),r.cursorOverStyle=W.b.pointer;var n=this.props,i=n.onMapClick,s=n.onNoData;return r.events.on("hit",(function(e){var a=e.target.dataItem.dataContext,t=(a.id,a.value,a.area),r=a.name;t?i(t):s(r)})),t}},{key:"initChartInterface",value:function(){var e=this,a=this.state.showState;this.chart.zoomControl=new z.c,this.chart.zoomControl.cursorOverStyle=W.b.pointer;var t=this.chart.chartContainer.createChild(W.a);t.label.text="".concat(a?"Hide":"Show"," States/Provinces"),t.togglable=!0,t.padding(5,5,5,5),t.align="right",t.marginRight=15,t.cursorOverStyle=W.b.pointer,t.events.on("hit",(function(){e.onShowState(t.isActive);var a=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!a})),t.label.text="".concat(a?"Hide":"Show"," States/Provinces")}))}},{key:"createChart",value:function(){var e=this.state.heatmapData;this.initChart();this.createChartSeries({geodata:Y.a,exclude:["AQ"],data:e});var a=this.createChartSeries({geodata:q.a,data:e,disabled:!this.state.showState}),t=this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}),r=this.createChartSeries({geodata:H.a,data:e,disabled:!this.state.showState}),n=this.createChartSeries({geodata:J.a,data:e,disabled:!this.state.showState});this.stateSeries=[a,t,r,n],this.initChartInterface()}},{key:"resetChart",value:function(){var e=this.state.heatmapData,a=(this.createChartSeries({geodata:Y.a,exclude:["AQ"],data:e}),this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}));this.stateSeries=[a]}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return n.a.createElement("div",{id:"chartdiv"})}}]),t}(r.Component),K=(t(661),O.a.Option),$=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var r;return Object(c.a)(this,t),(r=a.call(this,e)).handleYScaleSelect=function(e){r.setState({yScale:e.target.value})},r.handleStatisticSelect=function(e){r.setState({statistic:e.target.value},(function(){r.reloadAll()}))},r.handleDataTypeSelect=function(e){"confirmed"===e.target.value?r.modelAPI.infection_models((function(a){return r.setState({modelsList:a,dataType:e.target.value})})):"death"===e.target.value&&r.modelAPI.death_models((function(a){return r.setState({modelsList:a,dataType:e.target.value})}))},r.componentWillMount=function(){r.addAreaByStr("US"),r.formRef=n.a.createRef(),r.modelAPI=new F,r.modelAPI.areas((function(e){return r.setState({areasList:e})})),r.modelAPI.infection_models((function(e){return r.setState({modelsList:e})})),r.modelAPI.getCurrentDate((function(e){return r.setState({currentDate:e[0].date})}))},r.bindRef=function(e){r.map=e},r.onAlertClose=function(){r.setState({noDataError:!1})},r.onNoData=function(e){r.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},r.generateMarks=function(){var e=r.state,a=e.currentDate,t=e.days,n=new Date("".concat(a,"T00:00")),i=new Date(2020,0,22);n.setDate(n.getDate(Date)+t);var s={};s[t]="".concat(n.getMonth()+1,"/").concat(n.getDate());for(var c=t+7;c<t+50&&c<=99;)n.setDate(n.getDate()+7),s[c]="".concat(n.getMonth()+1,"/").concat(n.getDate()),c+=7;for((n=new Date("".concat(a,"T00:00"))).setDate(n.getDate(Date)+t),n.setDate(n.getDate()-7),c=t-7;n>=i&&c>t-30;)s[c]="".concat(n.getMonth()+1,"/").concat(n.getDate()),n.setDate(n.getDate()-7),c-=7;return s},r.getDaysToFirstDate=function(){var e=r.state.currentDate,a=new Date("".concat(e,"T00:00")),t=new Date(2020,0,22);return Math.ceil(Math.abs(a-t)/864e5)},r.state={areas:r.props.areas||[],areasList:[],models:r.props.models||["SI-kJalpha - No under-reported positive cases(default)"],modelsList:[],currentDate:"",distancingOn:!0,distancingOff:!1,mainGraphData:{},days:10,dynamicMapOn:!1,dataType:"confirmed",statistic:"cumulative",yScale:"linear",noDataError:!1,errorDescription:""},r.addAreaByStr=r.addAreaByStr.bind(Object(C.a)(r)),r.removeAreaByStr=r.removeAreaByStr.bind(Object(C.a)(r)),r.onValuesChange=r.onValuesChange.bind(Object(C.a)(r)),r.onMapClick=r.onMapClick.bind(Object(C.a)(r)),r.onDaysToPredictChange=r.onDaysToPredictChange.bind(Object(C.a)(r)),r.switchDynamicMap=r.switchDynamicMap.bind(Object(C.a)(r)),r.onAlertClose=r.onAlertClose.bind(Object(C.a)(r)),r.onNoData=r.onNoData.bind(Object(C.a)(r)),r.generateMarks=r.generateMarks.bind(Object(C.a)(r)),r}return Object(o.a)(t,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(G(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var a=G(e);return this.state.areas.includes(a)}return!1}},{key:"addAreaByStr",value:function(e){var a=this,t=L(e);this.setState((function(a){return{areas:[].concat(Object(E.a)(a.areas),[e])}}),(function(){a.state.days>=0?a.modelAPI.predict({state:t.state,country:t.country,models:a.state.models,days:a.state.days,distancingOn:a.state.distancingOn,distancingOff:a.state.distancingOff},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})):a.modelAPI.checkHistory({state:t.state,country:t.country,days:a.state.days},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})),a.formRef.current.setFieldsValue({areas:a.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(a){return{areas:a.areas.filter((function(a){return a!==e})),mainGraphData:Object.keys(a.mainGraphData).filter((function(a){return a!==e})).reduce((function(e,t){return Object(k.a)({},e,Object(D.a)({},t,a.mainGraphData[t]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var a="".concat(e.name);return this.state.models.includes(a)}return!1}},{key:"onValuesChange",value:function(e,a){var t=this;if("socialDistancing"in e||"models"in e)this.setState({models:a.models,distancingOn:a.socialDistancing.includes("distancingOn"),distancingOff:a.socialDistancing.includes("distancingOff")},(function(){t.reloadAll()}));else{var r=this.state.areas,n=a.areas,i=n.filter((function(e){return!r.includes(e)})),s=r.filter((function(e){return!n.includes(e)}));i.forEach(this.addAreaByStr),s.forEach(this.removeAreaByStr)}}},{key:"onDaysToPredictChange",value:function(e){var a=this;this.state.areas;this.setState({days:e},(function(){a.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,a=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){a.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,a=this.state,t=a.areas,r=a.areasList,i=a.models,s=a.modelsList,c=a.days,o=a.mainGraphData,l=a.dynamicMapOn,u=a.dataType,D=a.statistic,k=a.yScale,E=a.noDataError,C=a.errorDescription;console.log(o);var w=this.generateMarks(),A=this.getDaysToFirstDate(),M=r.filter((function(a){return!e.areaIsSelected(a)})).map(G).sort().map((function(e){return n.a.createElement(K,{key:e}," ",e," ")})),j=s.filter((function(a){return!e.modelIsSelected(a)})).map((function(e){return n.a.createElement(K,{key:e.name},n.a.createElement(S.a,{title:e.description,placement:"right"},e.name))})),x=n.a.createElement("p",null,'The trend until March 18th has been used as a proxy for "Social distancing off". ',n.a.createElement("br",null),"For modeling details, please see:",n.a.createElement("a",{href:"https://arxiv.org/abs/2004.11372"}," https://arxiv.org/abs/2004.11372"),".");return n.a.createElement("div",{className:"covid-19-predict"},n.a.createElement(d.a,{type:"flex",justify:"space-around"},n.a.createElement(h.a,{span:10},E?n.a.createElement(b.a,{message:"".concat(C),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,n.a.createElement("div",{className:"form-wrapper"},n.a.createElement(g.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:t,models:i,days:0,socialDistancing:["distancingOn"]}},n.a.createElement(g.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},n.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},M)),n.a.createElement(g.a.Item,{label:"Models:",name:"models",rules:[{required:!0,message:"Please select a prediction model!"}]},n.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Prediction Models"},j)),n.a.createElement(g.a.Item,{label:"Date to Predict",name:"days",rules:[{required:!0,message:"Please select number of days!"}]},n.a.createElement(y.a,{marks:w,min:c-30>=-A?c-30:-A,initialValue:c,max:c+50<=99?c+50:99,onAfterChange:this.onDaysToPredictChange})),n.a.createElement(f.a,{content:x,title:"Social Distancing Clarification",placement:"topLeft"},n.a.createElement(g.a.Item,{label:"Social Distancing",name:"socialDistancing"},n.a.createElement(v.a.Group,null,n.a.createElement(v.a,{defaultChecked:!0,value:"distancingOn"},"Current Trend"),n.a.createElement(v.a,{value:"distancingOff"},"Social Distancing Off"))))),n.a.createElement("div",null,"Data Type:\xa0\xa0",n.a.createElement(p.a.Group,{value:u,onChange:this.handleDataTypeSelect},n.a.createElement(p.a,{value:"confirmed"},"Confirmed Cases"),n.a.createElement(p.a,{value:"death"},"Deaths"))),n.a.createElement("br",null),n.a.createElement("div",null,"Statistic:\xa0\xa0",n.a.createElement(p.a.Group,{value:D,onChange:this.handleStatisticSelect},n.a.createElement(p.a,{value:"cumulative"},"Cumulative Cases"),n.a.createElement(p.a,{value:"delta"},"New Cases"))),n.a.createElement("br",null),n.a.createElement("div",null,"Scale:\xa0\xa0",n.a.createElement(p.a.Group,{value:k,onChange:this.handleYScaleSelect},n.a.createElement(p.a,{value:"linear"},"linear"),n.a.createElement(p.a,{value:"log"},"logarithmic"))),n.a.createElement("br",null),n.a.createElement("p",null,"Dynamic Map:\xa0\xa0",n.a.createElement(m.a,{onChange:this.switchDynamicMap})))),n.a.createElement(h.a,{span:14},n.a.createElement("div",{className:"map-wrapper"},n.a.createElement(X,{className:"map",triggerRef:this.bindRef,dynamicMapOn:l,days:c,model:null==this.state.models||0===this.state.models.length?"":this.state.models[this.state.models.length-1],onMapClick:this.onMapClick})))),t.length?n.a.createElement(d.a,null,n.a.createElement(h.a,{span:24},n.a.createElement("div",{className:"graph-wrapper"},n.a.createElement(V,{data:o,dataType:u,onNoData:this.onNoData,statistic:D,yScale:k})))):null)}}]),t}(r.PureComponent),Z=(t(748),t(425),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"page-wrapper"},n.a.createElement("div",{className:"article"},n.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),n.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is a NSF-funded project on COVID-19 forecasting directed by Viktor K. Prasanna (",n.a.createElement("a",{className:"article-anchor",href:"mailto:prasanna@usc.edu"},"prasanna@usc.edu"),") and Ajitesh Srivastava (",n.a.createElement("a",{className:"article-anchor",href:"mailto:ajiteshs@usc.edu"},"ajiteshs@usc.edu"),") from the Data Science Lab in the University of Southern California."),n.a.createElement("h2",null,"Our Model"),n.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called SI-kJalpha -- Heterogeneous Infection Rate with Human Mobility, which is a preliminary version of what we have successfully used during ",n.a.createElement("a",{className:"article-anchor",href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". By linearizing the model and using weighted least squares, our model is able to quickly adapt to changing trends and provide extremely accurate predictions of confirmed cases at the level of countries and states of the United States. Training the model to forecast also enables learning characteristics of the epidemic. In particular, we have shown that changes in model parameters over time can help us quantify how well a state or a country has responded to the epidemic. The variations in parameters also allow us to forecast different scenarios such as what would happen if we were to disregard social distancing suggestions. This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),n.a.createElement("p",{className:"article-paragraph"},"Details of our initial approach can be found in our ",n.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"webinar"),"."),n.a.createElement("p",{className:"article-paragraph"},"The Github repository for this project is ",n.a.createElement("a",{className:"article-anchor",href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"},"publicly available")," ."),n.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available on ",n.a.createElement("a",{className:"article-anchor",href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),"."),n.a.createElement("p",{className:"article-paragraph"},"The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu, and Bob Xiaochen Yang."),n.a.createElement("h2",null,"USC Data Science Lab"),n.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",n.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),"."),n.a.createElement("h2",null,"Related Publications"),n.a.createElement("p",{className:"disclaimer"},n.a.createElement("b",null,"Disclaimer:")," The following papers may have copyright restrictions. Downloads will have to adhere to these restrictions. They may not be reposted without explicit permission from the copyright holder. Any opinions, findings, and conclusions or recommendations expressed in these materials are those of the author(s) and do not necessarily reflect the views of the sponsors including National Science Foundation (NSF), Defense Advanced Research Projects Agency (DARPA), and any other sponsors listed in the publications."),n.a.createElement("ol",{className:"article-paragraph"},n.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",n.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2004.11372",target:"_blank"}," \u201cLearning to Forecast and Forecasting to Learn from the COVID-19 Pandemic\u201d")," [arXiv]."))))}}]),t}(r.Component));W.e(Q.a);var ee=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(c.a)(this,t),(e=a.call(this)).onShowState=function(a){e.setState({showState:a})},e.modelAPI=new F,e.state={areasList:[],showState:!1},e.modelAPI.areas((function(a){return e.setState({areasList:a})})),e}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.triggerRef(this)}},{key:"fetchData",value:function(e){var a=this;e?this.modelAPI.scores_all({weeks:this.props.weeks},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));a.setState({heatmapData:t},a.createChart)})):this.modelAPI.scores_all({weeks:this.props.latestWeek},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));a.setState({heatmapData:t},a.createChart)}))}},{key:"initChart",value:function(){this.chart=W.d("chartdiv",z.a),this.chart.projection=new z.d.Mercator}},{key:"createChartSeries",value:function(e){this.props.statistic;var a=this.chart.series.push(new z.b),t=(a=Object.assign(a,e)).mapPolygons.template;a.heatRules.push({property:"fill",target:t,min:W.c("#85DB50"),max:W.c("#F33A21"),minValue:0,maxValue:4}),t.tooltipText="{name}: {value} (conf: {conf})",t.nonScalingStroke=!0,t.strokeWidth=.5,t.states.create("hover").properties.fill=W.c("#83FE00"),t.cursorOverStyle=W.b.pointer;var r=this.props,n=r.onMapClick,i=r.onNoData;return t.events.on("hit",(function(e){var a=e.target.dataItem.dataContext,t=(a.id,a.value,a.area),r=a.name;t?n(t):i(r)})),a}},{key:"initChartInterface",value:function(){var e=this,a=this.state.showState;this.chart.zoomControl=new z.c,this.chart.zoomControl.cursorOverStyle=W.b.pointer;var t=this.chart.chartContainer.createChild(W.a);t.label.text="".concat(a?"Hide":"Show"," States/Provinces"),t.togglable=!0,t.padding(5,5,5,5),t.align="right",t.marginRight=15,t.cursorOverStyle=W.b.pointer,t.events.on("hit",(function(){e.onShowState(t.isActive);var a=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!a})),t.label.text="".concat(a?"Hide":"Show"," States/Provinces")}))}},{key:"createChart",value:function(){var e=this.state.heatmapData;this.initChart();this.createChartSeries({geodata:Y.a,exclude:["AQ"],data:e});var a=this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState});this.stateSeries=[a],this.initChartInterface()}},{key:"resetChart",value:function(){var e=this.state.heatmapData,a=(this.createChartSeries({geodata:Y.a,exclude:["AQ"],data:e}),this.createChartSeries({geodata:U.a,data:e,disabled:!this.state.showState}));this.stateSeries=[a]}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return n.a.createElement("div",{id:"chartdiv"})}}]),t}(r.Component),ae=(t(749),O.a.Option),te=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var r;return Object(c.a)(this,t),(r=a.call(this,e)).componentDidMount=function(){r.formRef=n.a.createRef(),r.modelAPI=new F,r.modelAPI.latest_score_date((function(e){return r.setState({latestDate:e[0].date,weeks:e[0].weeks,latestWeek:e[0].weeks},(function(){r.addAreaByStr("US"),r.formRef.current.setFieldsValue({weeks:r.state.latestWeek}),r.map.fetchData(r.state.dynamicMapOn)}))})),r.modelAPI.areas((function(e){return r.setState({areasList:e})}))},r.bindRef=function(e){r.map=e},r.onAlertClose=function(){r.setState({noDataError:!1})},r.onNoData=function(e){r.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},r.generateMarks=function(){for(var e=r.state.latestDate,a=new Date("".concat(e,"T00:00")),t=new Date(2020,2,11),n={},i=0;t<=a;)n[i]="".concat(t.getMonth()+1,"/").concat(t.getDate()),t.setDate(t.getDate(Date)+7),i++;return n},r.state={areas:r.props.areas||[],areasList:[],latestDate:"",mainGraphData:{},weeks:r.props.weeks||0,latestWeek:0,dynamicMapOn:!1,noDataError:!1,errorDescription:""},r.addAreaByStr=r.addAreaByStr.bind(Object(C.a)(r)),r.removeAreaByStr=r.removeAreaByStr.bind(Object(C.a)(r)),r.onValuesChange=r.onValuesChange.bind(Object(C.a)(r)),r.onMapClick=r.onMapClick.bind(Object(C.a)(r)),r.onWeeksChange=r.onWeeksChange.bind(Object(C.a)(r)),r.switchDynamicMap=r.switchDynamicMap.bind(Object(C.a)(r)),r.onAlertClose=r.onAlertClose.bind(Object(C.a)(r)),r.onNoData=r.onNoData.bind(Object(C.a)(r)),r.generateMarks=r.generateMarks.bind(Object(C.a)(r)),r}return Object(o.a)(t,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(G(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var a=G(e);return this.state.areas.includes(a)}return!1}},{key:"addAreaByStr",value:function(e){var a=this,t=L(e);this.setState((function(a){return{areas:[].concat(Object(E.a)(a.areas),[e])}}),(function(){a.modelAPI.scores({state:t.state,country:t.country,weeks:a.state.weeks},(function(t){a.setState((function(a){return{mainGraphData:Object(k.a)({},a.mainGraphData,Object(D.a)({},e,t))}}))})),a.formRef.current.setFieldsValue({areas:a.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(a){return{areas:a.areas.filter((function(a){return a!==e})),mainGraphData:Object.keys(a.mainGraphData).filter((function(a){return a!==e})).reduce((function(e,t){return Object(k.a)({},e,Object(D.a)({},t,a.mainGraphData[t]))}),{})}}))}},{key:"onValuesChange",value:function(e,a){var t=this.state.areas,r=a.areas,n=r.filter((function(e){return!t.includes(e)})),i=t.filter((function(e){return!r.includes(e)}));n.forEach(this.addAreaByStr),i.forEach(this.removeAreaByStr)}},{key:"onWeeksChange",value:function(e){var a=this;this.setState({weeks:e},(function(){a.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,a=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){a.forEach(e.addAreaByStr),e.state.dynamicMapOn&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,a=this.state,t=a.areas,r=a.areasList,i=a.weeks,s=a.mainGraphData,c=a.dynamicMapOn,o=a.latestWeek,l=a.noDataError,u=a.errorDescription,p=r.filter((function(a){return!e.areaIsSelected(a)})).map(G).sort().map((function(e){return n.a.createElement(ae,{key:e}," ",e," ")})),f=this.generateMarks();return n.a.createElement("div",{className:"score-page"},n.a.createElement(d.a,{type:"flex",justify:"space-around"},n.a.createElement(h.a,{span:10},l?n.a.createElement(b.a,{message:"".concat(u),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,n.a.createElement("div",{className:"form-wrapper"},n.a.createElement(g.a,{ref:this.formRef,onValuesChange:this.onValuesChange},n.a.createElement(g.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},n.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},p)),n.a.createElement(g.a.Item,{label:"Week to check",name:"weeks",rules:[{required:!0,message:"Please select the week you want to see"}]},n.a.createElement(y.a,{marks:f,min:0,initialValue:o,max:o,onAfterChange:this.onWeeksChange}))),n.a.createElement("p",null,"Dynamic Map:\xa0\xa0",n.a.createElement(m.a,{onChange:this.switchDynamicMap})))),n.a.createElement(h.a,{span:14},n.a.createElement("div",{className:"map-wrapper"},n.a.createElement(ee,{className:"score-map",triggerRef:this.bindRef,dynamicMapOn:c,weeks:i,latestWeek:o-1,onMapClick:this.onMapClick,onNoData:this.onNoData})))),t.length?n.a.createElement(d.a,null,n.a.createElement(h.a,{span:24},n.a.createElement("div",{className:"graph-wrapper"},n.a.createElement(V,{data:s,statistic:"cumulative",yScale:"linear",dataType:"confirmed"})))):null)}}]),t}(r.PureComponent),re=t(453),ne=t(53),ie=(t(750),t(221)),se=(t(752),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var r;return Object(c.a)(this,t),(r=a.call(this,e)).handleItemClick=function(e){var a=r.props,t=a.redirectForecast,n=a.redirectAbout,i=a.redirectScore,s=e.key;r.setState({activeItem:e.key}),"forecast"===s?t():"information"===s?n():i()},r.state={activateItem:"forecast"},r}return Object(o.a)(t,[{key:"render",value:function(){return n.a.createElement(d.a,{className:"navbar-container"},n.a.createElement(h.a,null,n.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})),n.a.createElement(h.a,null,n.a.createElement(ie.a,{theme:"light",mode:"horizontal",onClick:this.handleItemClick,defaultSelectedKeys:["forecast"]},n.a.createElement(ie.a.Item,{key:"forecast"},"COVID-19 Forecast"),n.a.createElement(ie.a.Item,{key:"quarantine-score"},"Social Distancing Score"),n.a.createElement(ie.a.Item,{key:"information"},"About Us"))))}}]),t}(r.Component)),ce=(t(759),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var r;return Object(c.a)(this,t),(r=a.call(this,e)).redirectForecast=function(){r.setState({redirectForecast:!0,redirectAbout:!1,redirectScore:!1})},r.redirectAbout=function(){r.setState({redirectForecast:!1,redirectAbout:!0,redirectScore:!1})},r.redirectScore=function(){r.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!0})},r.state={redirectForecast:!1,redirectAbout:!1,redirectScore:!1},r}return Object(o.a)(t,[{key:"render",value:function(){var e=this.state,a=e.redirectForecast,t=e.redirectAbout,r=e.redirectScore;return n.a.createElement(re.a,null,a?n.a.createElement(ne.a,{to:"/ReCOVER-COVID-19"}):null,r?n.a.createElement(ne.a,{to:"/ReCOVER-COVID-19/score"}):null,t?n.a.createElement(ne.a,{to:"/ReCOVER-COVID-19/about"}):null,n.a.createElement(se,{redirectForecast:this.redirectForecast,redirectScore:this.redirectScore,redirectAbout:this.redirectAbout}),n.a.createElement(ne.d,null,n.a.createElement(ne.b,{exact:!0,path:"/ReCOVER-COVID-19",render:function(e){return n.a.createElement($,e)}}),n.a.createElement(ne.b,{exact:!0,path:"/ReCOVER-COVID-19/score",render:function(e){return n.a.createElement(te,e)}}),n.a.createElement(ne.b,{exact:!0,path:"/ReCOVER-COVID-19/about",render:function(e){return n.a.createElement(Z,e)}})))}}]),t}(r.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[493,1,3]]]);
//# sourceMappingURL=main.f4931241.chunk.js.map