{"version":3,"sources":["covid19graph.js","modelapi.js","covid19util.js","covid19map.js","covid19predict.js","aboutus.js","scorePage/scoreGraph.js","scorePage/newScoreGraph.js","scorePage/scoreMap.js","scorePage/scorePage.js","navbar/navbar.js","leaderboard/leaderboard.js","all_page_pdf/all_page_pdf.js","covid19app.js","serviceWorker.js","index.js","../node_modules/pdfjs-dist/build sync","leaderboard/img/all_graph.png","highlights.pdf","leaderboard/img/nyt_graph.png","leaderboard/img/jhu_graph.png","leaderboard/img/usf_graph.png"],"names":["DashedLine","series","lineGenerator","xScale","yScale","map","id","data","color","predicted","distancing","style","strokeWidth","strokeDasharray","key","d","x","y","fill","stroke","theme","axis","ticks","text","fontSize","legend","legends","Covid19Graph","dateStr","split","Number","year","month","day","Date","parseDate","date","value","initialVal","i","params","statistic","retData","this","getDeltaData","getCumulativeData","filter","props","max","Object","keys","forEach","area","observed","predictions","Math","p","timeSeries","time_series","linearAxisLeft","format","numeral","orient","tickSize","tickPadding","tickRotation","legendOffset","legendPosition","logTickValues","ceil","log10","getDataMax","push","pow","logAxisLeft","tickValues","axisLeft","gridYValues","type","base","min","dataType","chartData","colors","sort","idx","lineColor","index","red","gold","green","blue","volcano","yellow","cyan","purple","organge","lime","geekblue","magenta","length","getLineColor","observedConfirmed","observedDeath","observed_deaths","includes","processData","modelName","model","name","isDeathModel","substring","augmented_timeSeries","concat","minDate","maxDate","moment","diff","margin","top","right","bottom","left","precision","axisBottom","getYAxisProps","enableSlices","sliceTooltip","slice","background","padding","border","points","point","serieColor","serieId","yFormatted","pointSize","pointLabel","pointLabelYOffset","anchor","direction","justify","translateX","translateY","itemsSpacing","itemDirection","itemWidth","itemHeight","itemOpacity","symbolSize","symbolShape","symbolBorderColor","effects","on","itemBackground","layers","Component","API_BASE_URL","process","ModelAPI","callback","endpoint","axios","get","then","res","allAreas","allModels","infectionModels","deathModels","currentDate","latestDate","total_confirmed","Global","TotalConfirmed","total_deaths","TotalDeaths","totalConfirmed","totalDeaths","areaToStr","a","country","state","strToArea","s","words","trim","am4core","am4themes_animated","Covid19Map","onShowState","setState","showState","modelAPI","areasList","worldSeries","usaSeries","chinaSeries","canadaSeries","austriliaSeries","areas","triggerRef","fetchData","dynamicMapOn","confirmed_model","death_model","cumulative_infections","cumulativeInfections","heatmapData","iso_2","log","percentage","valueTrue","initChart","cumulative_death","days","cumulativeDeath","resetChart","predict_all","history_cumulative","historyCumulative","value_percentage","death_percentage","deathValue","previousCumulative","find","historyInfections","nextDayCumulative","chart","am4maps","projection","Mercator","createChartSeries","geodata","am4geodata_worldLow","exclude","am4geodata_chinaLow","disabled","am4geodata_usaLow","am4geodata_canadaLow","australiaSeries","am4geodata_australiaLow","stateSeries","initChartInterface","seriesProps","polygonTemplate","assign","mapPolygons","template","heatRules","property","target","minValue","maxValue","tooltipText","nonScalingStroke","states","create","properties","cursorOverStyle","pointer","onMapClick","onNoData","events","e","dataItem","dataContext","zoomControl","button","chartContainer","createChild","label","togglable","align","marginRight","isActive","dispose","Option","Covid19Predict","handleYScaleSelect","handleStatisticSelect","handleDataTypeSelect","handleMapShownSelect","mapShown","componentWillMount","addAreaByStr","formRef","React","createRef","infection_models","modelsList","death_models","prevState","getCurrentDate","firstDate","real_time","global","bindRef","ref","onAlertClose","noDataError","errorDescription","generateMarks","beginDate","setDate","getDate","marks","getMonth","getDaysToFirstDate","beginningDate","abs","toggleControlInstructions","showControlInstructions","toggleMapInstructions","showMapInstructions","models","current","worst_effort","best_effort","mainGraphData","bind","removeAreaByStr","onValuesChange","onDaysToPredictChange","switchDynamicMap","areaIsSelected","newAreaStr","areaStr","areaObj","predict","checkHistory","setFieldsValue","targetAreaStr","reduce","newMainGraphData","newModelStr","changedValues","allValues","socialDistancing","reloadAll","prevAreas","newAreas","areasToAdd","areasToRemove","checked","daysToFirstDate","countryOptions","modelOptions","modelIsSelected","title","description","placement","CONTROL_INSTRUCTIONS","className","href","data_type","statistics","scale","MAP_INSTRUCTION","dynamicMap","radioGroup","overview","today","dd","String","padStart","getFullYear","toString","replace","confirmed_model_map","death_model_map","message","closable","onClose","span","initialValues","content","visible","Item","rules","required","mode","width","placeholder","initialValue","onAfterChange","step","Group","defaultChecked","defaultValue","onChange","onClick","PureComponent","AboutUs","NewScoreGraph","parseData","scoreType","firstArea","observed_rt","dataSet","conf","observed_mrf","strokeColor","lines","dataKey","height","dy","position","angle","iconSize","ScoreMap","args","arguments","scores_all","weeks","scores","updateChart","all_mrf_scores","latestWeek","ScorePage","componentDidMount","latest_score_date","lastDate","handleScoreTypeSelect","onWeeksChange","formatted_current_date","NavBar","handleItemClick","redirectForecast","redirectAbout","redirectScore","redirectLeaderboard","redirectHighlights","activeItem","activateItem","url","window","location","src","alt","defaultSelectedKeys","jhu","runningAvgRankings","link","RMSE","recentRankings","NaN","Leaderboard","number","icon_src","itemLayout","dataSource","renderItem","item","Meta","avatar","getAvatar","indexOf","all_graph","AllPages","useState","numPages","setNumPages","onDocumentLoadSuccess","document","querySelectorAll","layer","transform","pdf","monitorHeight","refreshRate","refreshMode","render","size","file","options","workerSrc","onLoadSuccess","Array","from","el","pageNumber","pdfjs","GlobalWorkerOptions","version","Covid19App","basename","to","exact","path","Boolean","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","console","webpackEmptyContext","req","Error","code","resolve","module","exports"],"mappings":"ijBAwCA,IAAMA,EAAa,SAAC,GAA+C,IAA7CC,EAA4C,EAA5CA,OAAQC,EAAoC,EAApCA,cAAeC,EAAqB,EAArBA,OAAQC,EAAa,EAAbA,OACnD,OAAOH,EAAOI,KAAI,YAAiD,IAA9CC,EAA6C,EAA7CA,GAAIC,EAAyC,EAAzCA,KAAMC,EAAmC,EAAnCA,MAAOC,EAA4B,EAA5BA,UAAWC,EAAiB,EAAjBA,WAC3CC,EAAQ,CACVC,YAAa,GAaf,OATIH,IAEAE,EAAME,gBADJH,EACsB,OAGA,QAK1B,0BACEI,IAAKR,EACLS,EAAGb,EACDK,EAAKF,KAAI,SAAAU,GAAC,MAAK,CACbC,EAAGb,EAAOY,EAAER,KAAKS,GACjBC,EAAGb,EAAOW,EAAER,KAAKU,QAGrBC,KAAK,OACLC,OAAQX,EACRG,MAAOA,QAMTS,EAAQ,CACZC,KAAM,CACJC,MAAO,CACLC,KAAM,CACJC,SAAU,KAGdC,OAAQ,CACNF,KAAM,CACJC,SAAU,MAIhBE,QAAS,CACPH,KAAM,CACJC,SAAU,MA8XDG,E,wKAxXHC,GAAU,IAAD,EACQA,EAAQC,MAAM,KAAKxB,IAAIyB,QAD/B,mBACZC,EADY,KACNC,EADM,KACCC,EADD,KAIjB,OAAO,IAAIC,KAAKH,EADhBC,GAAS,EACoBC,K,wCAOb1B,GAAO,IAAD,OACtB,OAAOA,EAAKF,KAAI,SAAAU,GAAC,MAAK,CACpBC,EAAG,EAAKmB,UAAUpB,EAAEqB,MACpBnB,EAAGF,EAAEsB,Y,mCAUI9B,EAAM+B,GAAa,IAAD,OAC7B,OAAO/B,EAAKF,KAAI,SAACU,EAAGwB,GAClB,OAAU,IAANA,EACK,CACLvB,EAAG,EAAKmB,UAAUpB,EAAEqB,MACpBnB,EAAGF,EAAEsB,MAAQC,GAIV,CACLtB,EAAG,EAAKmB,UAAUpB,EAAEqB,MACpBnB,EAAGF,EAAEsB,MAAQ9B,EAAKgC,EAAI,GAAGF,Y,kCAOnB9B,EAAMiC,GAAS,IACjBC,EAAkCD,EAAlCC,UAAWrC,EAAuBoC,EAAvBpC,OAAQkC,EAAeE,EAAfF,WAGvBI,EACY,UAAdD,EACIE,KAAKC,aAAarC,EAAM+B,GACxBK,KAAKE,kBAAkBtC,GAQ7B,MAJe,QAAXH,IACFsC,EAAUA,EAAQI,QAAO,cAAG9B,EAAH,SAAMC,EAAY,MAGtCyB,I,mCAOK,IACJnC,EAASoC,KAAKI,MAAdxC,KAEJyC,EAAM,EAYV,OAVAC,OAAOC,KAAK3C,GAAM4C,SAAQ,SAAAC,GAAS,IAAD,EACE7C,EAAK6C,GAA/BC,EADwB,EACxBA,SAAUC,EADc,EACdA,YAClBN,EAAMO,KAAKP,IAAIA,EAAKO,KAAKP,IAAL,MAAAO,KAAI,YAAQF,EAAShD,KAAI,qBAAGgC,YAEhDiB,EAAYH,SAAQ,SAAAK,GAClB,IAAMC,EAAaD,EAAEE,YACrBV,EAAMO,KAAKP,IAAIA,EAAKO,KAAKP,IAAL,MAAAO,KAAI,YAAQE,EAAWpD,KAAI,qBAAGgC,kBAI/CW,I,sCAuBP,IAhBe,IAAD,EACgBL,KAAKI,MAA3BN,EADM,EACNA,UAAWrC,EADL,EACKA,OAEbuD,EAAiB,CAErBC,OAAQ,SAAA3C,GAAC,OAAI4C,IAAQ5C,GAAG2C,OAAO,WAC/BE,OAAQ,OACRC,SAAU,EACVC,YAAa,EACbC,aAAc,EACdxC,OAAsB,UAAdgB,EAAwB,YAAc,mBAC9CyB,cAAe,GACfC,eAAgB,UAGdC,EAAgB,GACX7B,EAAI,EAAGA,GAAKgB,KAAKc,KAAKd,KAAKe,MAAM3B,KAAK4B,eAAgBhC,IAC7D6B,EAAcI,KAAKjB,KAAKkB,IAAI,GAAIlC,IAKlC,IAAMmC,EAAW,eACZf,EADY,CAEfgB,WAAYP,IAMd,MAAe,QAAXhE,EACK,CACLwE,SAAUF,EACVG,YAAaT,EACbhE,OAAQ,CACN0E,KAAM,MACNC,KAAM,GACNC,IAAKzB,KAAKyB,IAAL,MAAAzB,KAAYa,GACjBpB,IAAKO,KAAKP,IAAL,MAAAO,KAAYa,KAKhB,CACLQ,SAAUjB,EACVvD,OAAQ,CACN0E,KAAM,SACNE,IAAK,OACLhC,IAAK,W,+BAKD,IAAD,OACDzC,EAASoC,KAAKI,MAAdxC,KADC,EAEiCoC,KAAKI,MAArCN,EAFD,EAECA,UAAWrC,EAFZ,EAEYA,OAAQ6E,EAFpB,EAEoBA,SAEvBC,EAAY,GAEZC,EAAS,GAIblC,OAAOC,KAAK3C,GACT6E,OACAjC,SAAQ,SAACC,EAAMiC,GACd,IAAMC,EAnOd,SAAsBC,GACpB,IAAMJ,EAAS,CACbK,MACAC,OACAC,QACAC,OACAC,UACAC,SACAC,OACAC,SACAC,UACAC,OACAC,WACAC,WAGF,OAAOhB,EAAOI,EAAQJ,EAAOiB,QAmNLC,CAAahB,GACzBiB,EAAoB/F,EAAK6C,GAAMC,SAC/BkD,EAAgBhG,EAAK6C,GAAMoD,gBAE7BvB,EAASwB,SAAS,eAEpBvB,EAAUV,KAAK,CACblE,GAAI8C,EACJ7C,KAAM,EAAKmG,YAAYJ,EAAmB,CACxC7D,UAAWA,EACXrC,OAAQA,EACRkC,WAAY,IAId7B,WAAW,IAGb0E,EAAOX,KAAKc,EAAU,KAEpBL,EAASwB,SAAS,WAGpBvB,EAAUV,KAAK,CACblE,GAAG,GAAD,OAAK8C,EAAL,UACF7C,KAAM,EAAKmG,YAAYH,EAAe,CACpC9D,UAAWA,EACXrC,OAAQA,EACRkC,WAAY,IAId7B,WAAW,IAGb0E,EAAOX,KAAKc,EAAU,KAKxB/E,EAAK6C,GAAME,YACRR,QAAO,SAAAU,GAAC,OAAIA,EAAEE,YAAY0C,OAAS,KACnCjD,SAAQ,SAACK,EAAE6B,GACV,IAAMsB,EAAYnD,EAAEoD,MAAMC,KACpBC,EAA8C,eAA/BH,EAAUI,UAAU,EAAG,KAAwBJ,EAAUF,SAAS,oBACjF/F,EAAa8C,EAAE9C,WACf+C,EAAaD,EAAEE,YAEjBsD,EAAuB,GAC3B,GAAI/B,EAASwB,SAAS,UAAYK,EAEhCE,EAAuB,CAACT,EAAcA,EAAcH,OAAS,IAAIa,OAAOxD,OAErE,KAAIwB,EAASwB,SAAS,cAAiBK,EAM1C,OAJAE,EAAuB,CAACV,EAAkBA,EAAkBF,OAAS,IAAIa,OAAOxD,GAMlFyB,EAAUV,KAAK,CACblE,GAAG,GAAD,OAAK8C,EAAL,aAAcuD,EAAd,wBAAuCjG,EAAvC,KAGFH,KAAM,EAAKmG,YAAYM,EAAsB,CAC3CvE,UAAWA,EACXrC,OAAQA,EACRkC,WAAYwE,EAAaP,EAAcA,EAAcH,OAAS,GAAG/D,MAAMiE,EAAkBA,EAAkBF,OAAS,GAAG/D,QAIzH5B,WAAW,EAGXC,WAAYA,IAEV2E,GAAO,EAETF,EAAOX,KAAKc,EAAU,EAAED,IAEjBA,GAAO,EAEdF,EAAOX,KAAKc,EAAU,EAAID,IAK1BF,EAAOX,KAAKc,EAAUD,EAAI,WAMpC,IAAIV,EAAa,aAEjB,GAAIO,EAAUkB,OAAS,EAAG,CAExB,IAAIc,EAAUhC,EAAU,GAAG3E,KAAK,GAAGS,EAC/BmG,EAAUjC,EAAU,GAAG3E,KAAK,GAAGS,EAEnCkE,EAAU/B,SAAQ,YAAc,EAAX5C,KACd4C,SAAQ,YAAY,IAATnC,EAAQ,EAARA,EACdkG,EAAU3D,KAAKyB,IAAIkC,EAASlG,GAC5BmG,EAAU5D,KAAKP,IAAImE,EAASnG,SAIhCkG,EAAUE,IAAOF,IACjBC,EAAUC,IAAOD,IAGUE,KAAKH,EAAS,QACxB,MACfvC,EAAa,eAIjB,OACE,kBAAC,IAAD,eACEpE,KAAM2E,EACNC,OAAQA,EAERmC,OAAQ,CAAEC,IAAK,GAAIC,MAAO,GAAIC,OAAQ,GAAIC,KAAM,KAChDvH,OAAQ,CACN2E,KAAM,OACNlB,OAAQ,SACR+D,UAAW,OAEbC,WAAY,CAGVjD,WAAYA,EAGZf,OAAQ,SAAAxB,GACN,OAAOgF,IAAOhF,GAAMwB,OAAO,QAE7BE,OAAQ,SACRC,SAAU,EACVC,YAAa,EACbC,aAAc,EACdxC,OAAQ,OACRyC,aAAc,GACdC,eAAgB,WAGdxB,KAAKkF,gBA5BX,CA6BEC,aAAa,IACbC,aAAc,YAAgB,IAAbC,EAAY,EAAZA,MACf,OACE,yBACErH,MAAO,CACLsH,WAAY,QACZC,QAAS,WACTC,OAAQ,mBAGV,6BAGEf,IAAOY,EAAMI,OAAO,GAAG7H,KAAKS,GAAG4C,OAAO,gBAEvCoE,EAAMI,OAAO/H,KAAI,SAAAgI,GAAK,OACrB,yBACEvH,IAAKuH,EAAM/H,GACXK,MAAO,CACLH,MAAO6H,EAAMC,WACbJ,QAAS,UAGX,gCAASG,EAAME,SAPjB,IAQG1E,IAAQwE,EAAM9H,KAAKiI,YAAY5E,OAAO,UARzC,UAcR6E,UAAW,EACXC,WAAW,IACXC,mBAAoB,GACpBjH,QAAS,CACP,CACEkH,OAAQ,WACRC,UAAW,SACXC,SAAS,EACTC,WAAY,EACZC,WAAY,EACZC,aAAc,EACdC,cAAe,gBACfC,UAAW,GACXC,WAAY,GACZC,YAAa,IACbC,WAAY,GACZC,YAAa,SACbC,kBAAmB,oBACnBC,QAAS,CACP,CACEC,GAAI,QACJ/I,MAAO,CACLgJ,eAAgB,qBAChBN,YAAa,OAMvBO,OAAQ,CACN,OACA,UACA,QACA,YACA5J,EACA,SACA,SACA,OACA,WAEFoB,MAAOA,S,GAnXYyI,a,iBC1FrBC,EAAeC,kDA+KNC,E,oGA5KDC,M,4BAENA,GACJ,IAAMC,EAAQ,UAAMJ,EAAN,UACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAMC,EAAWD,EAAI/J,KACrB0J,EAASM,Q,6BAINN,GACL,IAAMC,EAAQ,UAAMJ,EAAN,WACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAME,EAAYF,EAAI/J,KACtB0J,EAASO,Q,uCAIIP,GACf,IAAMC,EAAQ,UAAMJ,EAAN,qBACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAMG,EAAkBH,EAAI/J,KAC5B0J,EAASQ,Q,mCAIAR,GACX,IAAMC,EAAQ,UAAMJ,EAAN,iBACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAMI,EAAcJ,EAAI/J,KACxB0J,EAASS,Q,4CAIST,GACpB,IAAMC,EAAQ,UAAMJ,EAAN,0BACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GAAG,OAAIL,EAASK,EAAI/J,W,kCAMnCiC,EAAQyH,GAClB,IAAMC,EAAQ,UAAMJ,EAAN,gBACdK,IAAMC,IAAIF,EAAU,CAClB1H,OAAQA,IACP6H,MAAK,SAAAC,GAAG,OAAIL,EAASK,EAAI/J,W,8BAMtBiC,EAAQyH,GACd,IAAMC,EAAQ,UAAMJ,EAAN,YACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,qCAKJ0J,GACb,IAAMC,EAAQ,UAAOJ,EAAP,iBACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAMK,EAAcL,EAAI/J,KACxB0J,EAASU,Q,mCAKAnI,EAAOyH,GAElB,IAAMC,EAAQ,UAAMJ,EAAN,kBACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,yCAKAiC,EAAQyH,GACzB,IAAMC,EAAQ,UAAMJ,EAAN,uBACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,iCAKRiC,EAAQyH,GACjB,IAAMC,EAAQ,UAAMJ,EAAN,eACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,6BAKZiC,EAAQyH,GACb,IAAMC,EAAQ,UAAMJ,EAAN,WACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,wCAKD0J,GAChB,IAAMC,EAAQ,UAAOJ,EAAP,sBACdK,IAAMC,IAAIF,GAAUG,MAAK,SAAAC,GACvB,IAAMM,EAAaN,EAAI/J,KACvB0J,EAASW,Q,uCAKIpI,EAAQyH,GACvB,IAAMC,EAAQ,UAAMJ,EAAN,qBACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,qCAKJiC,EAAQyH,GACrB,IAAMC,EAAQ,UAAMJ,EAAN,mBACdK,IACGC,IAAIF,EAAU,CACb1H,OAAQA,IAET6H,MAAK,SAAAC,GACJL,EAASK,EAAI/J,W,gCAKT0J,GAERE,IACGC,IAFkB,sCAGlBC,MAAK,SAAAC,GACJ,IAAMO,EAAkBP,EAAI/J,KAAKuK,OAAOC,eAClCC,EAAeV,EAAI/J,KAAKuK,OAAOG,YAKrChB,EAJe,CACbiB,eAAgBL,EAChBM,YAAaH,W,KC1KhB,SAASI,EAAUC,GACxB,MAAM,GAAN,OAAUA,EAAEC,SAAZ,OAAsBD,EAAEE,MAAQ,MAAQF,EAAEE,MAAQ,IAG7C,SAASC,EAAUC,GACxB,IAAMC,EAAQD,EAAE5J,MAAM,KAEtB,MAAO,CACLyJ,QAASI,EAAM,GAAGC,OAClBJ,MAAwB,IAAjBG,EAAMtF,OAAesF,EAAM,GAAGC,OAAS,I,0ECSlDC,IAAiBC,K,IAgZFC,E,kDA7Yb,aAAe,IAAD,8BACZ,gBAyBFC,YAAc,SAAC1J,GACb,EAAK2J,SAAS,CACZC,UAAW5J,KA1Bb,EAAK6J,SAAW,IAAIlC,EAEpB,EAAKuB,MAAQ,CACXY,UAAY,GACZF,WAAW,EACXG,YAAa,GACbC,UAAW,GACXC,YAAY,GACZC,aAAa,GACbC,gBAAgB,IAGlB,EAAKN,SAASO,OAAM,SAAAlC,GAAQ,OAC1B,EAAKyB,SAAS,CACZG,UAAW5B,OAhBH,E,gEAsBZ5H,KAAKI,MAAM2J,WAAW/J,MACtBA,KAAKgK,UAAUhK,KAAKI,MAAM6J,gB,gCASlBA,GAAe,IAAD,QACjBA,GAAgD,KAA/BjK,KAAKI,MAAM8J,iBAAqD,KAA3BlK,KAAKI,MAAM+J,YAExC,cAAxBnK,KAAKI,MAAMkC,SAEbtC,KAAKuJ,SAASa,uBAAsB,SAAAC,GAClC,IAAIC,EAAcD,EAAqB3M,KAAI,SAAAU,GACzC,MAAO,CACLT,GAAIS,EAAEqC,KAAK8J,MAGX7K,MAAOkB,KAAK4J,IAAIpM,EAAEqM,YAElBC,UAAWtM,EAAEsB,MACbe,KAAMrC,EAAEqC,SAGZ,EAAK4I,SAAS,CAAEiB,eAAe,EAAKK,cAKtC3K,KAAKuJ,SAASqB,iBAAiB,CAC7BC,KAAM,IACN,SAAAC,GACA,IAAIR,EAAcQ,EAAgBpN,KAAI,SAAAU,GACpC,MAAO,CACLT,GAAIS,EAAEqC,KAAK8J,MAGX7K,MAAMkB,KAAK4J,IAAIpM,EAAEqM,YAEjBC,UAAWtM,EAAEsB,MACbe,KAAMrC,EAAEqC,SAGZ,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,eAMX,eAAzB/K,KAAKI,MAAMN,UACTE,KAAKI,MAAMyK,KAAO,EAEpB7K,KAAKuJ,SAASyB,YAAY,CACxBH,KAAM7K,KAAKI,MAAMyK,KACjB5G,MAA+B,cAAxBjE,KAAKI,MAAMkC,SAAyBtC,KAAKI,MAAM8J,gBAAgBlK,KAAKI,MAAM+J,cAChF,SAAAE,GACD,IAAIC,EAAcD,EAAqB3M,KAAI,SAAAU,GACzC,MAAO,CACLT,GAAIS,EAAEqC,KAAK8J,MAGX7K,MAAOkB,KAAK4J,IAAIpM,EAAEqM,YAElBC,UAAWtM,EAAEsB,MACbe,KAAMrC,EAAEqC,SAGZ,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,eAMpC/K,KAAKuJ,SAAS0B,mBAAmB,CAC/BJ,KAAM7K,KAAKI,MAAMyK,OAChB,SAAAK,GACD,IAAIZ,EAAcY,EAAkBxN,KAAI,SAAAU,GACtC,MAA4B,cAAxB,EAAKgC,MAAMkC,SAEN,CACL3E,GAAIS,EAAEqC,KAAK8J,MAGX7K,MAAMkB,KAAK4J,IAAIpM,EAAE+M,kBAEjBT,UAAWtM,EAAEsB,MACbe,KAAMrC,EAAEqC,MAKH,CACL9C,GAAIS,EAAEqC,KAAK8J,MAGX7K,MAAOkB,KAAK4J,IAAIpM,EAAEgN,kBAElBV,UAAWtM,EAAEiN,WACb5K,KAAMrC,EAAEqC,SAKd,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,eAQtC/K,KAAKI,MAAMyK,KAAK,EAGlB7K,KAAKuJ,SAASyB,YAAY,CACxBH,KAAM7K,KAAKI,MAAMyK,KACjB5G,MAA+B,cAAxBjE,KAAKI,MAAMkC,SAAyBtC,KAAKI,MAAM8J,gBAAgBlK,KAAKI,MAAM+J,cAChF,SAAAE,GAEG,EAAKjK,MAAMyK,KAAO,EAEpB,EAAKtB,SAASyB,YAAY,CACxBH,KAAM,EAAKzK,MAAMyK,KAAO,EACxB5G,MAA+B,cAAxB,EAAK7D,MAAMkC,SAAyB,EAAKlC,MAAM8J,gBAAgB,EAAK9J,MAAM+J,cAChF,SAAAmB,GACD,IAAIhB,EAAcD,EAAqB3M,KAAI,SAACU,EAAGwE,GAC7C,MAAO,CACLjF,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ4L,EAAmB1I,GAAOlD,MAAQ,EAAIkB,KAAK4J,IAAIpM,EAAEsB,MAAQ4L,EAAmB1I,GAAOlD,OAAQ,EAC5GgL,UAAYtM,EAAEsB,MAAQ4L,EAAmB1I,GAAOlD,MAAQ,EAAGtB,EAAEsB,MAAQ4L,EAAmB1I,GAAOlD,MAAO,EACtGe,KAAMrC,EAAEqC,SAGZ,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,eAKtC,EAAKxB,SAAS0B,mBAAmB,CAC/BJ,KAAM,EAAKzK,MAAMyK,KAAO,IACvB,SAAAS,GACD,IAAIhB,EAAcD,EAAqB3M,KAAI,SAACU,EAAGwE,GAC7C,MAA4B,cAAxB,EAAKxC,MAAMkC,SAEN,CACL3E,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ4L,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAO7K,MAAQ,EAAIkB,KAAK4J,IAAIpM,EAAEsB,MAAQ4L,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAO7K,OAAS,EACjLgL,UAAYtM,EAAEsB,MAAQ4L,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAO7K,MAAQ,EAC9EtB,EAAEsB,MAAQ4L,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAO7K,MAAM,EACxFe,KAAMrC,EAAEqC,MAKH,CACL9C,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEiN,WAAaC,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAOc,WAAa,EAAIzK,KAAK4J,IAAIpM,EAAEiN,WAAaC,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAOc,YAAc,EACrMX,UAAYtM,EAAEiN,WAAaC,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAOc,WAAa,EACxFjN,EAAEiN,WAAaC,EAAmBC,MAAK,SAAAlN,GAAC,OAAIA,EAAEoC,KAAK8J,QAAUnM,EAAEqC,KAAK8J,SAAOc,WAAW,EAClG5K,KAAMrC,EAAEqC,SAKd,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,kBAQ1C/K,KAAKuJ,SAAS0B,mBAAmB,CAC/BJ,KAAM7K,KAAKI,MAAMyK,OAChB,SAAAW,GACD,EAAKjC,SAAS0B,mBAAmB,CAC/BJ,KAAM,EAAKzK,MAAMyK,KAAO,IACvB,SAAAY,GACD,IAAInB,EAAckB,EAAkB9N,KAAI,SAACU,EAAGwE,GAC1C,MAA4B,cAAxB,EAAKxC,MAAMkC,SAEN,CACL3E,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ+L,EAAkB7I,GAAOlD,MAAQ,EAAIkB,KAAK4J,IAAIpM,EAAEsB,MAAQ+L,EAAkB7I,GAAOlD,OAAQ,EAC1GgL,UAAWtM,EAAEsB,MAAQ+L,EAAkB7I,GAAOlD,MAAQ,EAAItB,EAAEsB,MAAQ+L,EAAkB7I,GAAOlD,MAAO,EACpGe,KAAMrC,EAAEqC,MAKJ,CACJ9C,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEiN,WAAaI,EAAkB7I,GAAOyI,WAAa,EAAIzK,KAAK4J,IAAIpM,EAAEiN,WAAaI,EAAkB7I,GAAOyI,YAAa,EAC9HX,UAAWtM,EAAEiN,WAAaI,EAAkB7I,GAAOyI,WAAa,EAAIjN,EAAEiN,WAAaI,EAAkB7I,GAAOyI,WAAY,EACxH5K,KAAMrC,EAAEqC,SAKd,EAAK4I,SAAS,CAAEiB,eAAe,EAAKS,oB,kCAW9C/K,KAAK0L,MAAQzC,IAAe,WAAY0C,KAExC3L,KAAK0L,MAAME,WAAa,IAAID,IAAoBE,SAChD,IAAIpC,EAAczJ,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC7ClC,EAAczJ,KAAK8L,kBAAkBrC,EAAa,CAChDsC,QAASC,IACTC,QAAS,CAAC,MACVrO,KAAMoC,KAAK4I,MAAM0B,cAEnB,IAAIX,EAAc3J,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC7ChC,EAAc3J,KAAK8L,kBAAkBnC,EAAa,CAChDoC,QAASG,IACTtO,KAAMoC,KAAK4I,MAAM0B,YACjB6B,UAAWnM,KAAK4I,MAAMU,YAExB,IAAII,EAAY1J,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC3CjC,EAAY1J,KAAK8L,kBAAkBpC,EAAW,CAC5CqC,QAASK,IACTxO,KAAMoC,KAAK4I,MAAM0B,YACjB6B,UAAWnM,KAAK4I,MAAMU,YAExB,IAAIM,EAAe5J,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC9C/B,EAAe5J,KAAK8L,kBAAkBlC,EAAc,CAClDmC,QAASM,IACTzO,KAAMoC,KAAK4I,MAAM0B,YACjB6B,UAAWnM,KAAK4I,MAAMU,YAExB,IAAIgD,EAAkBtM,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KACjDW,EAAkBtM,KAAK8L,kBAAkBQ,EAAiB,CACxDP,QAASQ,IACT3O,KAAMoC,KAAK4I,MAAM0B,YACjB6B,UAAWnM,KAAK4I,MAAMU,YAGxBtJ,KAAKwM,YAAc,CAAC9C,GAEpB1J,KAAKyM,qBAELzM,KAAKqJ,SAAS,CACZI,cACAE,cACAD,YACAE,eACA0C,sB,wCAKchP,EAAQoP,GACJ1M,KAAKI,MAAlBN,UAD+B,IAIlC6M,GAFJrP,EAASgD,OAAOsM,OAAOtP,EAAQoP,IAEFG,YAAYC,SAKvCxP,EAAOyP,UAAUlL,KAAK,CACpBmL,SAAU,OACVC,OAAQN,EACRtK,IAAK4G,IA9Sc,WA+SnB5I,IAAK4I,IA9Sc,WA+SnBiE,SAAU,EACVC,SAAUvM,KAAK4J,IAAI,OAiBvBmC,EAAgBS,YAAc,sBAC9BT,EAAgBU,kBAAmB,EACnCV,EAAgB1O,YAAc,GAGrB0O,EAAgBW,OAAOC,OAAO,SACpCC,WAAWjP,KAAO0K,IAtUD,WAyUpB0D,EAAgBc,gBAAkBxE,IAAyByE,QAzCtB,MA8CL1N,KAAKI,MAA7BuN,EA9C6B,EA8C7BA,WAAYC,EA9CiB,EA8CjBA,SAYpB,OAXAjB,EAAgBkB,OAAO9G,GAAG,OAAO,SAAA+G,GAAM,IAAD,EACHA,EAAEb,OAAOc,SAASC,YAAhCvN,GADiB,EAC5B9C,GAD4B,EACxB+B,MADwB,EACjBe,MAAMyD,EADW,EACXA,KACrBzD,EACFkN,EAAWlN,GAIXmN,EAAS1J,MAIN5G,I,2CAGa,IAAD,OACZgM,EAAatJ,KAAK4I,MAAlBU,UAEPtJ,KAAK0L,MAAMuC,YAAc,IAAItC,IAC7B3L,KAAK0L,MAAMuC,YAAYR,gBAAkBxE,IAAyByE,QAGlE,IAAIQ,EAASlO,KAAK0L,MAAMyC,eAAeC,YAAYnF,KACnDiF,EAAOG,MAAMzP,KAAb,UACE0K,EAAY,OAAS,OADvB,qBAGA4E,EAAOI,WAAY,EACnBJ,EAAO3I,QAAQ,EAAG,EAAG,EAAG,GACxB2I,EAAOK,MAAQ,QACfL,EAAOM,YAAc,GACrBN,EAAOT,gBAAkBxE,IAAyByE,QAClDQ,EAAOL,OAAO9G,GAAG,OAAO,WACtB,EAAKqC,YAAY8E,EAAOO,UADI,IAErBnF,EAAa,EAAKV,MAAlBU,UACP,EAAKkD,YAAYhM,SAAQ,SAAAsI,GACtBA,EAAEqD,UAAY7C,KAEjB4E,EAAOG,MAAMzP,KAAb,UACE0K,EAAY,OAAS,OADvB,0B,mCAOF,IAAIG,EAAczJ,KAAK4I,MAAMa,YACzBC,EAAY1J,KAAK4I,MAAMc,UACvBC,EAAc3J,KAAK4I,MAAMe,YACzBC,EAAe5J,KAAK4I,MAAMgB,aAC1B0C,EAAkBtM,KAAK4I,MAAMiB,gBACjCJ,EAAY7L,KAAOoC,KAAK4I,MAAM0B,YAC9BZ,EAAU9L,KAAOoC,KAAK4I,MAAM0B,YAC5BV,EAAahM,KAAOoC,KAAK4I,MAAM0B,YAC/BX,EAAY/L,KAAOoC,KAAK4I,MAAM0B,YAC9BgC,EAAgB1O,KAAOoC,KAAK4I,MAAM0B,c,6CAI9BtK,KAAK0L,OACP1L,KAAK0L,MAAMgD,Y,+BAMb,OAAO,yBAAK/Q,GAAG,iB,GA1YMuJ,aCWjByH,G,WAAAA,QA4uBOC,E,kDA9sBb,WAAYxO,GAAQ,IAAD,8BACjB,cAAMA,IA5BRyO,mBAAqB,SAAAf,GACnB,EAAKzE,SAAS,CACZ5L,OAAQqQ,EAAEb,OAAOvN,SAyBF,EArBnBoP,sBAAwB,SAAAhB,GACtB,EAAKzE,SAAS,CACZvJ,UAAWgO,EAAEb,OAAOvN,SAmBL,EAdnBqP,qBAAuB,SAAAjB,GACrB,EAAKzE,SAAS,CACZ/G,SAAUwL,KAYK,EARnBkB,qBAAuB,SAAAlB,GACrB,EAAKzE,SAAS,CACZ4F,SAAUnB,EAAEb,OAAOvN,QAClB,WACD,EAAKhC,IAAIsM,UAAU,EAAKpB,MAAMqB,kBAIf,EA2CnBiF,mBAAqB,WACnB,EAAKC,aAAa,MAElB,EAAKC,QAAUC,IAAMC,YAErB,EAAK/F,SAAW,IAAIlC,EAEpB,EAAKkC,SAASO,OAAM,SAAAlC,GAAQ,OAC1B,EAAKyB,SAAS,CACZG,UAAW5B,OAIf,EAAK2B,SAASgG,kBAAiB,SAAAzH,GAAe,OAC5C,EAAKuB,SAAS,CACZmG,WAAY1H,IACX,WACD,EAAKyB,SAASkG,cAAa,SAAA1H,GACvB,IADsC,IAAD,WAC5BnI,GAEL,EAAKyJ,UAAS,SAAAqG,GAAS,MAAK,CAC1BF,WAAW,GAAD,mBAAME,EAAUF,YAAhB,CAA4BzH,EAAYnI,UAH/CA,EAAI,EAAGA,EAAImI,EAAYtE,SAAU7D,EACzC,EADQA,YAUjB,EAAK2J,SAASoG,gBAAe,SAAA3H,GAAW,OACtC,EAAKqB,SAAS,CACZrB,YAAaA,EAAY,GAAGvI,KAC5BmQ,UAAW5H,EAAY,GAAG4H,eAI9B,EAAKrG,SAASsG,WAAU,SAAAC,GACtB,EAAKzG,SAAS,CACZd,eAAgBuH,EAAOvH,eACvBC,YAAasH,EAAOtH,kBAjFP,EAyPnBuH,QAAU,SAAAC,GACR,EAAKtS,IAAMsS,GA1PM,EA8RnBC,aAAe,WACb,EAAK5G,SAAS,CACZ6G,aAAa,KAhSE,EAqSnBtC,SAAW,SAAC1J,GACV,EAAKmF,SAAS,CACZ6G,aAAa,EACbC,iBAAiB,kCAAD,OAAoCjM,MAxSrC,EA4SnBkM,cAAgB,WAAK,IAAD,EACqB,EAAKxH,MAArCZ,EADW,EACXA,YAAa6C,EADF,EACEA,KAAM+E,EADR,EACQA,UACtBnQ,EAAO,IAAIF,KAAJ,UAAYyI,EAAZ,WACPqI,EAAY,IAAI9Q,KAAJ,UAAYqQ,EAAZ,WAEhBnQ,EAAK6Q,QAAQ7Q,EAAK8Q,QAAQhR,MAAQsL,GAClC,IAAI2F,EAAQ,GACZA,EAAM3F,GAAN,UAAiBpL,EAAKgR,WAAW,EAAjC,YAAsChR,EAAK8Q,WAG3C,IADA,IAAI3Q,EAAIiL,EAAK,EACNjL,EAAIiL,EAAK,IAAMjL,GAAG,IAEtBH,EAAK6Q,QAAQ7Q,EAAK8Q,UAAY,GAC9BC,EAAM5Q,GAAN,UAAcH,EAAKgR,WAAW,EAA9B,YAAmChR,EAAK8Q,WACxC3Q,GAAG,EAON,KAJAH,EAAO,IAAIF,KAAJ,UAAYyI,EAAZ,YACFsI,QAAQ7Q,EAAK8Q,QAAQhR,MAAQsL,GAClCpL,EAAK6Q,QAAQ7Q,EAAK8Q,UAAY,GAC9B3Q,EAAIiL,EAAK,EACFpL,GAAQ4Q,GAAazQ,EAAIiL,EAAK,IACnC2F,EAAM5Q,GAAN,UAAcH,EAAKgR,WAAW,EAA9B,YAAmChR,EAAK8Q,WACxC9Q,EAAK6Q,QAAQ7Q,EAAK8Q,UAAY,GAC9B3Q,GAAK,EAEP,OAAO4Q,GAtUU,EAyUnBE,mBAAqB,WAAK,IAAD,EACU,EAAK9H,MAA/BZ,EADgB,EAChBA,YAAa4H,EADG,EACHA,UAChBnQ,EAAO,IAAIF,KAAJ,UAAYyI,EAAZ,WACP2I,EAAgB,IAAIpR,KAAJ,UAAYqQ,EAAZ,WACpB,OAAOhP,KAAKc,KAAKd,KAAKgQ,IAAInR,EAAOkR,GAAhB,QA7UA,EAgVnBE,0BAA4B,WAC1B,IAAMC,EAA0B,EAAKlI,MAAMkI,wBAC3C,EAAKzH,SAAS,CACZyH,yBAA0BA,KAnVX,EAuVnBC,sBAAwB,WACtB,IAAMC,EAAsB,EAAKpI,MAAMoI,oBACvC,EAAK3H,SAAS,CACZ2H,qBAAsBA,KAxVxB,EAAKpI,MAAQ,CACXkB,MAAO,EAAK1J,MAAM0J,OAAS,GAC3BN,UAAW,GACXyH,OAAQ,EAAK7Q,MAAM6Q,QAAU,CAAC,oBAC9BzB,WAAY,GACZxH,YAAa,GACb4H,UAAW,GACXsB,SAAS,EACTC,cAAc,EACdC,aAAa,EACbC,cAAe,GACfxG,KAAM,GACNZ,cAAc,EACd3H,SAAU,CAAC,aACXxC,UAAW,aACXmP,SAAU,YACVxR,OAAQ,SACRyS,aAAa,EACbC,iBAAkB,GAClBW,yBAAyB,EACzBE,qBAAqB,EACrBzI,eAAgB,EAChBC,YAAa,GAGf,EAAK2G,aAAe,EAAKA,aAAamC,KAAlB,gBACpB,EAAKC,gBAAkB,EAAKA,gBAAgBD,KAArB,gBACvB,EAAKE,eAAiB,EAAKA,eAAeF,KAApB,gBACtB,EAAK3D,WAAa,EAAKA,WAAW2D,KAAhB,gBAClB,EAAKG,sBAAwB,EAAKA,sBAAsBH,KAA3B,gBAC7B,EAAKI,iBAAmB,EAAKA,iBAAiBJ,KAAtB,gBACxB,EAAKrB,aAAe,EAAKA,aAAaqB,KAAlB,gBACpB,EAAK1D,SAAW,EAAKA,SAAS0D,KAAd,gBAChB,EAAKlB,cAAgB,EAAKA,cAAckB,KAAnB,gBACrB,EAAKvC,qBAAuB,EAAKA,qBAAqBuC,KAA1B,gBAC5B,EAAKxC,sBAAwB,EAAKA,sBAAsBwC,KAA3B,gBAC7B,EAAKzC,mBAAqB,EAAKA,mBAAmByC,KAAxB,gBAC1B,EAAKT,0BAA4B,EAAKA,0BAA0BS,KAA/B,gBACjC,EAAKP,sBAAwB,EAAKA,sBAAsBO,KAA3B,gBAxCZ,E,uDAsFR7Q,GACJT,KAAK2R,eAAelR,IACvBT,KAAKmP,aAAa1G,EAAUhI,M,qCAOjBA,GACb,GAAIT,KAAK4I,MAAMkB,OAASrJ,EAAM,CAC5B,IAAMmR,EAAanJ,EAAUhI,GAC7B,OAAOT,KAAK4I,MAAMkB,MAAMhG,SAAS8N,GAEnC,OAAO,I,mCAGIC,GAAU,IAAD,OACdC,EAAUjJ,EAAUgJ,GAE1B7R,KAAKqJ,UACH,SAAAqG,GAAS,MAAK,CACZ5F,MAAM,GAAD,mBAAM4F,EAAU5F,OAAhB,CAAuB+H,QAE9B,WAEM,EAAKjJ,MAAMiC,MAAQ,EACrB,EAAKtB,SAASwI,QACZ,CACEnJ,MAAOkJ,EAAQlJ,MACfD,QAASmJ,EAAQnJ,QACjBsI,OAAQ,EAAKrI,MAAMqI,OACnBpG,KAAM,EAAKjC,MAAMiC,KACjBqG,QAAS,EAAKtI,MAAMsI,QACpBC,aAAc,EAAKvI,MAAMuI,aACzBC,YAAa,EAAKxI,MAAMwI,cAE1B,SAAAxT,GACE,EAAKyL,UAAS,SAAAqG,GAAS,MAAK,CAC1B2B,cAAc,eACT3B,EAAU2B,cADF,eAEVQ,EAAUjU,WAOnB,EAAK2L,SAASyI,aACZ,CACEpJ,MAAOkJ,EAAQlJ,MACfD,QAASmJ,EAAQnJ,QACjBkC,KAAM,EAAKjC,MAAMiC,OAEnB,SAAAjN,GACE,EAAKyL,UAAS,SAAAqG,GAAS,MAAK,CAC1B2B,cAAc,eACT3B,EAAU2B,cADF,eAEVQ,EAAUjU,WAQrB,EAAKwR,QAAQ8B,QAAQe,eAAe,CAClCnI,MAAO,EAAKlB,MAAMkB,a,sCAMVoI,GACdlS,KAAKqJ,UAAS,SAAAqG,GACZ,MAAO,CAGL5F,MAAO4F,EAAU5F,MAAM3J,QAAO,SAAA0R,GAAO,OAAIA,IAAYK,KACrDb,cAAe/Q,OAAOC,KAAKmP,EAAU2B,eAClClR,QAAO,SAAA0R,GAAO,OAAIA,IAAYK,KAC9BC,QAAO,SAACC,EAAkBP,GACzB,OAAO,eACFO,EADL,eAEGP,EAAUnC,EAAU2B,cAAcQ,OAEpC,U,sCAQK5N,GACd,GAAIjE,KAAK4I,MAAMqI,QAAUhN,EAAO,CAC9B,IAAMoO,EFrOJ,GAAN,OEqOmCpO,EFrOvBC,MEsOR,OAAOlE,KAAK4I,MAAMqI,OAAOnN,SAASuO,GAEpC,OAAO,I,qCAOMC,EAAeC,GAAY,IAAD,OACpBvS,KAAK4I,MAAjBtG,SAgBP,GAfI,qBAAsBgQ,GAIxBtS,KAAKqJ,SACH,CACE6H,QAASqB,EAAUC,iBAAiB1O,SAAS,WAC7CqN,aAAcoB,EAAUC,iBAAiB1O,SAAS,gBAClDsN,YAAamB,EAAUC,iBAAiB1O,SAAS,iBAEnD,WACE,EAAK2O,eAIP,WAAYH,EAEVtS,KAAKqJ,SAAS,CACZ4H,OAAQqB,EAAcrB,SACrB,WACD,EAAKwB,mBAGR,CAGH,IAAMC,EAAY1S,KAAK4I,MAAMkB,MACvB6I,EAAWJ,EAAUzI,MAErB8I,EAAaD,EAASxS,QAC1B,SAAA0R,GAAO,OAAKa,EAAU5O,SAAS+N,MAE3BgB,EAAgBH,EAAUvS,QAC9B,SAAA0R,GAAO,OAAKc,EAAS7O,SAAS+N,MAGhCe,EAAWpS,QAAQR,KAAKmP,cACxB0D,EAAcrS,QAAQR,KAAKuR,oB,4CAUT1G,GAAO,IAAD,OACR7K,KAAK4I,MAAMkB,MAC7B9J,KAAKqJ,SAAS,CAAEwB,SAAQ,WACtB,EAAK4H,iB,kCAaI,IAAD,OACJC,EAAY1S,KAAK4I,MAAMkB,MAC7B9J,KAAKqJ,SACH,CACES,MAAO,GACPuH,cAAe,KAEjB,WAEEqB,EAAUlS,QAAQ,EAAK2O,cAInB,EAAKvG,MAAMqB,cAA6C,IAA7B,EAAKrB,MAAMqI,OAAOxN,QAC/C,EAAK/F,IAAIsM,UAAU,EAAKpB,MAAMqB,mB,uCAOrB6I,GACf9S,KAAKqJ,SAAS,CACZY,aAAc6I,IAEhB9S,KAAKtC,IAAIsM,UAAU8I,K,+BAoEX,IAAD,SAeH9S,KAAK4I,MAbPkB,EAFK,EAELA,MACAN,EAHK,EAGLA,UACAyH,EAJK,EAILA,OACAzB,EALK,EAKLA,WACA3E,EANK,EAMLA,KACAwG,EAPK,EAOLA,cACApH,EARK,EAQLA,aACA3H,EATK,EASLA,SACAxC,EAVK,EAULA,UACAmP,EAXK,EAWLA,SACAxR,EAZK,EAYLA,OACAyS,EAbK,EAaLA,YACAC,EAdK,EAcLA,iBAEIK,EAAQxQ,KAAKoQ,gBACb2C,EAAkB/S,KAAK0Q,qBAEvBsC,EAAiBxJ,EACpBrJ,QAAO,SAAAM,GAAI,OAAK,EAAKkR,eAAelR,MACpC/C,IAAI+K,GACJhG,OACA/E,KAAI,SAAAoL,GACH,OAAO,kBAAC6F,EAAD,CAAQxQ,IAAK2K,GAAb,IAAkBA,EAAlB,QAGLmK,EAAezD,EAClBrP,QAAO,SAAA8D,GAAK,OAAK,EAAKiP,gBAAgBjP,MACtCvG,KAAI,SAAAuG,GACH,OACE,kBAAC0K,EAAD,CAAQxQ,IAAK8F,EAAMC,KAAMxE,MAAOuE,EAAMC,MACpC,uBAASiP,MAAOlP,EAAMmP,YAAaC,UAAU,SAC1CpP,EAAMC,UAOXoP,EAAuB,CAC3B7S,KACE,uBAAG8S,UAAU,eAAb,2EAKFtP,MACE,yBAAKsP,UAAU,0BACb,uBAAGA,UAAU,0BAAb,iQAIoC,uBAAGC,KAAK,mCAAmCvG,OAAO,SAAlD,oCAJpC,MASJxN,KACE,uBAAG8T,UAAU,0BAAb,sDAKFf,iBACE,uBAAGe,UAAU,0BAAb,+DAKFE,UACE,uBAAGF,UAAU,0BAAb,6DAKFG,WACE,uBAAGH,UAAU,0BAAb,oDAKFI,MACE,uBAAGJ,UAAU,0BAAb,oDAMEK,EAAkB,CACtBC,WACE,uBAAGN,UAAU,wBAAb,gLAOFO,WACE,uBAAGP,UAAU,wBAAb,2EAOAQ,EAAW,GAIf,GAAiC,GAA7B/T,KAAK4I,MAAML,gBAAiD,GAA1BvI,KAAK4I,MAAMJ,YAAkB,CACjE,IAAMwL,EAAQ,IAAIzU,KACZ0U,EAAKC,OAAOF,EAAMzD,WAAW4D,SAAS,EAAG,KAO/CJ,EAAW,MANAG,OAAOF,EAAMvD,WAAa,GAAG0D,SAAS,EAAG,KAM5B,IAAMF,EAAK,IALtBD,EAAMI,cAK6B,KAFzBpU,KAAK4I,MAAML,eAAe8L,WAAWC,QAAQ,wBAAyB,KAErB,2DADpDtU,KAAK4I,MAAMJ,YAAY6L,WAAWC,QAAQ,wBAAyB,KAEvE,iCAKlB,IAFA,IAAIC,EAAsB,GACtBC,EAAkB,GACb5U,EAAIqR,EAAOxN,OAAS,EAAG7D,GAAG,EAAGA,IACtC,CACG,GAAkC,eAA9BqR,EAAOrR,GAAGwE,UAAU,EAAE,IAC1B,CACGmQ,EAAsBtD,EAAOrR,GACE,IAA3B4U,EAAgB/Q,SAElB+Q,EAAkBvD,EAAOrR,GAAK,uBAEhC,MAIA4U,EAAkBvD,EAAOrR,GAG/B,OACE,yBAAK2T,UAAU,oBACb,uBAAKpR,KAAK,OAAOgE,QAAQ,gBACtB+J,EACC,uBACAuE,QAAO,UAAMtE,GACbiD,YAAa,+BACbjR,KAAK,QACLuS,UAAQ,EACRC,QAAS3U,KAAKiQ,eACZ,KAEJ,uBAAK2E,KAAM,IACT,2BACE,yBAAKrB,UAAU,gBACb,uBACEvD,IAAKhQ,KAAKoP,QACVoC,eAAgBxR,KAAKwR,eACrBqD,cAAe,CACb/K,MAAOA,EACPmH,OAAQA,EACRpG,KAAM,GACN2H,iBAAkB,CAAC,aAGrB,uBACEsC,QAASxB,EAAqB7S,KAC9B4S,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,CACE3G,MAAM,QACNnK,KAAK,QACL+Q,MAAO,CAAC,CAAEC,UAAU,EAAMT,QAAS,0BAEnC,uBACEU,KAAK,WACLnX,MAAO,CAAEoX,MAAO,QAChBC,YAAY,gBAEXrC,KAIP,uBACE8B,QAASxB,EAAqBrP,MAC9BoP,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,CACE3G,MAAM,UACNnK,KAAK,SACL+Q,MAAO,CACL,CAAEC,UAAU,EAAMT,QAAS,uCAG7B,uBACEU,KAAK,WACLnX,MAAO,CAAEoX,MAAO,QAChBC,YAAY,4BAEXpC,KAIP,uBACE6B,QAASxB,EAAqB7T,KAC9B4T,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,CACE3G,MAAM,kBACNnK,KAAK,OACL+Q,MAAO,CACL,CAAEC,UAAU,EAAMT,QAAS,mCAG7B,uBACEjE,MAAOA,EACPnO,IAAKwI,EAAK,KAAKkI,EAAgBlI,EAAK,IAAIkI,EACxCuC,aAAczK,EACdxK,IAAKwK,EAAK,IAAI,GAAGA,EAAK,GAAG,GACzB0K,cAAevV,KAAKyR,sBACpB+D,KAAQ,SAId,uBACEV,QAASxB,EAAqBd,iBAC9Ba,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,CAAW3G,MAAM,oBAAoBnK,KAAK,oBACxC,sBAAUuR,MAAV,CAAgBzX,MAAO,CAAEoX,MAAO,SAC9B,2BACE,uBAAUM,gBAAc,EAAChW,MAAM,WAA/B,iBAGA,uBAAUA,MAAM,gBAAhB,2BAGA,uBAAUA,MAAM,eAAhB,+BAQV,2BACE,uBACEoV,QAASxB,EAAqBG,UAC9BJ,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,0BAEE,sBAAUS,MAAV,CACEE,aAAc,CAAC,aACfC,SAAU5V,KAAK+O,sBAEf,uBAAU2G,gBAAc,EAAChW,MAAM,aAA/B,mBACA,uBAAUA,MAAM,SAAhB,aAIN,uBACEoV,QAASxB,EAAqBI,WAC9BL,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,0BAEE,sBAAOS,MAAP,CACE/V,MAAOI,EACP8V,SAAU5V,KAAK8O,uBAEf,uBAAOpP,MAAM,cAAb,oBACA,uBAAOA,MAAM,SAAb,gBAIN,uBACEoV,QAASxB,EAAqBK,MAC9BN,UAAU,QACV0B,QAAS/U,KAAK4I,MAAMkI,yBACpB,sBAAMkE,KAAN,sBAEE,sBAAOS,MAAP,CAAa/V,MAAOjC,EAAQmY,SAAU5V,KAAK6O,oBACzC,uBAAOnP,MAAM,UAAb,UACA,uBAAOA,MAAM,OAAb,qBAOXoK,EAAMrG,OACP,2BACE,yBAAK8P,UAAU,iBACb,kBAAC,EAAD,CACE3V,KAAMyT,EACN/O,SAAUA,EACVsL,SAAY5N,KAAK4N,SACjB9N,UAAWA,EACXrC,OAAQA,MAIZ,MAEJ,uBAAKmX,KAAM,IACT,2BACE,uBAAGrB,UAAU,YAAYQ,IAE3B,2BACE,0BAAMR,UAAU,eACd,uBACEuB,QAASlB,EAAgBC,WACzBR,UAAU,SACV0B,QAAS/U,KAAK4I,MAAMoI,qBAHtB,uBAKE,uBAAQ4E,SAAU5V,KAAK0R,qBAG3B,0BAAM6B,UAAU,eACd,uBACEuB,QAASlB,EAAgBE,WACzBT,UAAU,SACV0B,QAAS/U,KAAK4I,MAAMoI,qBAClB,sBAAOyE,MAAP,CACE/V,MAAOuP,EACP2G,SAAU5V,KAAKgP,sBACf,uBAAOtP,MAAM,aAAb,wBACA,uBAAOA,MAAM,SAAb,mBAKV,2BACE,yBAAK6T,UAAU,eACb,kBAAC,EAAD,CAAYA,UAAU,MACpBxJ,WAAY/J,KAAK+P,QACjB9F,aAAcA,EACdY,KAAMA,EACNX,gBAAmBqK,EACnBpK,YAAeqK,EACf7G,WAAY3N,KAAK2N,WACjBC,SAAY5N,KAAK4N,SACjB9N,UAAWA,EACXwC,SAAY2M,MAIlB,2BACE,yBAAKsE,UAAU,+BACb,uBAAQA,UAAU,qBACdsC,QAAS7V,KAAK6Q,2BAC0B,GAAtC7Q,KAAK4I,MAAMkI,wBAAmC,qBAAuB,8BAE3E,uBAAQyC,UAAU,qBACdsC,QAAS7V,KAAK+Q,uBACsB,GAAlC/Q,KAAK4I,MAAMoI,oBAA+B,oBAAsB,mC,GA/tBzD8E,iBC0CdC,I,qLArEP,OACI,yBAAKxC,UAAU,gBACX,yBAAKA,UAAU,WACX,wBAAIA,UAAU,iBAAd,wFACA,uBAAGA,UAAU,qBAAb,uLAGO,uBAAGA,UAAU,iBAAiBC,KAAK,mCAAnC,wBAHP,QAGyG,uBAAGD,UAAU,iBAAiBC,KAAK,qCAAnC,wBAHzG,YAIa,uBAAGD,UAAU,iBAAiBC,KAAK,0BAAnC,sBAJb,8CAMA,4CACA,uBAAGD,UAAU,qBAAb,wCACyC,uBAAGA,UAAU,iBAAiBC,KAAK,oCAAnC,eADzC,mEAEW,uBAAGD,UAAU,iBAAiBC,KAAK,uGAAuGvG,OAAO,UAAjJ,8BAFX,0CAKyC,uBAAGsG,UAAU,iBAAiBC,KAAK,4EAAnC,gBALzC,+oBAM0nB,uBAAGD,UAAU,iBAAiBC,KAAK,4DAAnC,qBAN1nB,yDAMmyB,uBAAGD,UAAU,iBAAiBC,KAAK,oCAAnC,cANnyB,qFAUA,uBAAGD,UAAU,qBAAb,OACQ,uBAAGA,UAAU,iBAAiBC,KAAK,8CAA8CvG,OAAO,UAAxF,uBADR,4CAGA,uBAAGsG,UAAU,qBAAb,6DAC8D,uBAAGA,UAAU,iBAAiBC,KAAK,qEAAqEvG,OAAO,UAA/G,iBAD9D,sDAIjB,uBAAGsG,UAAU,qBAAb,4JAEiB,8CAEA,wBAAIA,UAAU,qBAC/B,sFAEyB,uBAAGA,UAAU,iBAAiBC,KAAK,mCAAmCvG,OAAO,UAA7E,iFAFzB,aAIqB,yEAEI,uBAAGsG,UAAU,iBAAiBC,KAAK,mCAAmCvG,OAAO,UAA7E,oGAFJ,mCAIA,yEAEI,uBAAGsG,UAAU,iBAAiBC,KAAK,mCAAmCvG,OAAO,UAA7E,+EAFJ,cAMrB,2CACiB,wBAAIsG,UAAU,qBACV,4BACA,uBAAGA,UAAU,iBAAiBC,KAAK,8CAA8CvG,OAAO,UAAxF,YADA,qCAKJ,oDACA,uBAAGsG,UAAU,qBAAb,6MAG6D,uBAAGA,UAAU,iBAAiBC,KAAK,+BAA+BvG,OAAO,UAAzE,mBAH7D,W,GAzDE/F,cCwBtB,IAAM7J,GAAa,SAAC,GAA+C,IAA7CC,EAA4C,EAA5CA,OAAQC,EAAoC,EAApCA,cAAeC,EAAqB,EAArBA,OAAQC,EAAa,EAAbA,OACnD,OAAOH,EAAOI,KAAI,YAAiD,IAA9CC,EAA6C,EAA7CA,GAAIC,EAAyC,EAAzCA,KAAMC,EAAmC,EAAnCA,MAAOC,EAA4B,EAA5BA,UAAWC,EAAiB,EAAjBA,WAC3CC,EAAQ,CACVC,YAAa,GAaf,OATIH,IAEAE,EAAME,gBADJH,EACsB,OAGA,QAK1B,0BACEI,IAAKR,EACLS,EAAGb,EACDK,EAAKF,KAAI,SAAAU,GAAC,MAAK,CACbC,EAAGb,EAAOY,EAAER,KAAKS,GACjBC,EAAGb,EAAOW,EAAER,KAAKU,QAGrBC,KAAK,OACLC,OAAQX,EACRG,MAAOA,QAMTS,GAAQ,CACZC,KAAM,CACJC,MAAO,CACLC,KAAM,CACJC,SAAU,KAGdC,OAAQ,CACNF,KAAM,CACJC,SAAU,MAIhBE,QAAS,CACPH,KAAM,CACJC,SAAU,M,IAKSqI,Y,YCgDV8O,G,4MAxFXC,UAAY,SAACrY,EAAMsY,GACf,IAAMC,EAAY7V,OAAOC,KAAK3C,GAAM,GACpC,GAAIA,EAAKuY,GAEL,MAAkB,iBAAdD,EAEkBtY,EAAKuY,GAAWC,YAAY1Y,KAAI,SAACgC,EAAMgD,GACrD,IACI2T,EAAU,CAACnS,KADJxE,EAAMD,KAAKP,MAAM,KAAK,GAAK,IAAMQ,EAAMD,KAAKP,MAAM,KAAK,IAElEmX,EAAQ/V,OAAOC,KAAK3C,GAAM,IAAM8B,EAAMA,MACtC2W,EAAQ,QAAD,OAAS/V,OAAOC,KAAK3C,GAAM,KAAQ8B,EAAM4W,KAChD,IAAK,IAAI1W,EAAI,EAAGA,EAAIU,OAAOC,KAAK3C,GAAM6F,SAAU7D,EAE5CyW,EAAQ/V,OAAOC,KAAK3C,GAAMgC,IAAMhC,EAAK0C,OAAOC,KAAK3C,GAAMgC,IAAIwW,YAAY1T,GAAKhD,MAC5E2W,EAAQ,QAAD,OAAS/V,OAAOC,KAAK3C,GAAMgC,KAAQhC,EAAK0C,OAAOC,KAAK3C,GAAMgC,IAAIwW,YAAY1T,GAAK4T,KAE1F,OAAOD,KAMOzY,EAAKuY,GAAWI,aAAa7Y,KAAI,SAACgC,EAAMgD,GACtD,IACI2T,EAAU,CAACnS,KADJxE,EAAMD,KAAKP,MAAM,KAAK,GAAK,IAAMQ,EAAMD,KAAKP,MAAM,KAAK,IAElEmX,EAAQ/V,OAAOC,KAAK3C,GAAM,IAAM8B,EAAMA,MACtC2W,EAAQ,QAAD,OAAS/V,OAAOC,KAAK3C,GAAM,KAAQ8B,EAAM4W,KAChD,IAAK,IAAI1W,EAAI,EAAGA,EAAIU,OAAOC,KAAK3C,GAAM6F,SAAU7D,EAE5CyW,EAAQ/V,OAAOC,KAAK3C,GAAMgC,IAAMhC,EAAK0C,OAAOC,KAAK3C,GAAMgC,IAAI2W,aAAa7T,GAAKhD,MAC7E2W,EAAQ,QAAD,OAAS/V,OAAOC,KAAK3C,GAAMgC,KAAQhC,EAAK0C,OAAOC,KAAK3C,GAAMgC,IAAI2W,aAAa7T,GAAK4T,KAE3F,OAAOD,M,uDAOd,IAAD,EAC0BrW,KAAKI,MAA9BxC,EADD,EACCA,KAAM6B,EADP,EACOA,KAAMyW,EADb,EACaA,UAEX3T,EAAYvC,KAAKiW,UAAUrY,EAAMsY,GAEjCpM,EAAQxJ,OAAOC,KAAK3C,GACtB4E,EAAS,GACbsH,EAAMpM,KAAI,SAAC+C,EAAMiC,GACb,IAAI8T,EAhEhB,SAAsB5T,GAClB,IAAMJ,EAAS,CACXK,MACAC,OACAQ,OACAH,OACAI,WACAH,SACAI,WAGJ,OAAOhB,EAAOI,EAAQJ,EAAOiB,QAqDHC,CAAahB,GAE/B,OADAF,EAAOX,KAAK2U,GACL,KAGX,IADA,IAAIC,EAAQ,GACH7W,EAAI,EAAGA,EAAIkK,EAAMrG,SAAU7D,EAEhC6W,EAAM5U,KACF,kBAAC,KAAD,CAAMM,KAAK,WAAWhE,IAAKyB,EAAG8W,QAAS5M,EAAMlK,GAAIpB,OAAQgE,EAAO5C,GAAG,GAAI3B,YAAa,GAChF,kBAAC,KAAD,CAAUyY,QAAO,eAAU5M,EAAMlK,IAAMwV,MAAO,GAAInX,YAAa,EAAGO,OAAQgE,EAAO5C,GAAG,GAAIsG,UAAU,QAI9G,OACI,kBAAC,KAAD,CAAWkP,MAAO,KAAMuB,OAAQ,IAAK/Y,KAAM2E,EAC3CoC,OAAQ,CAAEC,IAAK,GAAIC,MAAO,GAAIE,KAAM,GAAID,OAAQ,IAChD,kBAAC,KAAD,CAAe5G,gBAAgB,QAC/B,kBAAC,KAAD,CAAOwY,QAAQ,SACf,kBAAC,KAAD,KACiB,iBAAZR,EACD,kBAAC,KAAD,CAAOxW,MAAM,8BAA8BkX,GAAM,GAAIC,SAAS,aAAaC,OAAQ,GAAIjY,SAAU,KAEjG,kBAAC,KAAD,CAAOa,MAAM,YAAYkX,GAAM,GAAIC,SAAS,aAAaC,OAAQ,GAAIjY,SAAU,MAGnF,kBAAC,KAAD,MACA,kBAAC,KAAD,CAAeR,EAAGoB,EAAMjB,OAAO,QAAQP,YAAa,EAAGY,SAAU,GACjDwP,MAAO,CAACwI,SAAU,MAAOnX,MAAO,gBAAiBnB,KAAM,QAASM,SAAU,IAC1FX,gBAAgB,UACD,iBAAdgY,EACD,kBAAC,KAAD,CAAe5X,EAAG,EAAGE,OAAO,aAAaP,YAAa,EAAGC,gBAAgB,MACzDmQ,MAAO,CAACwI,SAAU,OAAQnX,MAAO,GAAInB,KAAM,MAAOM,SAAU,MAE3E,KACD,kBAAC,KAAD,CAAQkY,SAAU,KACjBN,O,GAnFevP,aCzB5B+B,IAAiBC,K,IAuPF8N,G,kDApPX,aAAe,IAAD,8BACZ,gBAqBF5N,YAAc,SAAC1J,GACX,EAAK2J,SAAS,CACZC,UAAW5J,KAtBf,EAAK6J,SAAW,IAAIlC,EAEpB,EAAKuB,MAAQ,CACXY,UAAY,GACZF,WAAW,EACXG,YAAa,GACbC,UAAW,IAGb,EAAKH,SAASO,OAAM,SAAAlC,GAAQ,OAC1B,EAAKyB,SAAS,CACZG,UAAW5B,OAbH,E,gEAmBV5H,KAAKI,MAAM2J,WAAW/J,Q,kCAUzB,IAAD,OACQiX,EAAOC,UACJhB,EAAalW,KAAKI,MAAlB8V,UACFe,EAAK,GAqCU,iBAAdf,EAEFlW,KAAKuJ,SAAS4N,WACZ,CACIC,MAAOpX,KAAKI,MAAMgX,QACnB,SAAAC,GACH,IAAI/M,EAAc+M,EAAO3Z,KAAI,SAAAU,GACzB,MAAO,CACHT,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ,EAAItB,EAAEsB,MAAO,EAC9Be,KAAMrC,EAAEqC,SAGRwW,EAAK,GAEP,EAAK5N,SAAS,CAAEiB,eAAe,EAAKK,WAIpC,EAAKtB,SAAS,CAAEiB,eAAe,EAAKgN,gBAM5CtX,KAAKuJ,SAASgO,eACZ,CACIH,MAAOpX,KAAKI,MAAMgX,QACnB,SAAAC,GACH,IAAI/M,EAAc+M,EAAO3Z,KAAI,SAAAU,GACzB,MAAO,CACHT,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ,EAAItB,EAAEsB,MAAO,EAC9Be,KAAMrC,EAAEqC,SAGRwW,EAAK,GAEP,EAAK5N,SAAS,CAAEiB,eAAe,EAAKK,WAIpC,EAAKtB,SAAS,CAAEiB,eAAe,EAAKgN,gBA7E5B,iBAAdpB,EAEFlW,KAAKuJ,SAAS4N,WACZ,CACIC,MAAOpX,KAAKI,MAAMoX,aAClB,SAAAH,GACF,IAAI/M,EAAc+M,EAAO3Z,KAAI,SAAAU,GAC7B,MAAO,CACLT,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ,EAAItB,EAAEsB,MAAO,EAC9Be,KAAMrC,EAAEqC,KACR6V,KAAMlY,EAAEkY,SAGZ,EAAKjN,SAAS,CAAEiB,eAAe,EAAKK,cAKtC3K,KAAKuJ,SAASgO,eACZ,CACIH,MAAOpX,KAAKI,MAAMoX,aAClB,SAAAH,GACF,IAAI/M,EAAc+M,EAAO3Z,KAAI,SAAAU,GAC7B,MAAO,CACLT,GAAIS,EAAEqC,KAAK8J,MACX7K,MAAOtB,EAAEsB,MAAQ,EAAItB,EAAEsB,MAAO,EAC9Be,KAAMrC,EAAEqC,KACR6V,KAAMlY,EAAEkY,SAGZ,EAAKjN,SAAS,CAAEiB,eAAe,EAAKK,gB,kCAwD1C3K,KAAK0L,MAAQzC,IAAe,WAAY0C,KAExC3L,KAAK0L,MAAME,WAAa,IAAID,IAAoBE,SAChD,IAAIpC,EAAczJ,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC7ClC,EAAczJ,KAAK8L,kBAAkBrC,EAAa,CAChDsC,QAASC,IACTC,QAAS,CAAC,MACVrO,KAAMoC,KAAK4I,MAAM0B,cAEnB,IAAIZ,EAAY1J,KAAK0L,MAAMpO,OAAOuE,KAAK,IAAI8J,KAC3CjC,EAAY1J,KAAK8L,kBAAkBpC,EAAW,CAC5CqC,QAASK,IACTxO,KAAMoC,KAAK4I,MAAM0B,YACjB6B,UAAWnM,KAAK4I,MAAMU,YAExBtJ,KAAKwM,YAAc,CAAC9C,GACpB1J,KAAKyM,qBACLzM,KAAKqJ,SAAS,CACZI,cACAC,gB,oCAKJ,IAAID,EAAczJ,KAAK4I,MAAMa,YACzBC,EAAY1J,KAAK4I,MAAMc,UAC3BD,EAAY7L,KAAOoC,KAAK4I,MAAM0B,YAC9BZ,EAAU9L,KAAOoC,KAAK4I,MAAM0B,c,wCAGZhN,EAAQoP,GAAc,IAC7BwJ,EAAalW,KAAKI,MAAlB8V,UAEHvJ,GADJrP,EAASgD,OAAOsM,OAAOtP,EAAQoP,IACFG,YAAYC,SACvB,iBAAdoJ,EAEF5Y,EAAOyP,UAAUlL,KAAK,CACpBmL,SAAU,OACVC,OAAQN,EACRtK,IAAK4G,IAvKU,WAwKf5I,IAAK4I,IAvKU,WAwKfiE,SAAU,EACVC,SAAU,IAKZ7P,EAAOyP,UAAUlL,KAAK,CACpBmL,SAAU,OACVC,OAAQN,EACRtK,IAAK4G,IAlLU,WAmLf5I,IAAK4I,IAlLU,WAmLfiE,SAAU,EACVC,SAAU,KAIdR,EAAgBS,YAAc,kBAC9BT,EAAgBU,kBAAmB,EACnCV,EAAgB1O,YAAc,GAGrB0O,EAAgBW,OAAOC,OAAO,SACpCC,WAAWjP,KAAO0K,IA7LL,WAgMhB0D,EAAgBc,gBAAkBxE,IAAyByE,QApCxB,MAyCH1N,KAAKI,MAA7BuN,EAzC2B,EAyC3BA,WAAYC,EAzCe,EAyCfA,SAWpB,OAVAjB,EAAgBkB,OAAO9G,GAAG,OAAO,SAAA+G,GAAM,IAAD,EACHA,EAAEb,OAAOc,SAASC,YAAhCvN,GADiB,EAC5B9C,GAD4B,EACxB+B,MADwB,EACjBe,MAAMyD,EADW,EACXA,KACrBzD,EACFkN,EAAWlN,GAIXmN,EAAS1J,MAGN5G,I,2CAGW,IAAD,OAEVgM,EAAatJ,KAAK4I,MAAlBU,UACPtJ,KAAK0L,MAAMuC,YAAc,IAAItC,IAC7B3L,KAAK0L,MAAMuC,YAAYR,gBAAkBxE,IAAyByE,QAGlE,IAAIQ,EAASlO,KAAK0L,MAAMyC,eAAeC,YAAYnF,KAEnDiF,EAAOG,MAAMzP,KAAb,UACE0K,EAAY,OAAS,OADvB,qBAGA4E,EAAOI,WAAY,EACnBJ,EAAO3I,QAAQ,EAAG,EAAG,EAAG,GACxB2I,EAAOK,MAAQ,QACfL,EAAOM,YAAc,GACrBN,EAAOT,gBAAkBxE,IAAyByE,QAClDQ,EAAOL,OAAO9G,GAAG,OAAO,WACtB,EAAKqC,YAAY8E,EAAOO,UADI,IAErBnF,EAAa,EAAKV,MAAlBU,UACP,EAAKkD,YAAYhM,SAAQ,SAAAsI,GAAC,OAAKA,EAAEqD,UAAY7C,KAC7C4E,EAAOG,MAAMzP,KAAb,UACE0K,EAAY,OAAS,OADvB,0B,6CAOEtJ,KAAK0L,OACP1L,KAAK0L,MAAMgD,Y,+BAKb,OAAO,yBAAK/Q,GAAG,iB,GAjPAuJ,aCEfyH,I,WAAAA,QA8UO8I,G,kDA3UX,WAAYrX,GAAO,IAAD,8BACd,cAAMA,IA2BVsX,kBAAoB,WAChB,EAAKtI,QAAUC,IAAMC,YAErB,EAAK/F,SAAW,IAAIlC,EAEpB,EAAKkC,SAASoO,mBAAkB,SAAA1P,GAAU,OACtC,EAAKoB,SAAS,CACVpB,WAAYA,EAAW,GAAGxI,KAC1B2X,MAAOnP,EAAW,GAAGmP,MACrBI,WAAYvP,EAAW,GAAGmP,MAC1BxH,UAAW3H,EAAW,GAAG2H,YAC1B,WACC,EAAKT,aAAa,MAClB,EAAKC,QAAQ8B,QAAQe,eAAe,CAChCmF,MAAO,EAAKxO,MAAM4O,aAEtB,EAAK9Z,IAAIsM,UAAU,EAAKpB,MAAMqB,oBAItC,EAAKV,SAASO,OAAM,SAAAlC,GAAQ,OAC1B,EAAKyB,SAAS,CACZG,UAAW5B,QAlDD,EAkJlBmI,QAAU,SAAAC,GACN,EAAKtS,IAAMsS,GAnJG,EA+JlBC,aAAe,WACX,EAAK5G,SAAS,CACd6G,aAAa,KAjKC,EAsKlBtC,SAAW,SAAC1J,GACR,EAAKmF,SAAS,CACd6G,aAAa,EACbC,iBAAiB,kCAAD,OAAoCjM,MAzKtC,EA6KlBkM,cAAgB,WAAK,IAAD,EACiC,EAAKxH,MAA/CwO,EADS,EACTA,MAAiBI,GADR,EACFI,SADE,EACQJ,YAAY5H,EADpB,EACoBA,UAChC5H,EAAc,IAAIzI,KAAJ,UAAYqQ,EAAZ,WAClB5H,EAAYsI,QAAQtI,EAAYuI,QAAQhR,MAAQ,EAAE6X,GAIlD,IAFA,IAAI5G,EAAQ,GACR5Q,EAAI,EACAA,GAAK,GAAKwX,EAAQxX,GAAG4X,GAE1BhH,EAAM4G,EAAMxX,GAAZ,UAAoBoI,EAAYyI,WAAW,EAA3C,YAAgDzI,EAAYuI,WAC5DvI,EAAYsI,QAAQtI,EAAYuI,QAAQhR,MAAQ,GAChDK,IAKH,IAHAA,EAAI,GACJoI,EAAc,IAAIzI,KAAJ,UAAYqQ,EAAZ,YACFU,QAAQtI,EAAYuI,QAAQhR,MAAQ,GAAG6X,EAAM,IAClDxX,GAAK,GAAKwX,EAAQxX,GAAK,GAE1B4Q,EAAM4G,EAAQxX,GAAd,UAAsBoI,EAAYyI,WAAW,EAA7C,YAAkDzI,EAAYuI,WAC9DvI,EAAYsI,QAAQtI,EAAYuI,QAAQhR,MAAQ,GAChDK,IAIJ,OAFAoI,EAAc,IAAIzI,KAAJ,UAAYqQ,EAAZ,YACFU,QAAQtI,EAAYuI,QAAQhR,MAAQ,EAAE6X,GAC3C,CAACpP,EAAawI,IArMP,EAyMlBqH,sBAAwB,SAAA/J,GACpB,EAAKzE,SAAS,CACV6M,UAAWpI,EAAEb,OAAOvN,QACrB,WAEC,EAAKhC,IAAIsM,UAAU,EAAKpB,MAAMqB,cADb,OA3MrB,EAAKrB,MAAQ,CACTkB,MAAO,EAAK1J,MAAM0J,OAAS,GAC3BN,UAAW,GACXvB,WAAY,GACZ2H,UAAW,GACXyB,cAAe,GACf+F,MAAO,EAAKhX,MAAMgX,OAAS,EAC3BI,WAAY,EACZvN,cAAc,EACdiG,aAAa,EACbC,iBAAkB,GAClB+F,UAAW,gBAGf,EAAK/G,aAAe,EAAKA,aAAamC,KAAlB,gBACpB,EAAKC,gBAAkB,EAAKA,gBAAgBD,KAArB,gBACvB,EAAKE,eAAiB,EAAKA,eAAeF,KAApB,gBACtB,EAAK3D,WAAa,EAAKA,WAAW2D,KAAhB,gBAClB,EAAKwG,cAAgB,EAAKA,cAAcxG,KAAnB,gBACrB,EAAKI,iBAAmB,EAAKA,iBAAiBJ,KAAtB,gBACxB,EAAKrB,aAAe,EAAKA,aAAaqB,KAAlB,gBACpB,EAAK1D,SAAW,EAAKA,SAAS0D,KAAd,gBAChB,EAAKlB,cAAgB,EAAKA,cAAckB,KAAnB,gBACrB,EAAKuG,sBAAwB,EAAKA,sBAAsBvG,KAA3B,gBAzBf,E,uDAuDP7Q,GACFT,KAAK2R,eAAelR,IACrBT,KAAKmP,aAAa1G,EAAUhI,M,qCAIrBA,GACX,GAAIT,KAAK4I,MAAMkB,OAASrJ,EAAM,CAC5B,IAAMmR,EAAanJ,EAAUhI,GAC7B,OAAOT,KAAK4I,MAAMkB,MAAMhG,SAAS8N,GAEnC,OAAO,I,mCAGEC,GAAU,IAAD,OACZC,EAAUjJ,EAAUgJ,GAE1B7R,KAAKqJ,UACH,SAAAqG,GAAS,MAAK,CACZ5F,MAAM,GAAD,mBAAM4F,EAAU5F,OAAhB,CAAuB+H,QAE9B,WACE,EAAKtI,SAAS8N,OACd,CACIzO,MAAOkJ,EAAQlJ,MACfD,QAASmJ,EAAQnJ,QACjByO,MAAO,EAAKxO,MAAM4O,aAEtB,SAAA5Z,GACI,EAAKyL,UAAS,SAAAqG,GAAS,MAAK,CAC5B2B,cAAc,eACP3B,EAAU2B,cADJ,eAERQ,EAAUjU,WAMnB,EAAKwR,QAAQ8B,QAAQe,eAAe,CAClCnI,MAAO,EAAKlB,MAAMkB,a,sCAMZoI,GACZlS,KAAKqJ,UAAS,SAAAqG,GACZ,MAAO,CAGL5F,MAAO4F,EAAU5F,MAAM3J,QAAO,SAAA0R,GAAO,OAAIA,IAAYK,KACrDb,cAAe/Q,OAAOC,KAAKmP,EAAU2B,eAClClR,QAAO,SAAA0R,GAAO,OAAIA,IAAYK,KAC9BC,QAAO,SAACC,EAAkBP,GACzB,OAAO,eACFO,EADL,eAEGP,EAAUnC,EAAU2B,cAAcQ,OAEpC,U,qCAKES,EAAeC,GAG1B,IAAMG,EAAY1S,KAAK4I,MAAMkB,MACvB6I,EAAWJ,EAAUzI,MAC3B,GAAI6I,GAAYD,EAChB,CACI,IAAME,EAAaD,EAASxS,QACxB,SAAA0R,GAAO,OAAKa,EAAU5O,SAAS+N,MAEzBgB,EAAgBH,EAAUvS,QAChC,SAAA0R,GAAO,OAAKc,EAAS7O,SAAS+N,MAG9Be,EAAWpS,QAAQR,KAAKmP,cACxB0D,EAAcrS,QAAQR,KAAKuR,oB,oCAKzB6F,GAAQ,IAAD,OACjBpX,KAAKqJ,SAAS,CAAE+N,UAAS,WACjB,EAAKxO,MAAMqB,cACX,EAAKvM,IAAIsM,UAAU,EAAKpB,MAAMqB,mB,uCAUzB6I,GACb9S,KAAKqJ,SAAS,CACZY,aAAc6I,IAEhB9S,KAAKtC,IAAIsM,UAAU8I,K,+BAuDd,IAAD,SAWE9S,KAAK4I,MATPkB,EAFA,EAEAA,MACAN,EAHA,EAGAA,UACA4N,EAJA,EAIAA,MACA/F,EALA,EAKAA,cACApH,EANA,EAMAA,aACAuN,EAPA,EAOAA,WACAtH,EARA,EAQAA,YACAC,EATA,EASAA,iBACA+F,EAVA,EAUAA,UAEElD,EAAiBxJ,EACtBrJ,QAAO,SAAAM,GAAI,OAAK,EAAKkR,eAAelR,MACpC/C,IAAI+K,GACJhG,OACA/E,KAAI,SAAAoL,GACL,OAAO,kBAAC,GAAD,CAAQ3K,IAAK2K,GAAb,IAAkBA,EAAlB,QAjBH,EAoByB9I,KAAKoQ,gBApB9B,mBAoBGpI,EApBH,KAoBgBwI,EApBhB,KAqBEnR,EAAS2I,EAAYyI,WAAa,EAAG,GAA7B,WAAqCzI,EAAYyI,WAAa,GAAMzI,EAAYyI,WAAa,EACrGhR,EAAQuI,EAAYuI,UAAU,GAAvB,WAAgCvI,EAAYuI,WAAavI,EAAYuI,UAC5EwH,EAAsB,UAAM1Y,EAAN,YAAeI,GAC3C,OACI,yBAAK8T,UAAU,cACX,uBAAKpR,KAAK,OAAOgE,QAAQ,gBACzB,uBAAKyO,KAAM,IACN1E,EACG,uBACAuE,QAAO,UAAMtE,GACbiD,YAAa,+BACbjR,KAAK,QACLuS,UAAQ,EACRC,QAAS3U,KAAKiQ,eACV,KAER,yBAAKsD,UAAU,gBACX,uBACIvD,IAAKhQ,KAAKoP,QACVoC,eAAgBxR,KAAKwR,gBAErB,sBAAMwD,KAAN,CACI3G,MAAM,QACNnK,KAAK,QACL+Q,MAAO,CAAC,CAAEC,UAAU,EAAMT,QAAS,0BAEnC,uBACAU,KAAK,WACLnX,MAAO,CAAEoX,MAAO,QAChBC,YAAY,gBAEXrC,IAIL,sBAAMgC,KAAN,CACI3G,MAAM,gBACNnK,KAAK,QACL+Q,MAAO,CACP,CAAEC,UAAU,EAAMT,QAAS,4CAG3B,uBACIjE,MAAOA,EACP8E,aAAc8B,EACd/U,IAAM+U,EAAM,GAAG,EAAEA,EAAM,EAAG,EAC1B/W,IAAK+W,EAAM,GAAGI,EAAWJ,EAAM,EAAEI,EACjCjC,cAAevV,KAAK8X,kBAIhC,yBAAKvE,UAAU,eAAf,qBACI,sBAAOkC,MAAP,CACI/V,MAAOwW,EACPN,SAAU5V,KAAK6X,uBAEf,uBAAOnY,MAAM,gBAAb,+BACA,uBAAOA,MAAM,OAAb,+BAGR,kDAEA,uBACIkW,SAAU5V,KAAK0R,sBAK3B,uBAAKkD,KAAM,IACX,yBAAKrB,UAAU,eACX,kBAAC,GAAD,CAAUA,UAAU,YACpBxJ,WAAY/J,KAAK+P,QACjB9F,aAAcA,EACdmN,MAAOA,EACPI,WAAYA,EACZ7J,WAAY3N,KAAK2N,WACjBC,SAAY5N,KAAK4N,SACjBsI,UAAaA,OAKhBpM,EAAMrG,OACP,2BACA,uBAAKmR,KAAM,IACP,yBAAKrB,UAAU,iBACf,kBAAC,GAAD,CACI3V,KAAMyT,EACN5R,KAAMsY,EACN7B,UAAWA,OAKjB,U,GAtUMJ,iB,sCCwDTkC,I,yDAnEX,WAAY5X,GAAO,IAAD,8BACd,cAAMA,IAMV6X,gBAAkB,SAACnK,GAClB,IAAD,EACsG,EAAK1N,MAAhG8X,EADX,EACWA,iBAAkBC,EAD7B,EAC6BA,cAAeC,EAD5C,EAC4CA,cAAeC,EAD3D,EAC2DA,oBAAqBC,EADhF,EACgFA,mBACrEna,EAAO2P,EAAP3P,IACP,EAAKkL,SAAS,CACVkP,WAAYzK,EAAE3P,MAEN,aAARA,EAEA+Z,IAEa,gBAAR/Z,EAELga,IAEa,qBAARha,EAELia,IACe,gBAARja,EACPka,IAEa,eAARla,GACLma,KA3BJ,EAAK1P,MAAQ,CACT4P,aAAc,YAHJ,E,qDAkCd,IAAIC,EAAMC,OAAOC,SAASnF,KAC1B,OACI,uBAAKD,UAAU,oBACf,2BACI,yBACIA,UAAU,OACVqF,IAAI,uEACJC,IAAI,SAGZ,2BACI,wBAAMpa,MAAM,QACR0W,KAAK,aACLU,QAAS7V,KAAKiY,gBACda,oBACIL,EAAI3U,SAAS,SAAS,CAAC,oBACtB2U,EAAI3U,SAAS,SAAS,CAAC,eACvB2U,EAAI3U,SAAS,eAAe,CAAC,eAC7B2U,EAAI3U,SAAS,cAAc,CAAC,cAC5B,CAAC,aAEN,uBAAMkR,KAAN,CAAW7W,IAAI,YAAf,qBACA,uBAAM6W,KAAN,CAAW7W,IAAI,oBAAf,uBACA,uBAAM6W,KAAN,CAAW7W,IAAI,cAAf,cACA,uBAAM6W,KAAN,CAAW7W,IAAI,eAAf,eACA,uBAAM6W,KAAN,CAAW7W,IAAI,eAAf,mB,GA7DC+I,c,iGCCftJ,GAAO,CACTmb,IAAK,CACTC,mBAAoB,CAChB,CACC/U,MAAO,CACXC,KAAM,YACNkP,YAAa,gCACb6F,KAAM,+CAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,kBACNkP,YAAa,qJACb6F,KAAM,yCAENC,KAAM,MACH,CACCjV,MAAO,CACXC,KAAM,aACNkP,YAAa,uDACb6F,KAAM,+BAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,uBACNkP,YAAa,yIACb6F,KAAM,2BAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,YACNkP,YAAa,mEACb6F,KAAM,sFAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,kBACNkP,YAAa,yFACb6F,KAAM,uDAENC,KAAM,MACH,CACCjV,MAAO,CACXC,KAAM,mBACNkP,YAAa,wEACb6F,KAAM,oCAENC,KAAM,MACH,CACCjV,MAAO,CACXC,KAAM,uBACNkP,YAAa,+CACb6F,KAAM,4BAENC,KAAM,SAEPC,eAAgB,CACZ,CACClV,MAAO,CACXC,KAAM,kBACNkP,YAAa,qJACb6F,KAAM,yCAENC,KAAM,MACH,CACCjV,MAAO,CACXC,KAAM,YACNkP,YAAa,gCACb6F,KAAM,+CAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,aACNkP,YAAa,uDACb6F,KAAM,+BAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,uBACNkP,YAAa,yIACb6F,KAAM,2BAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,mBACNkP,YAAa,wEACb6F,KAAM,oCAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,YACNkP,YAAa,mEACb6F,KAAM,sFAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,kBACNkP,YAAa,yFACb6F,KAAM,uDAENC,KAAM,OACH,CACCjV,MAAO,CACXC,KAAM,uBACNkP,YAAa,+CACb6F,KAAM,4BAENC,KAAME,QAqGQC,G,wKA/FDC,GACN,IAAIC,EAAW,GACf,OAAQD,GACJ,KAAK,EACDC,EAAW,sDACX,MACJ,KAAK,EACDA,EAAW,kEACX,MACJ,KAAK,EACDA,EAAW,kEACX,MACJ,QACIA,EAAW,iDAAmDD,EAAS,cAI/E,OAAO,wBAAQ/F,UAAU,cAAcqF,IAAKW,EAAUV,IAAI,O,+BAIpD,IAAD,OACL,OACI,yBAAKtF,UAAU,gBACX,yBAAKA,UAAU,QACX,2BAEI,uBAAKqB,KAAM,IACP,wBAAIrB,UAAU,SAAd,+BACA,wBAAMA,UAAU,cACZiG,WAAW,aACXC,WAAY7b,GAAKmb,IAAIC,mBACrBU,WAAY,SAAAC,GAAI,OACZ,uBAAM3E,KAAN,KACI,uBAAMA,KAAK4E,KAAX,CACIC,OAAQ,EAAKC,UAAUlc,GAAKmb,IAAIC,mBAAmBe,QAAQJ,GAAQ,GACnExG,MAAO,uBAAGI,UAAU,aAAaC,KAAMmG,EAAK1V,MAAMgV,MAAOU,EAAK1V,MAAMC,MACpEkP,YAAauG,EAAK1V,MAAMmP,cAE5B,yBAAKG,UAAU,WACX,uCAAY,0BAAMA,UAAU,SAASoG,EAAKT,aAM9D,uBAAKtE,KAAM,IACP,wBAAIrB,UAAU,SAAd,wCACA,wBAAMA,UAAU,cACZiG,WAAW,aACXC,WAAY7b,GAAKmb,IAAII,eACrBO,WAAY,SAAAC,GAAI,OACZ,uBAAM3E,KAAN,KACI,uBAAMA,KAAK4E,KAAX,CACIC,OAAQ,EAAKC,UAAUlc,GAAKmb,IAAII,eAAeY,QAAQJ,GAAQ,GAC/DxG,MAAO,uBAAGI,UAAU,aAAaC,KAAMmG,EAAK1V,MAAMgV,MAAOU,EAAK1V,MAAMC,MACpEkP,YAAauG,EAAK1V,MAAMmP,cAE5B,yBAAKG,UAAU,WACX,uCAAY,0BAAMA,UAAU,SAASoG,EAAKT,cAQlE,2BACI,yBAAK3F,UAAU,wBACX,yBAAKA,UAAU,QAAQqF,IAAKoB,SAK1C,uBAAGzG,UAAU,iBACH,iDADV,qHACqJ,6BADrJ,kDAEyD,uBAAGC,KAAK,6EAAR,iBAFzD,kGAGuG,6BAHvG,0DAIiE,6BAJjE,wBAK+B,uBAAGD,UAAU,iBAAiBC,KAAK,2BAAnC,oBAL/B,yCAQM,uBAAGD,UAAU,cACT,0CADJ,4JAEuF,6BAFvF,+P,GAnFMrM,a,8BC3HX,SAAS+S,GAAS7Z,GAAQ,IAAD,EACN8Z,mBAAS,MADH,mBAC/BC,EAD+B,KACrBC,EADqB,KAGtC,SAASC,EAAT,GAA8C,IAAbF,EAAY,EAAZA,SAC/BC,EAAYD,GAKOG,SAASC,iBAAiB,iCAChC/Z,SAAQ,SAAAga,GAAU,IACnBxc,EAAUwc,EAAVxc,MACRA,EAAM4G,IAAM,IACZ5G,EAAM+G,KAAO,IACb/G,EAAMyc,UAAY,MAdc,IAkB9BC,EAAQta,EAARsa,IACR,OACE,kBAAC,UAAD,CACEC,eAAa,EACbC,YAAa,IACbC,YAAa,WACbC,OAAQ,gBAAGC,EAAH,EAAGA,KAAH,OACR,6BACE,kBAAC,YAAD,CACEC,KAAMN,EACNO,QAAS,CAAEC,UAAW,iBACtBC,cAAed,GAEde,MAAMC,KAAK,IAAID,MAAMjB,IAAW,SAACmB,EAAI1Y,GAAL,OAC7B,kBAAC,QAAD,CAAMwS,MAAS2F,EAAK3F,MAAOjX,IAAG,eAAUyE,EAAQ,GAAK2Y,WAAY3Y,EAAQ,YAlCvF4Y,SAAMC,oBAAoBP,UAA1B,kDAAiFM,SAAME,QAAvF,kB,yBCwGeC,G,kDA/Fb,WAAYvb,GAAO,IAAD,8BAChB,cAAMA,IAUR8X,iBAAmB,WACjB,EAAK7O,SAAS,CACZ6O,kBAAiB,EACjBC,eAAe,EACfC,eAAe,EACfC,qBAAqB,EACrBC,oBAAoB,KAjBN,EAqBlBH,cAAgB,WACd,EAAK9O,SAAS,CACZ6O,kBAAkB,EAClBC,eAAc,EACdC,eAAe,EACfC,qBAAqB,EACrBC,oBAAoB,KA3BN,EA+BlBF,cAAgB,WACd,EAAK/O,SAAS,CACZ6O,kBAAkB,EAClBC,eAAc,EACdC,eAAe,EACfE,oBAAoB,EACpBD,qBAAqB,KArCP,EAyClBA,oBAAsB,WACpB,EAAKhP,SAAS,CACZ6O,kBAAkB,EAClBC,eAAe,EACfC,eAAe,EACfC,qBAAqB,EACrBC,oBAAoB,KA/CN,EAmDlBA,mBAAqB,WACnB,EAAKjP,SAAS,CACZ6O,kBAAkB,EAClBC,eAAe,EACfC,eAAe,EACfC,qBAAqB,EACrBC,oBAAoB,KAvDtB,EAAK1P,MAAQ,CACXsP,kBAAkB,EAClBC,eAAe,EACfC,eAAe,EACfC,qBAAqB,EACrBC,oBAAoB,GAPN,E,qDA6DR,IAAD,EAC2FtY,KAAK4I,MAAhGsP,EADA,EACAA,iBAAkBC,EADlB,EACkBA,cAAeC,EADjC,EACiCA,cAAeC,EADhD,EACgDA,oBAAqBC,EADrE,EACqEA,mBAC5E,OACE,kBAAC,KAAD,CAAYsD,SAAS,KAClB1D,EAAiB,kBAAC,KAAD,CAAU2D,GAAG,MAAM,KACpCvD,EAAmB,kBAAC,KAAD,CAAUuD,GAAG,gBAAgB,KAChDzD,EAAc,kBAAC,KAAD,CAAUyD,GAAG,WAAW,KACtC1D,EAAc,kBAAC,KAAD,CAAU0D,GAAG,WAAW,KACtCxD,EAAoB,kBAAC,KAAD,CAAUwD,GAAG,iBAAiB,KACnD,kBAAC,GAAD,CAAQ3D,iBAAoBlY,KAAKkY,iBAC/BI,mBAAsBtY,KAAKsY,mBACrBF,cAAiBpY,KAAKoY,cACtBD,cAAiBnY,KAAKmY,cACtBE,oBAAuBrY,KAAKqY,sBAEpC,kBAAC,KAAD,KACE,kBAAC,KAAD,CAAOyD,OAAK,EAACC,KAAK,IAChBjB,OAAQ,SAAC1a,GAAD,OAAW,kBAAC,EAAmBA,MACzC,kBAAC,KAAD,CAAO0b,OAAK,EAACC,KAAK,SAChBjB,OAAQ,SAAC1a,GAAD,OAAW,kBAAC,GAAcA,MAEpC,kBAAC,KAAD,CAAO0b,OAAK,EAACC,KAAK,SAChBjB,OAAQ,SAAC1a,GAAD,OAAW,kBAAC,GAAYA,MAClC,kBAAC,KAAD,CAAO0b,OAAK,EAACC,KAAK,eAChBjB,OAAQ,SAAC1a,GAAD,OAAW,kBAAC,GAAgBA,MACtC,kBAAC,KAAD,CAAO0b,OAAK,EAACC,KAAK,eACf,kBAAC,GAAD,CAASrB,IAAKA,c,GAxFFxT,aCDL8U,QACW,cAA7BtD,OAAOC,SAASsD,UAEe,UAA7BvD,OAAOC,SAASsD,UAEhBvD,OAAOC,SAASsD,SAASC,MACvB,2DCZNC,IAASrB,OAAO,kBAAC,GAAD,MAAgBR,SAAS8B,eAAe,SD6HlD,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrB7U,MAAK,SAAA8U,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAMlI,a,kBEzI5B,SAASoI,EAAoBC,GAC5B,IAAIhP,EAAI,IAAIiP,MAAM,uBAAyBD,EAAM,KAEjD,MADAhP,EAAEkP,KAAO,mBACHlP,EAEP+O,EAAoBtc,KAAO,WAAa,MAAO,IAC/Csc,EAAoBI,QAAUJ,EAC9BK,EAAOC,QAAUN,EACjBA,EAAoBlf,GAAK,K,0CCRzBuf,EAAOC,QAAU,IAA0B,uC,oBCA3CD,EAAOC,QAAU,IAA0B,wC,+LCA3CD,EAAOC,QAAU,IAA0B,uC,oBCA3CD,EAAOC,QAAU,IAA0B,uC,oBCA3CD,EAAOC,QAAU,IAA0B,uC","file":"static/js/main.6f34f941.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { ResponsiveLine } from \"@nivo/line\";\r\nimport moment from \"moment\";\r\nimport numeral from \"numeral\";\r\nimport {\r\n  red,\r\n  volcano,\r\n  organge,\r\n  yellow,\r\n  gold,\r\n  lime,\r\n  green,\r\n  cyan,\r\n  blue,\r\n  geekblue,\r\n  purple,\r\n  magenta\r\n} from \"@ant-design/colors\";\r\n\r\nfunction getLineColor(index) {\r\n  const colors = [\r\n    red,\r\n    gold,\r\n    green,\r\n    blue,\r\n    volcano,\r\n    yellow,\r\n    cyan,\r\n    purple,\r\n    organge,\r\n    lime,\r\n    geekblue,\r\n    magenta\r\n  ];\r\n\r\n  return colors[index % colors.length];\r\n}\r\n\r\n// Custom layer for Nivo Line that allows us to display predictions as dashed\r\n// lines.\r\nconst DashedLine = ({ series, lineGenerator, xScale, yScale }) => {\r\n  return series.map(({ id, data, color, predicted, distancing }) => {\r\n    let style = {\r\n      strokeWidth: 3\r\n    };\r\n\r\n    // Add custom style if predicted.\r\n    if (predicted) {\r\n      if (distancing) {\r\n        style.strokeDasharray = \"6, 4\";\r\n      } else {\r\n        // Display a sparser pattern for no social distancing.\r\n        style.strokeDasharray = \"2, 6\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <path\r\n        key={id}\r\n        d={lineGenerator(\r\n          data.map(d => ({\r\n            x: xScale(d.data.x),\r\n            y: yScale(d.data.y)\r\n          }))\r\n        )}\r\n        fill=\"none\"\r\n        stroke={color}\r\n        style={style}\r\n      />\r\n    );\r\n  });\r\n};\r\n\r\nconst theme = {\r\n  axis: {\r\n    ticks: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    },\r\n    legend: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    }\r\n  },\r\n  legends: {\r\n    text: {\r\n      fontSize: 18\r\n    }\r\n  }\r\n};\r\n\r\nclass Covid19Graph extends Component {\r\n  parseDate(dateStr) {\r\n    let [year, month, day] = dateStr.split(\"-\").map(Number);\r\n    // Month in JS is 0-based.\r\n    month -= 1;\r\n    return new Date(year, month, day);\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getCumulativeData\r\n   * returns it in Nivo format.\r\n   */\r\n  getCumulativeData(data) {\r\n    return data.map(d => ({\r\n      x: this.parseDate(d.date),\r\n      y: d.value\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getDeltaData returns\r\n   * the adjacent difference of the timeseries, in Nivo format.\r\n   * @param initialVal - The initial value that is subtracted from the 1st\r\n   *  element.\r\n   */\r\n  getDeltaData(data, initialVal) {\r\n    return data.map((d, i) => {\r\n      if (i === 0) {\r\n        return {\r\n          x: this.parseDate(d.date),\r\n          y: d.value - initialVal\r\n        };\r\n      }\r\n\r\n      return {\r\n        x: this.parseDate(d.date),\r\n        y: d.value - data[i - 1].value\r\n      };\r\n    });\r\n  }\r\n\r\n  // processData properly formats the given data, and performs special\r\n  // operations based on parameter values.\r\n  processData(data, params) {\r\n    const { statistic, yScale, initialVal } = params;\r\n\r\n    // Determine whether we need to calculate deltas between points.\r\n    let retData =\r\n      statistic === \"delta\"\r\n        ? this.getDeltaData(data, initialVal)\r\n        : this.getCumulativeData(data);\r\n\r\n    // Remove all points with y = 0 if we're using log scale, otherwise it will\r\n    // break.\r\n    if (yScale === \"log\") {\r\n      retData = retData.filter(({ x, y }) => y > 0);\r\n    }\r\n\r\n    return retData;\r\n  }\r\n\r\n  /**\r\n   * getDataMax returns the maximum value present in the data supplied to the\r\n   * graph.\r\n   */\r\n  getDataMax() {\r\n    const { data } = this.props;\r\n\r\n    let max = 0;\r\n\r\n    Object.keys(data).forEach(area => {\r\n      const { observed, predictions } = data[area];\r\n      max = Math.max(max, Math.max(...observed.map(({ value }) => value)));\r\n\r\n      predictions.forEach(p => {\r\n        const timeSeries = p.time_series;\r\n        max = Math.max(max, Math.max(...timeSeries.map(({ value }) => value)));\r\n      });\r\n    });\r\n\r\n    return max;\r\n  }\r\n\r\n  /**\r\n   * getYAxisProps returns the corresponding Nivo line props for supporting\r\n   * different Y axis types (linear and log).\r\n   */\r\n  getYAxisProps() {\r\n    const { statistic, yScale } = this.props;\r\n\r\n    const linearAxisLeft = {\r\n      // Format large y numbers as their abbreviations.\r\n      format: y => numeral(y).format(\"0.[0]a\"),\r\n      orient: \"left\",\r\n      tickSize: 5,\r\n      tickPadding: 5,\r\n      tickRotation: 0,\r\n      legend: statistic === \"delta\" ? \"New Cases\" : \"Cumulative Cases\",\r\n      legendOffset: -60,\r\n      legendPosition: \"middle\"\r\n    };\r\n\r\n    let logTickValues = [];\r\n    for (let i = 0; i <= Math.ceil(Math.log10(this.getDataMax())); i++) {\r\n      logTickValues.push(Math.pow(10, i));\r\n    }\r\n\r\n    // The 'axisLeft' prop for log scale is the same as for linear axis, except\r\n    // that the tick values must be supplied.\r\n    const logAxisLeft = {\r\n      ...linearAxisLeft,\r\n      tickValues: logTickValues\r\n    };\r\n\r\n    // For log scale Y axes, we must supply the Y tick values for the grid, as\r\n    // well as specifying the min/ max, since it seems like Nivo cannot\r\n    // automatically determine the domain for log scale.\r\n    if (yScale === \"log\") {\r\n      return {\r\n        axisLeft: logAxisLeft,\r\n        gridYValues: logTickValues,\r\n        yScale: {\r\n          type: \"log\",\r\n          base: 10,\r\n          min: Math.min(...logTickValues),\r\n          max: Math.max(...logTickValues)\r\n        }\r\n      };\r\n    }\r\n\r\n    return {\r\n      axisLeft: linearAxisLeft,\r\n      yScale: {\r\n        type: \"linear\",\r\n        min: \"auto\",\r\n        max: \"auto\"\r\n      }\r\n    };\r\n  }\r\n\r\n  render() {\r\n    let { data } = this.props;\r\n    const { statistic, yScale, dataType } = this.props;\r\n    // chartData contains the data that we will pass into Nivo line chart.\r\n    let chartData = [];\r\n    // colors holds hex values for each line in the chart.\r\n    let colors = [];\r\n\r\n    // Sort the data by area name (so we have a consistent coloring) and then\r\n    // loop over each area.\r\n    Object.keys(data)\r\n      .sort()\r\n      .forEach((area, idx) => {\r\n        const lineColor = getLineColor(idx);\r\n        const observedConfirmed = data[area].observed\r\n        const observedDeath = data[area].observed_deaths;\r\n        // Add the observed infection data if confirmed is selected\r\n        if (dataType.includes(\"confirmed\"))\r\n        {\r\n          chartData.push({\r\n            id: area,\r\n            data: this.processData(observedConfirmed, {\r\n              statistic: statistic,\r\n              yScale: yScale,\r\n              initialVal: 0\r\n            }),\r\n            // 'predicted' is a custom prop that we add so later we can tell the\r\n            // difference between observed/predicted data when drawing the lines.\r\n            predicted: false\r\n          });\r\n  \r\n          colors.push(lineColor[4]);\r\n        }\r\n        if (dataType.includes(\"death\"))\r\n        {\r\n          //also push death value to the same graph\r\n          chartData.push({\r\n            id: `${area} death`,\r\n            data: this.processData(observedDeath, {\r\n              statistic: statistic,\r\n              yScale: yScale,\r\n              initialVal: 0\r\n            }),\r\n            // 'predicted' is a custom prop that we add so later we can tell the\r\n            // difference between observed/predicted data when drawing the lines.\r\n            predicted: false\r\n          });\r\n\r\n          colors.push(lineColor[6])\r\n        }\r\n        \r\n        // Add the data for each of the predicted time series. Filter out time\r\n        // series that don't have any data associated.\r\n        data[area].predictions\r\n          .filter(p => p.time_series.length > 0)\r\n          .forEach((p,idx) => {\r\n            const modelName = p.model.name;\r\n            const isDeathModel = modelName.substring(0, 10) !== \"SI-kJalpha\" || modelName.includes(\"death prediction\")\r\n            const distancing = p.distancing;\r\n            const timeSeries = p.time_series;\r\n            //check if the model is a death model\r\n            let augmented_timeSeries = []\r\n            if (dataType.includes(\"death\") && isDeathModel)\r\n            {\r\n              augmented_timeSeries = [observedDeath[observedDeath.length - 1]].concat(timeSeries);\r\n            }\r\n            else if (dataType.includes(\"confirmed\") && !isDeathModel)\r\n            {\r\n              augmented_timeSeries = [observedConfirmed[observedConfirmed.length - 1]].concat(timeSeries);\r\n            }\r\n            else\r\n            {\r\n              return\r\n            }\r\n            chartData.push({\r\n              id: `${area} (${modelName}, distancing=${distancing})`,\r\n              // If we're displaying deltas, we pass in the last observed value as\r\n              // the initial value for calculating the predicted deltas.\r\n              data: this.processData(augmented_timeSeries, {\r\n                statistic: statistic,\r\n                yScale: yScale,\r\n                initialVal: isDeathModel?observedDeath[observedDeath.length - 2].value:observedConfirmed[observedConfirmed.length - 2].value\r\n              }),\r\n              // 'predicted' is a custom prop that we add so later we can tell the\r\n              // difference between observed/predicted data when drawing the lines.\r\n              predicted: true,\r\n              // 'distancing' is also a custom prop we add so we can draw the\r\n              // line patterns differently between yes/no social distancing.\r\n              distancing: distancing\r\n            });\r\n            if (idx <= 4)\r\n            {\r\n              colors.push(lineColor[4+idx]);\r\n            }\r\n            else if (idx <= 8)\r\n            {\r\n              colors.push(lineColor[8 - idx]);\r\n\r\n            }\r\n            else \r\n            {\r\n              colors.push(lineColor[idx%10]);\r\n            }\r\n          });\r\n      });\r\n\r\n    // Determine whether we need to show weeks or months on the X axis.\r\n    let tickValues = \"every week\";\r\n\r\n    if (chartData.length > 0) {\r\n      // Calculate the minimum and maximum dates present in the data.\r\n      let minDate = chartData[0].data[0].x;\r\n      let maxDate = chartData[0].data[0].x;\r\n\r\n      chartData.forEach(({ data }) => {\r\n        data.forEach(({ x }) => {\r\n          minDate = Math.min(minDate, x);\r\n          maxDate = Math.max(maxDate, x);\r\n        });\r\n      });\r\n\r\n      minDate = moment(minDate);\r\n      maxDate = moment(maxDate);\r\n\r\n      // Switch to 'every month' if the date range is over a certain threshold.\r\n      const diffInDays = maxDate.diff(minDate, \"days\");\r\n      if (diffInDays > 150) {\r\n        tickValues = \"every month\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <ResponsiveLine\r\n        data={chartData}\r\n        colors={colors}\r\n        //50,50,50,80\r\n        margin={{ top: 10, right: 50, bottom: 70, left: 100 }}\r\n        xScale={{\r\n          type: \"time\",\r\n          format: \"native\",\r\n          precision: \"day\"\r\n        }}\r\n        axisBottom={{\r\n          // tickValues determines how often / with what values our 'format'\r\n          // func is called.\r\n          tickValues: tickValues,\r\n          // A custom 'format' func is required since all the x values are\r\n          // javascript Date objects.\r\n          format: date => {\r\n            return moment(date).format(\"M/D\");\r\n          },\r\n          orient: \"bottom\",\r\n          tickSize: 5,\r\n          tickPadding: 5,\r\n          tickRotation: 0,\r\n          legend: \"Date\",\r\n          legendOffset: 36,\r\n          legendPosition: \"middle\"\r\n        }}\r\n        // Set up the Y axis.\r\n        {...this.getYAxisProps()}\r\n        enableSlices=\"x\"\r\n        sliceTooltip={({ slice }) => {\r\n          return (\r\n            <div\r\n              style={{\r\n                background: \"white\",\r\n                padding: \"9px 12px\",\r\n                border: \"1px solid #ccc\"\r\n              }}\r\n            >\r\n              <div>\r\n                {// Grab the date from the first point, this will be the title of\r\n                // the tooltip.\r\n                moment(slice.points[0].data.x).format(\"MMM Do YYYY\")}\r\n              </div>\r\n              {slice.points.map(point => (\r\n                <div\r\n                  key={point.id}\r\n                  style={{\r\n                    color: point.serieColor,\r\n                    padding: \"3px 0\"\r\n                  }}\r\n                >\r\n                  <strong>{point.serieId}</strong>[\r\n                  {numeral(point.data.yFormatted).format(\"0.[0]a\")}]\r\n                </div>\r\n              ))}\r\n            </div>\r\n          );\r\n        }}\r\n        pointSize={0}\r\n        pointLabel=\"y\"\r\n        pointLabelYOffset={-12}\r\n        legends={[\r\n          {\r\n            anchor: \"top-left\",\r\n            direction: \"column\",\r\n            justify: false,\r\n            translateX: 0,\r\n            translateY: 0,\r\n            itemsSpacing: 0,\r\n            itemDirection: \"left-to-right\",\r\n            itemWidth: 80,\r\n            itemHeight: 20,\r\n            itemOpacity: 0.75,\r\n            symbolSize: 12,\r\n            symbolShape: \"circle\",\r\n            symbolBorderColor: \"rgba(0, 0, 0, .5)\",\r\n            effects: [\r\n              {\r\n                on: \"hover\",\r\n                style: {\r\n                  itemBackground: \"rgba(0, 0, 0, .03)\",\r\n                  itemOpacity: 1\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]}\r\n        layers={[\r\n          \"grid\",\r\n          \"markers\",\r\n          \"areas\",\r\n          \"crosshair\",\r\n          DashedLine,\r\n          \"slices\",\r\n          \"points\",\r\n          \"axes\",\r\n          \"legends\"\r\n        ]}\r\n        theme={theme}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19Graph;\r\n","import axios from \"axios\";\r\n\r\n// TODO: Update with actual backend URL once backend is up and running.\r\nconst API_BASE_URL = process.env.REACT_APP_BACKEND_BASE_URL;\r\n\r\nclass ModelAPI {\r\n  affected_by(callback) {}\r\n\r\n  areas(callback) {\r\n    const endpoint = `${API_BASE_URL}/areas`;\r\n    axios.get(endpoint).then(res => {\r\n      const allAreas = res.data;\r\n      callback(allAreas);\r\n    });\r\n  }\r\n\r\n  models(callback) {\r\n    const endpoint = `${API_BASE_URL}/models`;\r\n    axios.get(endpoint).then(res => {\r\n      const allModels = res.data;\r\n      callback(allModels);\r\n    });\r\n  }\r\n\r\n  infection_models(callback) {\r\n    const endpoint = `${API_BASE_URL}/infection_models`;\r\n    axios.get(endpoint).then(res => {\r\n      const infectionModels = res.data;\r\n      callback(infectionModels);\r\n    });\r\n  }\r\n\r\n  death_models(callback) {\r\n    const endpoint = `${API_BASE_URL}/death_models`;\r\n    axios.get(endpoint).then(res => {\r\n      const deathModels = res.data;\r\n      callback(deathModels);\r\n    });\r\n  }\r\n\r\n  cumulative_infections(callback) {\r\n    const endpoint = `${API_BASE_URL}/cumulative_infections`;\r\n    axios.get(endpoint).then(res => callback(res.data));\r\n  }\r\n\r\n  /**\r\n   * Params should have 'days', 'model'\r\n   */\r\n  predict_all(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/predict_all`;\r\n    axios.get(endpoint, {\r\n      params: params\r\n    }).then(res => callback(res.data));\r\n  }\r\n\r\n  /**\r\n   * Params should have 'country', 'state', 'days', 'distancingOn,' 'distancingOff'\r\n   */\r\n  predict(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/predict`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  // get the current date of observed data\r\n  getCurrentDate(callback) {\r\n    const endpoint =  `${API_BASE_URL}/current_date`;\r\n    axios.get(endpoint).then(res => {\r\n      const currentDate = res.data;\r\n      callback(currentDate);\r\n    });\r\n  }\r\n\r\n  //check previous data \r\n  checkHistory(params,callback)\r\n  {\r\n    const endpoint = `${API_BASE_URL}/check_history`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //cumulative for history\r\n  history_cumulative(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/history_cumulative`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all quarantine score at a week, parameter: weeks\r\n  scores_all(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/scores_all`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all, parameter: state, country, weeks\r\n  scores(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/scores`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get the latest date which \r\n  latest_score_date(callback) {\r\n    const endpoint =  `${API_BASE_URL}/latest_score_date`;\r\n    axios.get(endpoint).then(res => {\r\n      const latestDate = res.data;\r\n      callback(latestDate);\r\n    });\r\n  }\r\n\r\n  //get the death at latest time\r\n  cumulative_death(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/cumulative_death`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all mfr scores at a week: parameter week\r\n  all_mrf_scores(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/all_mrf_scores`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //fetch real time data for the whole world\r\n  real_time(callback) {\r\n    const EXTERNAL_API = \"https://api.covid19api.com/summary\";\r\n    axios\r\n      .get(EXTERNAL_API)\r\n      .then(res => {\r\n        const total_confirmed = res.data.Global.TotalConfirmed;\r\n        const total_deaths = res.data.Global.TotalDeaths;\r\n        const global = {\r\n          totalConfirmed: total_confirmed,\r\n          totalDeaths: total_deaths\r\n        }\r\n        callback(global);\r\n      }\r\n    )\r\n  }\r\n}\r\n\r\nexport default ModelAPI;\r\n","export function areaToStr(a) {\r\n  return `${a.country}${a.state ? \" / \" + a.state : \"\"}`;\r\n}\r\n\r\nexport function strToArea(s) {\r\n  const words = s.split(\"/\");\r\n\r\n  return {\r\n    country: words[0].trim(),\r\n    state: words.length === 2 ? words[1].trim() : \"\"\r\n  };\r\n}\r\n\r\nexport function modelToStr(a) {\r\n  return `${a.name}`;\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { Circle, Map, Marker, Popup, TileLayer } from \"react-leaflet\";\r\nimport ModelAPI from \"./modelapi\";\r\nimport { areaToStr, strToArea } from \"./covid19util\";\r\n\r\nimport * as am4core from \"@amcharts/amcharts4/core\";\r\nimport * as am4maps from \"@amcharts/amcharts4/maps\";\r\nimport am4geodata_worldLow from \"@amcharts/amcharts4-geodata/worldLow\";\r\nimport am4geodata_usaLow from \"@amcharts/amcharts4-geodata/usaLow\";\r\nimport am4geodata_chinaLow from \"@amcharts/amcharts4-geodata/chinaLow\";\r\nimport am4geodata_canadaLow from \"@amcharts/amcharts4-geodata/canadaLow\";\r\nimport am4geodata_australiaLow from \"@amcharts/amcharts4-geodata/australiaLow\";\r\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\r\n\r\nconst HEAT_MAP_MIN_COLOR = \"#fcbba0\";\r\nconst HEAT_MAP_MAX_COLOR = \"#66000d\";\r\nconst MAP_HOVER_COLOR = \"#e43027\";\r\n\r\nam4core.useTheme(am4themes_animated);\r\n\r\nclass Covid19Map extends Component {\r\n  constructor() {\r\n    super();\r\n    this.modelAPI = new ModelAPI();\r\n\r\n    this.state = {\r\n      areasList : [],\r\n      showState: false,\r\n      worldSeries: {},\r\n      usaSeries: {},\r\n      chinaSeries:{},\r\n      canadaSeries:{},\r\n      austriliaSeries:{}\r\n    }\r\n\r\n    this.modelAPI.areas(allAreas =>\r\n      this.setState({\r\n        areasList: allAreas\r\n      })\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.triggerRef(this);\r\n    this.fetchData(this.props.dynamicMapOn);\r\n  }\r\n\r\n  onShowState = (value) =>{\r\n    this.setState({\r\n      showState: value\r\n    });\r\n  }\r\n\r\n  fetchData(dynamicMapOn) {\r\n    if (!dynamicMapOn || (this.props.confirmed_model === \"\" && this.props.death_model === \"\")) {\r\n      //without dynamic map,show to cumulative cases to date\r\n      if (this.props.dataType === \"confirmed\")\r\n      {\r\n        this.modelAPI.cumulative_infections(cumulativeInfections => {\r\n          let heatmapData = cumulativeInfections.map(d => {\r\n            return {\r\n              id: d.area.iso_2,\r\n              // Adjust all heatmap values by log scale.\r\n              //value: d.value > 0 ? Math.log(d.value) : 0,\r\n              value: Math.log(d.percentage),\r\n              // Store the true value so we can display tooltips correctly.\r\n              valueTrue: d.value,\r\n              area: d.area\r\n            };\r\n          });\r\n          this.setState({ heatmapData }, this.initChart);\r\n        });\r\n      }\r\n      else\r\n      {\r\n        this.modelAPI.cumulative_death({\r\n          days: 0\r\n        },cumulativeDeath => {\r\n          let heatmapData = cumulativeDeath.map(d => {\r\n            return {\r\n              id: d.area.iso_2,\r\n              // Adjust all heatmap values by log scale.\r\n              //value: d.value > 0 ? Math.log(d.value) : 0,\r\n              value:Math.log(d.percentage),\r\n              // Store the true value so we can display tooltips correctly.\r\n              valueTrue: d.value,\r\n              area: d.area\r\n            };\r\n          });\r\n          this.setState({ heatmapData }, this.resetChart);\r\n        });\r\n      }\r\n      \r\n    } else {\r\n      //with dynamic map \r\n      if (this.props.statistic === \"cumulative\"){\r\n        if (this.props.days > 0)\r\n        {\r\n          this.modelAPI.predict_all({\r\n            days: this.props.days,\r\n            model: this.props.dataType === \"confirmed\"?this.props.confirmed_model:this.props.death_model\r\n          }, cumulativeInfections => {\r\n            let heatmapData = cumulativeInfections.map(d => {\r\n              return {\r\n                id: d.area.iso_2,\r\n                // Adjust all heatmap values by log scale.\r\n                // value: d.value > 0 ? Math.log(d.value) : 0,\r\n                value: Math.log(d.percentage),\r\n                // Store the true value so we can display tooltips correctly.\r\n                valueTrue: d.value,\r\n                area: d.area\r\n              };\r\n            });\r\n            this.setState({ heatmapData }, this.resetChart);\r\n          });\r\n        }\r\n        else\r\n        {\r\n          // show history cumulative\r\n            this.modelAPI.history_cumulative({\r\n              days: this.props.days\r\n            }, historyCumulative => {\r\n              let heatmapData = historyCumulative.map(d => {\r\n                if (this.props.dataType === \"confirmed\")\r\n                {\r\n                  return {\r\n                    id: d.area.iso_2,\r\n                    // Adjust all heatmap values by log scale.\r\n                    // value: d.value > 0 ? Math.log(d.value) : 0,\r\n                    value:Math.log(d.value_percentage),\r\n                    // Store the true value so we can display tooltips correctly.\r\n                    valueTrue: d.value,\r\n                    area: d.area\r\n                  };\r\n                }\r\n                else\r\n                {\r\n                  return {\r\n                    id: d.area.iso_2,\r\n                    // Adjust all heatmap values by log scale.\r\n                    //value: d.deathValue > 0 ? Math.log(d.deathValue) : 0,\r\n                    value: Math.log(d.death_percentage),\r\n                    // Store the true value so we can display tooltips correctly.\r\n                    valueTrue: d.deathValue,\r\n                    area: d.area\r\n                  }\r\n                }\r\n                \r\n              });\r\n              this.setState({ heatmapData }, this.resetChart);\r\n            });\r\n\r\n        }\r\n      }\r\n      else\r\n      {\r\n        //new cases\r\n        if (this.props.days>0)\r\n        {\r\n          //prediction\r\n          this.modelAPI.predict_all({\r\n            days: this.props.days,\r\n            model: this.props.dataType === \"confirmed\"?this.props.confirmed_model:this.props.death_model\r\n          }, cumulativeInfections => {\r\n            //if days is one, we need data from days = 0, which is in history_cumulative\r\n            if (this.props.days > 7)\r\n            {\r\n              this.modelAPI.predict_all({\r\n                days: this.props.days - 7,\r\n                model: this.props.dataType === \"confirmed\"?this.props.confirmed_model:this.props.death_model\r\n              }, previousCumulative =>{\r\n                let heatmapData = cumulativeInfections.map((d, index) =>{\r\n                  return {\r\n                    id: d.area.iso_2,\r\n                    value: d.value - previousCumulative[index].value > 0 ? Math.log(d.value - previousCumulative[index].value): 0,\r\n                    valueTrue:  d.value - previousCumulative[index].value > 0? d.value - previousCumulative[index].value: 0,\r\n                    area: d.area\r\n                  }\r\n                });\r\n                this.setState({ heatmapData }, this.resetChart);\r\n              });\r\n            }\r\n            else\r\n            {\r\n              this.modelAPI.history_cumulative({\r\n                days: this.props.days - 7\r\n              }, previousCumulative =>{\r\n                let heatmapData = cumulativeInfections.map((d, index) =>{\r\n                  if (this.props.dataType === \"confirmed\")\r\n                  {\r\n                    return {\r\n                      id: d.area.iso_2,\r\n                      value: d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value > 0 ? Math.log(d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value ): 0,\r\n                      valueTrue:  d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value > 0?\r\n                                  d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value:0,\r\n                      area: d.area\r\n                    }\r\n                  }\r\n                  else\r\n                  {\r\n                    return {\r\n                      id: d.area.iso_2,\r\n                      value: d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue > 0 ? Math.log(d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue ): 0,\r\n                      valueTrue:  d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue > 0?\r\n                                  d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue:0,\r\n                      area: d.area\r\n                    }\r\n                  }\r\n                  \r\n                });\r\n                this.setState({ heatmapData }, this.resetChart);\r\n              });\r\n            }\r\n          });\r\n        }\r\n        else\r\n        {\r\n          //history\r\n          this.modelAPI.history_cumulative({\r\n            days: this.props.days,\r\n          }, historyInfections => {\r\n            this.modelAPI.history_cumulative({\r\n              days: this.props.days - 7,\r\n            }, nextDayCumulative =>{\r\n              let heatmapData = historyInfections.map((d, index) =>{\r\n                if (this.props.dataType === \"confirmed\")\r\n                {\r\n                  return {\r\n                    id: d.area.iso_2,\r\n                    value: d.value - nextDayCumulative[index].value > 0 ? Math.log(d.value - nextDayCumulative[index].value): 0,\r\n                    valueTrue: d.value - nextDayCumulative[index].value > 0 ? d.value - nextDayCumulative[index].value: 0,\r\n                    area: d.area\r\n                  }\r\n                }\r\n                else\r\n                {\r\n                  return{\r\n                    id: d.area.iso_2,\r\n                    value: d.deathValue - nextDayCumulative[index].deathValue > 0 ? Math.log(d.deathValue - nextDayCumulative[index].deathValue): 0,\r\n                    valueTrue: d.deathValue - nextDayCumulative[index].deathValue > 0 ? d.deathValue - nextDayCumulative[index].deathValue: 0,\r\n                    area: d.area\r\n                  }\r\n                }\r\n                \r\n              });\r\n              this.setState({ heatmapData }, this.resetChart);\r\n            });\r\n          });\r\n        }\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n  initChart() {\r\n    // Create map instance\r\n    this.chart = am4core.create(\"chartdiv\", am4maps.MapChart);\r\n    // Set projection\r\n    this.chart.projection = new am4maps.projections.Mercator();\r\n    let worldSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n    worldSeries = this.createChartSeries(worldSeries, {\r\n      geodata: am4geodata_worldLow,\r\n      exclude: [\"AQ\"],\r\n      data: this.state.heatmapData\r\n    });\r\n    let chinaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n    chinaSeries = this.createChartSeries(chinaSeries, {\r\n      geodata: am4geodata_chinaLow,\r\n      data: this.state.heatmapData,\r\n      disabled: !this.state.showState\r\n    });\r\n    let usaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n    usaSeries = this.createChartSeries(usaSeries, {\r\n      geodata: am4geodata_usaLow,\r\n      data: this.state.heatmapData,\r\n      disabled: !this.state.showState\r\n    });\r\n    let canadaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n    canadaSeries = this.createChartSeries(canadaSeries, {\r\n      geodata: am4geodata_canadaLow,\r\n      data: this.state.heatmapData,\r\n      disabled: !this.state.showState\r\n    });\r\n    let australiaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n    australiaSeries = this.createChartSeries(australiaSeries, {\r\n      geodata: am4geodata_australiaLow,\r\n      data: this.state.heatmapData,\r\n      disabled: !this.state.showState\r\n    });\r\n    \r\n    this.stateSeries = [usaSeries];\r\n    \r\n    this.initChartInterface();\r\n\r\n    this.setState({\r\n      worldSeries,\r\n      chinaSeries,\r\n      usaSeries,\r\n      canadaSeries,\r\n      australiaSeries\r\n    });\r\n\r\n  }\r\n\r\n  createChartSeries(series, seriesProps) {\r\n    const {statistic} = this.props;\r\n    series = Object.assign(series, seriesProps);\r\n\r\n    let polygonTemplate = series.mapPolygons.template;\r\n\r\n    // Heatmap fill.\r\n    if (statistic === \"cumulative\")\r\n    {\r\n      series.heatRules.push({\r\n        property: \"fill\",\r\n        target: polygonTemplate,\r\n        min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n        max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n        minValue: 0,\r\n        maxValue: Math.log(1000)\r\n      });\r\n    }\r\n    else \r\n    {\r\n      series.heatRules.push({\r\n        property: \"fill\",\r\n        target: polygonTemplate,\r\n        min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n        max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n        minValue: 0,\r\n        maxValue: Math.log(1000)\r\n      });\r\n    }\r\n    \r\n\r\n    // Configure series tooltip. Display the true value of infections.\r\n    polygonTemplate.tooltipText = \"{name}: {valueTrue}\";\r\n    polygonTemplate.nonScalingStroke = true;\r\n    polygonTemplate.strokeWidth = 0.5;\r\n\r\n    // Create hover state and set alternative fill color.\r\n    let hs = polygonTemplate.states.create(\"hover\");\r\n    hs.properties.fill = am4core.color(MAP_HOVER_COLOR);\r\n\r\n    // Change mouse cursor to pointer.\r\n    polygonTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n\r\n    // Create click handler. Apparently ALL the series in the chart must have\r\n    // click handlers activated, so if this function is not running double-check\r\n    // that other series also have click handlers.\r\n    const { onMapClick, onNoData} = this.props;\r\n    polygonTemplate.events.on(\"hit\", e => {\r\n      const { id, value, area, name} = e.target.dataItem.dataContext;\r\n      if (area){\r\n        onMapClick(area);\r\n      }\r\n      else\r\n      {\r\n        onNoData(name);\r\n      }\r\n    });\r\n\r\n    return series;\r\n  }\r\n\r\n  initChartInterface() {\r\n    const {showState} = this.state;\r\n    // Create a zoom control.\r\n    this.chart.zoomControl = new am4maps.ZoomControl();\r\n    this.chart.zoomControl.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n\r\n    // Create a toggle button to show/hide states/provinces.\r\n    let button = this.chart.chartContainer.createChild(am4core.Button);\r\n    button.label.text = `${\r\n      showState ? \"Hide\" : \"Show\"\r\n      } States/Provinces`;\r\n    button.togglable = true;\r\n    button.padding(5, 5, 5, 5);\r\n    button.align = \"right\";\r\n    button.marginRight = 15;\r\n    button.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n    button.events.on(\"hit\", () => {\r\n      this.onShowState(button.isActive);\r\n      const {showState} = this.state;\r\n      this.stateSeries.forEach(s => {\r\n        (s.disabled = !showState);\r\n      });\r\n      button.label.text = `${\r\n        showState ? \"Hide\" : \"Show\"\r\n        } States/Provinces`;\r\n    });\r\n  }\r\n\r\n  resetChart() {\r\n    let worldSeries = this.state.worldSeries;\r\n    let usaSeries = this.state.usaSeries;\r\n    let chinaSeries = this.state.chinaSeries;\r\n    let canadaSeries = this.state.canadaSeries;\r\n    let australiaSeries = this.state.austriliaSeries;\r\n    worldSeries.data = this.state.heatmapData;\r\n    usaSeries.data = this.state.heatmapData;\r\n    canadaSeries.data = this.state.heatmapData;\r\n    chinaSeries.data = this.state.heatmapData;\r\n    australiaSeries.data = this.state.heatmapData;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.chart) {\r\n      this.chart.dispose();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    \r\n    return <div id=\"chartdiv\"></div>;\r\n  }\r\n}\r\n\r\nexport default Covid19Map;\r\n","import React, { PureComponent } from \"react\";\r\nimport Covid19Graph from \"./covid19graph\";\r\nimport Covid19Map from \"./covid19map\";\r\nimport ModelAPI from \"./modelapi\";\r\nimport { areaToStr, strToArea, modelToStr } from \"./covid19util\";\r\nimport { test_data } from \"./test_data\";\r\nimport \"./covid19predict.css\";\r\n\r\nimport {\r\n  Form,\r\n  Select,\r\n  InputNumber,\r\n  Button,\r\n  Radio,\r\n  Checkbox,\r\n  Slider,\r\n  Tooltip,\r\n  Switch,\r\n  Popover,\r\n  Alert,\r\n  Row,\r\n  Col\r\n} from \"antd\";\r\n\r\n\r\nimport {\r\n  InfoCircleOutlined\r\n} from '@ant-design/icons';\r\nimport { value } from \"numeral\";\r\nimport RadioGroup from \"antd/lib/radio/group\";\r\n\r\nconst { Option } = Select;\r\n\r\nclass Covid19Predict extends PureComponent {\r\n  handleYScaleSelect = e => {\r\n    this.setState({\r\n      yScale: e.target.value\r\n    });\r\n  };\r\n\r\n  handleStatisticSelect = e => {\r\n    this.setState({\r\n      statistic: e.target.value\r\n    });\r\n\r\n  };\r\n\r\n  handleDataTypeSelect = e => {\r\n    this.setState({\r\n      dataType: e\r\n    });\r\n  };\r\n\r\n  handleMapShownSelect = e =>{\r\n    this.setState({\r\n      mapShown: e.target.value\r\n    }, ()=>{\r\n      this.map.fetchData(this.state.dynamicMapOn);\r\n    })\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      areas: this.props.areas || [],\r\n      areasList: [],\r\n      models: this.props.models || ['SI-kJalpha - 20x'],\r\n      modelsList: [],\r\n      currentDate: \"\",\r\n      firstDate: \"\",\r\n      current: true,\r\n      worst_effort: false,\r\n      best_effort: false,\r\n      mainGraphData: {},\r\n      days: 14,\r\n      dynamicMapOn: false,\r\n      dataType: [\"confirmed\"],\r\n      statistic: \"cumulative\",\r\n      mapShown: \"confirmed\",\r\n      yScale: \"linear\",\r\n      noDataError: false,\r\n      errorDescription: \"\",\r\n      showControlInstructions: false,\r\n      showMapInstructions: false,\r\n      totalConfirmed: 0,\r\n      totalDeaths: 0\r\n    };\r\n\r\n    this.addAreaByStr = this.addAreaByStr.bind(this);\r\n    this.removeAreaByStr = this.removeAreaByStr.bind(this);\r\n    this.onValuesChange = this.onValuesChange.bind(this);\r\n    this.onMapClick = this.onMapClick.bind(this);\r\n    this.onDaysToPredictChange = this.onDaysToPredictChange.bind(this);\r\n    this.switchDynamicMap = this.switchDynamicMap.bind(this);\r\n    this.onAlertClose = this.onAlertClose.bind(this);\r\n    this.onNoData = this.onNoData.bind(this);\r\n    this.generateMarks = this.generateMarks.bind(this);\r\n    this.handleDataTypeSelect = this.handleDataTypeSelect.bind(this);\r\n    this.handleStatisticSelect = this.handleStatisticSelect.bind(this);\r\n    this.handleYScaleSelect = this.handleYScaleSelect.bind(this);\r\n    this.toggleControlInstructions = this.toggleControlInstructions.bind(this);\r\n    this.toggleMapInstructions = this.toggleMapInstructions.bind(this);\r\n  }\r\n\r\n  componentWillMount = ()=>{\r\n    this.addAreaByStr('US');\r\n\r\n    this.formRef = React.createRef();\r\n\r\n    this.modelAPI = new ModelAPI();\r\n\r\n    this.modelAPI.areas(allAreas =>\r\n      this.setState({\r\n        areasList: allAreas\r\n      })\r\n    );\r\n\r\n    this.modelAPI.infection_models(infectionModels =>\r\n      this.setState({\r\n        modelsList: infectionModels\r\n      }, ()=>{\r\n        this.modelAPI.death_models(deathModels =>{\r\n            for (let i = 6; i < deathModels.length; ++i)\r\n            {\r\n                this.setState(prevState => ({\r\n                  modelsList: [...prevState.modelsList, deathModels[i]]\r\n                }));\r\n            }\r\n          });\r\n        }\r\n    ));\r\n\r\n    this.modelAPI.getCurrentDate(currentDate => \r\n      this.setState({\r\n        currentDate: currentDate[0].date,\r\n        firstDate: currentDate[0].firstDate\r\n      })\r\n    );\r\n\r\n    this.modelAPI.real_time(global => {\r\n      this.setState({\r\n        totalConfirmed: global.totalConfirmed,\r\n        totalDeaths: global.totalDeaths\r\n      })\r\n    })\r\n  }\r\n\r\n  onMapClick(area) {\r\n    if (!this.areaIsSelected(area)) {\r\n      this.addAreaByStr(areaToStr(area));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns true if the area is already selected by the user.\r\n   */\r\n  areaIsSelected(area) {\r\n    if (this.state.areas && area) {\r\n      const newAreaStr = areaToStr(area);\r\n      return this.state.areas.includes(newAreaStr);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addAreaByStr(areaStr) {\r\n    const areaObj = strToArea(areaStr);\r\n\r\n    this.setState(\r\n      prevState => ({\r\n        areas: [...prevState.areas, areaStr]\r\n      }),\r\n      () => {\r\n        // check if days is positive or negative to decide whether check history or predict future\r\n        if (this.state.days >= 0){\r\n          this.modelAPI.predict(\r\n            {\r\n              state: areaObj.state,\r\n              country: areaObj.country,\r\n              models: this.state.models,\r\n              days: this.state.days,\r\n              current: this.state.current,\r\n              worst_effort: this.state.worst_effort,\r\n              best_effort: this.state.best_effort\r\n            },\r\n            data => {\r\n              this.setState(prevState => ({\r\n                mainGraphData: {\r\n                  ...prevState.mainGraphData,\r\n                  [areaStr]: data\r\n                }\r\n              }));\r\n            }\r\n          );\r\n        }\r\n        else{\r\n          this.modelAPI.checkHistory(\r\n            {\r\n              state: areaObj.state,\r\n              country: areaObj.country,\r\n              days: this.state.days\r\n            }, \r\n            data =>{\r\n              this.setState(prevState => ({\r\n                mainGraphData: {\r\n                  ...prevState.mainGraphData,\r\n                  [areaStr]: data\r\n                }\r\n              }));\r\n            }\r\n\r\n          );\r\n        }\r\n\r\n        this.formRef.current.setFieldsValue({\r\n          areas: this.state.areas\r\n        });\r\n      }\r\n    );\r\n  }\r\n\r\n  removeAreaByStr(targetAreaStr) {\r\n    this.setState(prevState => {\r\n      return {\r\n        // Filter out the area / graph data corresponding to the target area\r\n        // string.\r\n        areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\r\n        mainGraphData: Object.keys(prevState.mainGraphData)\r\n          .filter(areaStr => areaStr !== targetAreaStr)\r\n          .reduce((newMainGraphData, areaStr) => {\r\n            return {\r\n              ...newMainGraphData,\r\n              [areaStr]: prevState.mainGraphData[areaStr]\r\n            };\r\n          }, {})\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Returns true if the model is already selected by the user.\r\n   */\r\n  modelIsSelected(model) {\r\n    if (this.state.models && model) {\r\n      const newModelStr = modelToStr(model);\r\n      return this.state.models.includes(newModelStr);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * onValuesChange is called whenever the values in the form change. Note that\r\n   * days to predict is handled separately by onDaysToPredictChange.\r\n   */\r\n  onValuesChange(changedValues, allValues) {\r\n    const {dataType} = this.state;\r\n    if (\"socialDistancing\" in changedValues) {\r\n      // If either the social distancing or model parameters were changed, we\r\n      // clear our data and do a full reload. We purposely ignore days to\r\n      // predict here (see onDaysToPredictChange).\r\n      this.setState(\r\n        {\r\n          current: allValues.socialDistancing.includes(\"current\"),\r\n          worst_effort: allValues.socialDistancing.includes(\"worst_effort\"),\r\n          best_effort: allValues.socialDistancing.includes(\"best_effort\"),\r\n        },\r\n        () => {\r\n          this.reloadAll();\r\n        }\r\n      );\r\n    } \r\n    if (\"models\" in changedValues)\r\n    {\r\n          this.setState({\r\n            models: changedValues.models,\r\n          }, ()=>{\r\n            this.reloadAll();\r\n          });      \r\n    }\r\n    else {\r\n      // If we're here it means the user either added or deleted an area, so we\r\n      // can do a union / intersection to figure out what to add/remove.\r\n      const prevAreas = this.state.areas;\r\n      const newAreas = allValues.areas;\r\n\r\n      const areasToAdd = newAreas.filter(\r\n        areaStr => !prevAreas.includes(areaStr)\r\n      );\r\n      const areasToRemove = prevAreas.filter(\r\n        areaStr => !newAreas.includes(areaStr)\r\n      );\r\n\r\n      areasToAdd.forEach(this.addAreaByStr);\r\n      areasToRemove.forEach(this.removeAreaByStr);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * onDaysToPredictChange is bound to the 'onAfterChange' prop for the\r\n   * slider component, so this function will only be called on the mouseup\r\n   * event (to reduce database load).\r\n   */\r\n  onDaysToPredictChange(days) {\r\n    const prevAreas = this.state.areas;\r\n    this.setState({ days }, () => {\r\n      this.reloadAll();\r\n    });\r\n  }\r\n\r\n  // Set the reference to the map component as a child-component.\r\n  bindRef = ref => { \r\n    this.map = ref \r\n  }\r\n\r\n  /**\r\n   * reloadAll refreshes the prediction data for all currently-selected\r\n   * countries.\r\n   */\r\n  reloadAll() {\r\n    const prevAreas = this.state.areas;\r\n    this.setState(\r\n      {\r\n        areas: [],\r\n        mainGraphData: {}\r\n      },\r\n      () => {\r\n        // Add all the areas back.\r\n        prevAreas.forEach(this.addAreaByStr);\r\n\r\n        // TODO: Add code for stuff after reload here!\r\n        // Force reload the heatmap, only refetch data when dynamic map is on\r\n        if (this.state.dynamicMapOn && this.state.models.length !== 0) {\r\n          this.map.fetchData(this.state.dynamicMapOn);\r\n        }\r\n\r\n      }\r\n    );\r\n  }\r\n\r\n  switchDynamicMap(checked) {\r\n    this.setState({\r\n      dynamicMapOn: checked\r\n    });\r\n    this.map.fetchData(checked);\r\n  }\r\n\r\n  //when closing the alert\r\n  onAlertClose = ()=>{\r\n    this.setState({\r\n      noDataError: false\r\n    });\r\n  }\r\n\r\n  //when encounter an no data error\r\n  onNoData = (name) =>{\r\n    this.setState({\r\n      noDataError: true,\r\n      errorDescription: `There is currently no data for ${name}`\r\n    })\r\n  }\r\n\r\n  generateMarks = ()=>{\r\n    const {currentDate, days, firstDate} = this.state;\r\n    let date = new Date(`${currentDate}T00:00`);\r\n    let beginDate = new Date(`${firstDate}T00:00`);\r\n    //get the date of the selected date on slider\r\n    date.setDate(date.getDate(Date) + days);\r\n    let marks = {};\r\n    marks[days] = `${date.getMonth()+1}/${date.getDate()}`;\r\n    // marks for future\r\n    let i = days+7\r\n    while (i < days+50 && i<=99)\r\n    {\r\n       date.setDate(date.getDate() + 7);\r\n       marks[i] = `${date.getMonth()+1}/${date.getDate()}`;\r\n       i+=7;\r\n    }\r\n    // marks for history\r\n    date = new Date(`${currentDate}T00:00`);\r\n    date.setDate(date.getDate(Date) + days);\r\n    date.setDate(date.getDate() - 7);\r\n    i = days-7;\r\n    while (date >= beginDate && i > days-30){\r\n      marks[i] = `${date.getMonth()+1}/${date.getDate()}`;\r\n      date.setDate(date.getDate() - 7);\r\n      i -= 7;\r\n    }\r\n    return marks;\r\n  }\r\n\r\n  getDaysToFirstDate = ()=>{\r\n    const {currentDate, firstDate} = this.state;\r\n    let date = new Date(`${currentDate}T00:00`);\r\n    let beginningDate = new Date(`${firstDate}T00:00`);\r\n    return Math.ceil(Math.abs(date - beginningDate)/ (1000 * 60 * 60 * 24));\r\n  }\r\n\r\n  toggleControlInstructions = () => {\r\n    const showControlInstructions = this.state.showControlInstructions;\r\n    this.setState({\r\n      showControlInstructions: !showControlInstructions\r\n    });\r\n  }\r\n\r\n  toggleMapInstructions = () => {\r\n    const showMapInstructions = this.state.showMapInstructions;\r\n    this.setState({\r\n      showMapInstructions: !showMapInstructions\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      areas,\r\n      areasList,\r\n      models,\r\n      modelsList,\r\n      days,\r\n      mainGraphData,\r\n      dynamicMapOn,\r\n      dataType,\r\n      statistic,\r\n      mapShown,\r\n      yScale,\r\n      noDataError,\r\n      errorDescription\r\n    } = this.state;\r\n    const marks = this.generateMarks();\r\n    const daysToFirstDate = this.getDaysToFirstDate();\r\n    // Only show options for countries that have not been selected yet.\r\n    const countryOptions = areasList\r\n      .filter(area => !this.areaIsSelected(area))\r\n      .map(areaToStr)\r\n      .sort()\r\n      .map(s => {\r\n        return <Option key={s}> {s} </Option>;\r\n      });\r\n\r\n    const modelOptions = modelsList\r\n      .filter(model => !this.modelIsSelected(model))\r\n      .map(model => {\r\n        return (\r\n          <Option key={model.name} value={model.name}>\r\n            <Tooltip title={model.description} placement=\"right\">\r\n              {model.name}\r\n            </Tooltip>\r\n          </Option>\r\n        );\r\n      });\r\n\r\n    // Instruction messages for each form items.\r\n    const CONTROL_INSTRUCTIONS = {\r\n      area: (\r\n        <p className=\"instruction\">\r\n          Select the areas by clicking on the map or searching in this input box.\r\n        </p>\r\n      ),\r\n      \r\n      model: (\r\n        <div className=\"instruction horizontal\">\r\n          <p className=\"instruction horizontal\">\r\n            Our model produces forecasts for multiple under-reported positive cases options.\r\n            For example, \"SI-kJalpha - 20x \" denotes the assumption that \r\n            the under-reported positive cases are 20 times of the current reported cases.            \r\n            For modeling details, please see: <a href=\"https://arxiv.org/abs/2004.11372\" target=\"blank\">https://arxiv.org/abs/2004.11372</a>.\r\n          </p>\r\n        </div>\r\n      ),\r\n\r\n      date: (\r\n        <p className=\"instruction horizontal\">\r\n          Predictions up to the date selected will be shown.\r\n        </p>\r\n      ),\r\n\r\n      socialDistancing: (\r\n        <p className=\"instruction horizontal\">\r\n          Please select one of the three social distancing scenarios.  \r\n        </p>\r\n      ),\r\n\r\n      data_type: (\r\n        <p className=\"instruction horizontal\">\r\n          Select the forecasts for cumulative infections or deaths.\r\n        </p>\r\n      ),\r\n\r\n      statistics: (\r\n        <p className=\"instruction horizontal\">\r\n          Switch between cumulative view or incident view.\r\n        </p>\r\n      ),\r\n\r\n      scale: (\r\n        <p className=\"instruction horizontal\">\r\n          Switch between linear view or logarithmic view.\r\n        </p>\r\n      )\r\n    };\r\n\r\n    const MAP_INSTRUCTION = {\r\n      dynamicMap: (\r\n        <p className=\"instruction vertical\">\r\n        Enable the map to dynamically change to reflect the prediction.\r\n        Note that this functionality is not yet perfect and the reaction time \r\n        may be slow depending on your machine.\r\n        </p>\r\n      ),\r\n\r\n      radioGroup: (\r\n        <p className=\"instruction vertical\">\r\n          Switch between cumulative infection view or death view on the heatmap. \r\n        </p>\r\n      )\r\n    };\r\n\r\n    // Generate the global overview paragraph\r\n    let overview = \"\";\r\n\r\n    // In case we cannot fetch data from the external API, \r\n    // the overview will not show up.\r\n    if (this.state.totalConfirmed != 0 && this.state.totalDeaths != 0) {\r\n      const today = new Date();\r\n      const dd = String(today.getDate()).padStart(2, '0');\r\n      const mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n      const yyyy = today.getFullYear();\r\n  \r\n      //today = mm + '/' + dd + '/' + yyyy;\r\n      const totalConfirmed = this.state.totalConfirmed.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n      const totalDeaths = this.state.totalDeaths.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n      overview = \"By \" + mm + '/' + dd + '/' + yyyy + \", \" + totalConfirmed + \" people around the world have been tested positive, and \"\r\n      + totalDeaths + \" people have died of Covid-19.\";\r\n    }\r\n\r\n    let confirmed_model_map = \"\"\r\n    let death_model_map = \"\"\r\n    for (let i = models.length - 1; i>=0; i--)\r\n    {\r\n       if (models[i].substring(0,10) === \"SI-kJalpha\")\r\n       {\r\n          confirmed_model_map = models[i]\r\n          if (death_model_map.length === 0)\r\n          { \r\n            death_model_map = models[i] + \" (death prediction)\"\r\n          }\r\n          break\r\n       }\r\n       else\r\n       {\r\n          death_model_map = models[i]\r\n       }\r\n    }\r\n    return (\r\n      <div className=\"covid-19-predict\">\r\n        <Row type=\"flex\" justify=\"space-around\">\r\n          {noDataError?\r\n            <Alert\r\n            message= {`${errorDescription}`}\r\n            description= \"Please wait for our updates.\"\r\n            type=\"error\"\r\n            closable\r\n            onClose={this.onAlertClose}\r\n          />: null\r\n          }\r\n          <Col span={10}>\r\n            <Row>\r\n              <div className=\"form-wrapper\">\r\n                <Form\r\n                  ref={this.formRef}\r\n                  onValuesChange={this.onValuesChange}\r\n                  initialValues={{\r\n                    areas: areas,\r\n                    models: models,\r\n                    days: 14,\r\n                    socialDistancing: [\"current\"]\r\n                  }}\r\n                >\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.area}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item\r\n                      label=\"Areas\"\r\n                      name=\"areas\"\r\n                      rules={[{ required: true, message: \"Please select areas!\" }]}\r\n                    >\r\n                      <Select\r\n                        mode=\"multiple\"\r\n                        style={{ width: \"100%\" }}\r\n                        placeholder=\"Select Areas\"\r\n                      >\r\n                        {countryOptions}\r\n                      </Select>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.model}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item\r\n                      label=\"Models:\"\r\n                      name=\"models\"\r\n                      rules={[\r\n                        { required: true, message: \"Please select a prediction model!\" }\r\n                      ]}\r\n                    >\r\n                      <Select\r\n                        mode=\"multiple\"\r\n                        style={{ width: \"100%\" }}\r\n                        placeholder=\"Select Prediction Models\"\r\n                      >\r\n                        {modelOptions}\r\n                      </Select>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.date}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item\r\n                      label=\"Date to Predict\"\r\n                      name=\"days\"\r\n                      rules={[\r\n                        { required: true, message: \"Please select number of days!\" }\r\n                      ]}\r\n                    >\r\n                      <Slider\r\n                        marks={marks}\r\n                        min={days-30>=-daysToFirstDate?days-30:-daysToFirstDate}\r\n                        initialValue={days}\r\n                        max={days+50<=99?days+50:99}\r\n                        onAfterChange={this.onDaysToPredictChange}\r\n                        step = {null}\r\n                      />\r\n                    </Form.Item>\r\n                  </Popover>\r\n                  <Popover \r\n                    content={CONTROL_INSTRUCTIONS.socialDistancing} \r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item label=\"Social Distancing\" name=\"socialDistancing\">\r\n                      <Checkbox.Group style={{ width: '100%' }}>\r\n                        <Row>\r\n                          <Checkbox defaultChecked value=\"current\">\r\n                            Current Trend\r\n                          </Checkbox>\r\n                          <Checkbox value=\"worst_effort\"> \r\n                            Worst Distancing Effort\r\n                          </Checkbox>\r\n                          <Checkbox value=\"best_effort\"> \r\n                            Best Distancing Effort\r\n                          </Checkbox>\r\n                        </Row>\r\n                      </Checkbox.Group>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                </Form>\r\n                <Form>\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.data_type}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item>\r\n                      Data Type:&nbsp;&nbsp;  \r\n                      <Checkbox.Group\r\n                        defaultValue={['confirmed']}\r\n                        onChange={this.handleDataTypeSelect}\r\n                      >\r\n                        <Checkbox defaultChecked value=\"confirmed\">Confirmed Cases</Checkbox>\r\n                        <Checkbox value=\"death\">Deaths</Checkbox>\r\n                      </Checkbox.Group>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.statistics}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item>\r\n                      Statistic:&nbsp;&nbsp;  \r\n                      <Radio.Group\r\n                        value={statistic}\r\n                        onChange={this.handleStatisticSelect}\r\n                      >\r\n                        <Radio value=\"cumulative\">Cumulative Cases</Radio>\r\n                        <Radio value=\"delta\">New Cases</Radio>\r\n                      </Radio.Group>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                  <Popover\r\n                    content={CONTROL_INSTRUCTIONS.scale}\r\n                    placement=\"right\"\r\n                    visible={this.state.showControlInstructions}>\r\n                    <Form.Item>\r\n                      Scale:&nbsp;&nbsp;  \r\n                      <Radio.Group value={yScale} onChange={this.handleYScaleSelect}>\r\n                        <Radio value=\"linear\">linear</Radio>\r\n                        <Radio value=\"log\">logarithmic</Radio>\r\n                      </Radio.Group>\r\n                    </Form.Item>\r\n                  </Popover>\r\n                </Form>\r\n              </div>\r\n            </Row>\r\n            {areas.length?\r\n            <Row>\r\n              <div className=\"graph-wrapper\">\r\n                <Covid19Graph\r\n                  data={mainGraphData}\r\n                  dataType={dataType}\r\n                  onNoData = {this.onNoData}\r\n                  statistic={statistic}\r\n                  yScale={yScale}\r\n                ></Covid19Graph>\r\n              </div>\r\n            </Row>\r\n            : null}\r\n          </Col>\r\n          <Col span={12}>\r\n            <Row>\r\n              <p className=\"overview\">{overview}</p>\r\n            </Row>\r\n            <Row>\r\n              <span className=\"map-control\">\r\n                <Popover\r\n                  content={MAP_INSTRUCTION.dynamicMap}\r\n                  placement=\"bottom\"\r\n                  visible={this.state.showMapInstructions}>\r\n                  Dynamic Map:&nbsp;&nbsp;  \r\n                  <Switch onChange={this.switchDynamicMap} />\r\n                </Popover>\r\n              </span>\r\n              <span className=\"map-control\">\r\n                <Popover\r\n                  content={MAP_INSTRUCTION.radioGroup}\r\n                  placement=\"bottom\"\r\n                  visible={this.state.showMapInstructions}>\r\n                    <Radio.Group\r\n                      value={mapShown}\r\n                      onChange={this.handleMapShownSelect}>\r\n                      <Radio value=\"confirmed\">Show Confirmed Cases</Radio>\r\n                      <Radio value=\"death\">Show Deaths</Radio>\r\n                    </Radio.Group>\r\n                  </Popover>\r\n              </span>\r\n            </Row>\r\n            <Row>\r\n              <div className=\"map-wrapper\">\r\n                <Covid19Map className=\"map\"\r\n                  triggerRef={this.bindRef}\r\n                  dynamicMapOn={dynamicMapOn}\r\n                  days={days}\r\n                  confirmed_model = {confirmed_model_map}\r\n                  death_model = {death_model_map}\r\n                  onMapClick={this.onMapClick} \r\n                  onNoData = {this.onNoData}\r\n                  statistic={statistic}\r\n                  dataType = {mapShown}\r\n                />\r\n              </div>\r\n            </Row>\r\n            <Row>\r\n              <div className=\"instruction-buttons-wrapper\">\r\n                <Button className=\"instruction-button\"\r\n                    onClick={this.toggleControlInstructions}>\r\n                    {(this.state.showControlInstructions == false)? \"Help with controls\" : \"Close control instructions\"}\r\n                </Button>\r\n                <Button className=\"instruction-button\"\r\n                    onClick={this.toggleMapInstructions}>\r\n                    {(this.state.showMapInstructions == false)? \"Help with the map\" : \"Close map instructions\"}\r\n                </Button>\r\n              </div>\r\n            </Row>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19Predict;\r\n","import React, { Component } from \"react\";\r\nimport \"./aboutus.css\";\r\nimport \"./covid19app.css\";\r\n\r\nclass AboutUs extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"page-wrapper\">\r\n                <div className=\"article\">\r\n                    <h1 className=\"article-title\">ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response</h1>\r\n                    <p className=\"article-paragraph\">\r\n                        Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. \r\n                        This is an NSF-funded project on COVID-19 forecasting led by\r\n                        by <a className=\"article-anchor\" href=\"https://sites.usc.edu/prasanna/\"> Viktor K. Prasanna </a> and <a className=\"article-anchor\" href=\"http://www-scf.usc.edu/~ajiteshs/\"> Ajitesh Srivastava </a> \r\n                        from the <a className=\"article-anchor\" href=\"https://dslab.usc.edu/\"> Data Science Lab </a> at the University of Southern California. \r\n                    </p>\r\n                    <h2>Our Approach</h2>\r\n                    <p className=\"article-paragraph\">\r\n                        We use our own epidemic model called <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\"> SI-kJalpha</a>, preliminary version of which we have successfully used \r\n                        during <a className=\"article-anchor\" href=\"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/\" target=\"_blank\">\r\n                            DARPA Grand Challenge 2014\r\n                        </a>.   \r\n                        Our forecast appears on the official <a className=\"article-anchor\" href=\"https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html\"> CDC webpage</a>.\r\n\t\t\t Our model can consider the effect of many complexities of the epidemic process and yet be simplified to a few parameters that are learned using fast linear regressions. Therefore, our approach can learn and generate forecasts extremely quickly. On a 2 core desktop machine, our approach takes only 3.18s to tune hyper-parameters, learn parameters and generate 100 days of forecasts of reported cases and deaths for all the states in the US. The total execution time for 184 countries is 11.83s and for more than 3000 US counties is 101.03s. Despite being fast, the accuracy of our forecasts is on par with the state-of-the-art as demonstrated on the <a className=\"article-anchor\" href=\"https://scc-usc.github.io/ReCOVER-COVID-19/#/leaderboard\"> leaderboard page</a>. Details of modeling and comparisons can be found in <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\"> our paper</a>.\r\n                        This work is supported by National Science Foundation Award No. 2027007 (RAPID)\r\n                    </p>\r\n\r\n                    <p className=\"article-paragraph\">\r\n                        The <a className=\"article-anchor\" href=\"https://github.com/scc-usc/ReCOVER-COVID-19\" target=\"_blank\"> Github repository </a> for this project is publicly available.\r\n                    </p>\r\n                    <p className=\"article-paragraph\">\r\n                        The matlab code for forecasting is also made available on <a className=\"article-anchor\" href=\"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover\" target=\"_blank\">File Exchange</a>. For the latest code, please see the Github repo.\r\n                    </p>\r\n\r\n\t\t\t<p className=\"article-paragraph\"> The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu,  and Bob Xiaochen Yang. </p>\r\n                    \r\n                    <h2>Related Papers</h2>\r\n\r\n                    <ol className=\"article-paragraph\">\r\n\t\t\t<li>\r\n                            Ajitesh Srivastava, Tianjian Xu and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\" target=\"_blank\"> \"Fast and Accurate Forecasting of COVID-19 Deaths using the SIkJalpha Model\"</a> [arXiv].\r\n                        </li>\r\n                        <li>\r\n                            Ajitesh Srivastava and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2006.02127\" target=\"_blank\"> \"Data-driven Identification of Number of Unreported Cases for COVID-19: Bounds and Limitations\"</a> [arXiv]. Accepted at KDD 2020.\r\n                        </li>\r\n                        <li>\r\n                            Ajitesh Srivastava and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2004.11372\" target=\"_blank\"> \"Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic\"</a> [arXiv]. \r\n                        </li>\r\n\r\n                    </ol>\r\n\t\t\t<h2>Other Links</h2>\r\n                    <ol className=\"article-paragraph\">\r\n                        <li>\r\n                        <a className=\"article-anchor\" href=\"https://www.youtube.com/watch?v=ll6k8wlxOFo\" target=\"_blank\">Webinar </a> describing our intial approach.\r\n                    </li></ol>\r\n\r\n\t\t\t\r\n                    <h2>USC Data Science Lab</h2>\r\n                    <p className=\"article-paragraph\">\r\n                        The USC Data Science Lab focuses on applying machine learning, data mining, \r\n                        and network analysis to real-world problems in society and industry. \r\n                        Please find more information and other research projects <a className=\"article-anchor\" href=\"https://sites.usc.edu/dslab/\" target=\"_blank\"> on \r\n                        our website</a>.\r\n                    </p>\r\n\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default AboutUs;","import React, { Component } from \"react\";\r\nimport { ResponsiveLine} from \"@nivo/line\";\r\nimport moment from \"moment\";\r\nimport numeral from \"numeral\";\r\nimport {\r\n  red,\r\n  gold,\r\n  lime,\r\n  cyan,\r\n  geekblue,\r\n  purple,\r\n  magenta\r\n} from \"@ant-design/colors\";\r\n\r\nfunction getLineColor(index) {\r\n  const colors = [\r\n    red,\r\n    gold,\r\n    lime,\r\n    cyan,\r\n    geekblue,\r\n    purple,\r\n    magenta\r\n  ];\r\n\r\n  return colors[index % colors.length];\r\n}\r\n\r\nconst DashedLine = ({ series, lineGenerator, xScale, yScale }) => {\r\n  return series.map(({ id, data, color, predicted, distancing }) => {\r\n    let style = {\r\n      strokeWidth: 5\r\n    };\r\n\r\n    // Add custom style if predicted.\r\n    if (predicted) {\r\n      if (distancing) {\r\n        style.strokeDasharray = \"6, 4\";\r\n      } else {\r\n        // Display a sparser pattern for no social distancing.\r\n        style.strokeDasharray = \"2, 6\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <path\r\n        key={id}\r\n        d={lineGenerator(\r\n          data.map(d => ({\r\n            x: xScale(d.data.x),\r\n            y: yScale(d.data.y)\r\n          }))\r\n        )}\r\n        fill=\"none\"\r\n        stroke={color}\r\n        style={style}\r\n      />\r\n    );\r\n  });\r\n};\r\n\r\nconst theme = {\r\n  axis: {\r\n    ticks: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    },\r\n    legend: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    }\r\n  },\r\n  legends: {\r\n    text: {\r\n      fontSize: 18\r\n    }\r\n  }\r\n};\r\n\r\nclass ScoreGraph extends Component {\r\n  parseDate(dateStr) {\r\n    let [year, month, day] = dateStr.split(\"-\").map(Number);\r\n    // Month in JS is 0-based.\r\n    month -= 1;\r\n    return new Date(year, month, day);\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getCumulativeData\r\n   * returns it in Nivo format.\r\n   */\r\n  getCumulativeData(data) {\r\n    return data.map(d => ({\r\n      x: this.parseDate(d.date),\r\n      y: d.value\r\n    }));\r\n  }\r\n\r\n  // processData properly formats the given data, and performs special\r\n  // operations based on parameter values.\r\n  processData(data) {\r\n    console.log(data);\r\n    let retData = this.getCumulativeData(data);\r\n\r\n    return retData;\r\n  }\r\n\r\n  /**\r\n   * getDataMax returns the maximum value present in the data supplied to the\r\n   * graph.\r\n   */\r\n  getDataMax() {\r\n    const { data } = this.props;\r\n\r\n    let max = 0;\r\n\r\n    Object.keys(data).forEach(area => {\r\n      const { observed } = data[area];\r\n      max = Math.max(max, Math.max(...observed.map(({ value }) => value)));\r\n    });\r\n\r\n    return max;\r\n  }\r\n\r\n  /**\r\n   * getYAxisProps returns the corresponding Nivo line props for supporting\r\n   * different Y axis types (linear and log).\r\n   */\r\n  getYAxisProps() {\r\n    const linearAxisLeft = {\r\n      // Format large y numbers as their abbreviations.\r\n      format: y => numeral(y).format(\"0.[0]a\"),\r\n      orient: \"left\",\r\n      tickSize: 5,\r\n      tickPadding: 5,\r\n      tickRotation: 0,\r\n      legend: \"Dynamic Reproduction Number\",\r\n      legendOffset: -60,\r\n      legendPosition: \"middle\"\r\n    };\r\n\r\n    let logTickValues = [];\r\n    for (let i = 0; i <= Math.ceil(Math.log10(this.getDataMax())); i++) {\r\n      logTickValues.push(Math.pow(10, i));\r\n    }\r\n\r\n    // The 'axisLeft' prop for log scale is the same as for linear axis, except\r\n    // that the tick values must be supplied.\r\n    const logAxisLeft = {\r\n      ...linearAxisLeft,\r\n      tickValues: logTickValues\r\n    };\r\n\r\n    return {\r\n      axisLeft: linearAxisLeft,\r\n      yScale: {\r\n        type: \"linear\",\r\n        min: \"auto\",\r\n        max: \"auto\"\r\n      }\r\n    };\r\n  }\r\n\r\n  render() {\r\n    let { data } = this.props;\r\n    // chartData contains the data that we will pass into Nivo line chart.\r\n    let chartData = [];\r\n    // colors holds hex values for each line in the chart.\r\n    let colors = [];\r\n    // Sort the data by area name (so we have a consistent coloring) and then\r\n    // loop over each area.\r\n    Object.keys(data)\r\n      .sort()\r\n      .forEach((area, idx) => {\r\n        const lineColor = getLineColor(idx);\r\n        const observedData = data[area].observed;\r\n        const upperBound = observedData.map(data=>{\r\n           return {\r\n             date: data.date,\r\n             value: data.value + data.conf\r\n           }\r\n        });\r\n        const lowerBound = observedData.map(data=>{\r\n          return {\r\n            date: data.date,\r\n            value: data.value - data.conf\r\n          }\r\n       });\r\n        // Add the mean\r\n        chartData.push({\r\n          id: area,\r\n          data: this.processData(observedData),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n\r\n        colors.push(lineColor[3]);\r\n\r\n        //add the upperbound\r\n        chartData.push({\r\n          id: `${area} upper bound`,\r\n          data: this.processData(upperBound),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n        colors.push(lineColor[3]);\r\n\r\n        //add the lowerbound\r\n        chartData.push({\r\n          id: `${area} lower bound`,\r\n          data: this.processData(lowerBound),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n        colors.push(lineColor[3]);\r\n      });\r\n\r\n    // Determine whether we need to show weeks or months on the X axis.\r\n    let tickValues = \"every week\";\r\n\r\n    if (chartData.length > 0) {\r\n      // Calculate the minimum and maximum dates present in the data.\r\n      let minDate = chartData[0].data[0].x;\r\n      let maxDate = chartData[0].data[0].x;\r\n\r\n      chartData.forEach(({ data }) => {\r\n        data.forEach(({ x }) => {\r\n          minDate = Math.min(minDate, x);\r\n          maxDate = Math.max(maxDate, x);\r\n        });\r\n      });\r\n\r\n      minDate = moment(minDate);\r\n      maxDate = moment(maxDate);\r\n\r\n      // Switch to 'every month' if the date range is over a certain threshold.\r\n      const diffInDays = maxDate.diff(minDate, \"days\");\r\n      if (diffInDays > 150) {\r\n        tickValues = \"every month\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <ResponsiveLine\r\n        data={chartData}\r\n        colors={colors}\r\n        //50,50,50,80\r\n        margin={{ top: 10, right: 50, bottom: 70, left: 100 }}\r\n        xScale={{\r\n          type: \"time\",\r\n          format: \"native\",\r\n          precision: \"day\"\r\n        }}\r\n        axisBottom={{\r\n          // tickValues determines how often / with what values our 'format'\r\n          // func is called.\r\n          tickValues: tickValues,\r\n          // A custom 'format' func is required since all the x values are\r\n          // javascript Date objects.\r\n          format: date => {\r\n            return moment(date).format(\"M/D\");\r\n          },\r\n          orient: \"bottom\",\r\n          tickSize: 5,\r\n          tickPadding: 5,\r\n          tickRotation: 0,\r\n          legend: \"Date\",\r\n          legendOffset: 36,\r\n          legendPosition: \"middle\"\r\n        }}\r\n        // Set up the Y axis.\r\n        {...this.getYAxisProps()}\r\n        enableSlices=\"x\"\r\n        sliceTooltip={({ slice }) => {\r\n          return (\r\n            <div\r\n              style={{\r\n                background: \"white\",\r\n                padding: \"9px 12px\",\r\n                border: \"1px solid #ccc\"\r\n              }}\r\n            >\r\n              <div>\r\n                {// Grab the date from the first point, this will be the title of\r\n                // the tooltip.\r\n                moment(slice.points[0].data.x).format(\"MMM Do YYYY\")}\r\n              </div>\r\n              {slice.points.map(point => (\r\n                <div\r\n                  key={point.id}\r\n                  style={{\r\n                    color: point.serieColor,\r\n                    padding: \"3px 0\"\r\n                  }}\r\n                >\r\n                  <strong>{point.serieId}</strong>[\r\n                  {numeral(point.data.yFormatted).format(\"0.[0]a\")}]\r\n                </div>\r\n              ))}\r\n            </div>\r\n          );\r\n        }}\r\n        legends={[\r\n          {\r\n            anchor: \"top-left\",\r\n            direction: \"column\",\r\n            justify: false,\r\n            translateX: 0,\r\n            translateY: 0,\r\n            itemsSpacing: 0,\r\n            itemDirection: \"left-to-right\",\r\n            itemWidth: 80,\r\n            itemHeight: 20,\r\n            itemOpacity: 0.75,\r\n            symbolSize: 12,\r\n            symbolShape: \"circle\",\r\n            symbolBorderColor: \"rgba(0, 0, 0, .5)\",\r\n            effects: [\r\n              {\r\n                on: \"hover\",\r\n                style: {\r\n                  itemBackground: \"rgba(0, 0, 0, .03)\",\r\n                  itemOpacity: 1\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]}\r\n        layers={[\r\n          \"grid\",\r\n          \"markers\",\r\n          \"areas\",\r\n          \"crosshair\",\r\n          DashedLine,\r\n          \"slices\",\r\n          \"points\",\r\n          \"axes\",\r\n          \"legends\"\r\n        ]}\r\n        theme={theme}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScoreGraph;\r\n","import React, { Component } from \"react\";\r\nimport {\r\n    red,\r\n    gold,\r\n    lime,\r\n    cyan,\r\n    geekblue,\r\n    purple,\r\n    magenta\r\n  } from \"@ant-design/colors\";\r\n\r\nimport { \r\n    LineChart, \r\n    Line,\r\n    CartesianGrid,\r\n    XAxis,\r\n    YAxis,\r\n    Tooltip,\r\n    Legend,\r\n    Label,\r\n    ErrorBar,\r\n    ReferenceLine\r\n} from 'recharts';\r\n\r\nfunction getLineColor(index) {\r\n    const colors = [\r\n        red,\r\n        gold,\r\n        lime,\r\n        cyan,\r\n        geekblue,\r\n        purple,\r\n        magenta\r\n    ];\r\n\r\n    return colors[index % colors.length];\r\n}\r\n\r\n\r\n\r\nclass NewScoreGraph extends Component {\r\n    parseData = (data, scoreType) => { \r\n        const firstArea = Object.keys(data)[0];\r\n        if (data[firstArea])\r\n        {\r\n            if (scoreType === \"reproduction\")\r\n            {\r\n                const chartData = data[firstArea].observed_rt.map((value,idx) => {\r\n                    let date = value.date.split(\"-\")[1] + \"/\" + value.date.split(\"-\")[2]\r\n                    let dataSet = {name: date};\r\n                    dataSet[Object.keys(data)[0]] = value.value;\r\n                    dataSet[`error${Object.keys(data)[0]}`] = value.conf;\r\n                    for (let i = 1; i < Object.keys(data).length; ++i)\r\n                    {\r\n                        dataSet[Object.keys(data)[i]] = data[Object.keys(data)[i]].observed_rt[idx].value;\r\n                        dataSet[`error${Object.keys(data)[i]}`] = data[Object.keys(data)[i]].observed_rt[idx].conf;\r\n                    }\r\n                    return dataSet\r\n                });\r\n                return chartData;\r\n            }\r\n            else\r\n            {\r\n                const chartData = data[firstArea].observed_mrf.map((value,idx) => {\r\n                    let date = value.date.split(\"-\")[1] + \"/\" + value.date.split(\"-\")[2]\r\n                    let dataSet = {name: date};\r\n                    dataSet[Object.keys(data)[0]] = value.value;\r\n                    dataSet[`error${Object.keys(data)[0]}`] = value.conf;\r\n                    for (let i = 1; i < Object.keys(data).length; ++i)\r\n                    {\r\n                        dataSet[Object.keys(data)[i]] = data[Object.keys(data)[i]].observed_mrf[idx].value;\r\n                        dataSet[`error${Object.keys(data)[i]}`] = data[Object.keys(data)[i]].observed_mrf[idx].conf;\r\n                    }\r\n                    return dataSet\r\n                });\r\n                return chartData;\r\n            }\r\n        }\r\n    }\r\n    \r\n    render(){\r\n        let {data, date, scoreType} = this.props;\r\n        //map data\r\n        const chartData = this.parseData(data, scoreType);\r\n        //areas and line color\r\n        const areas = Object.keys(data);\r\n        let colors = [];\r\n        areas.map((area, idx)=>{\r\n            let strokeColor = getLineColor(idx);\r\n            colors.push(strokeColor);\r\n            return 0;\r\n        });\r\n        let lines = [];\r\n        for (let i = 0; i < areas.length; ++i)\r\n        {\r\n            lines.push(\r\n                <Line type=\"monotone\" key={i} dataKey={areas[i]} stroke={colors[i][3]} strokeWidth={5}>\r\n                    <ErrorBar dataKey={`error${areas[i]}`} width={15} strokeWidth={2} stroke={colors[i][6]} direction=\"y\" />\r\n                </Line>\r\n            )\r\n        }\r\n        return(\r\n            <LineChart width={1400} height={300} data={chartData}\r\n            margin={{ top: 40, right: 30, left: 40, bottom: 5 }}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            <XAxis dataKey=\"name\" />\r\n            <YAxis>\r\n                {scoreType===\"reproduction\"?\r\n                <Label value=\"Dynamic Reproduction Number\" dy = {90} position=\"insideLeft\" angle={-90} fontSize={15} />\r\n                 :\r\n                <Label value=\"MFR Score\" dy = {45} position=\"insideLeft\" angle={-90} fontSize={15} />\r\n                }\r\n            </YAxis>\r\n            <Tooltip />\r\n            <ReferenceLine x={date} stroke=\"green\" strokeWidth={5} fontSize={20} \r\n                            label={{position: 'top', value: 'selected date', fill: 'green', fontSize: 15}} \r\n            strokeDasharray=\"10 10\"/>\r\n            {scoreType === \"reproduction\"? \r\n            <ReferenceLine y={1} stroke=\"SandyBrown\" strokeWidth={5} strokeDasharray=\"3 3\" \r\n                            label={{position: 'left', value: '', fill: 'red', fontSize: 20}} \r\n            />\r\n            :null}\r\n            <Legend iconSize={40}/>\r\n            {lines}\r\n            </LineChart>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NewScoreGraph;\r\n\r\n  ","import React, { Component } from \"react\";\r\nimport { Circle, Map, Marker, Popup, TileLayer } from \"react-leaflet\";\r\nimport ModelAPI from \"../modelapi\";\r\nimport { areaToStr, strToArea } from \"../covid19util\";\r\n\r\nimport * as am4core from \"@amcharts/amcharts4/core\";\r\nimport * as am4maps from \"@amcharts/amcharts4/maps\";\r\nimport am4geodata_worldLow from \"@amcharts/amcharts4-geodata/worldLow\";\r\nimport am4geodata_usaLow from \"@amcharts/amcharts4-geodata/usaLow\";\r\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\r\n\r\nconst HEAT_MAP_MIN_COLOR = \"#85DB50\";\r\nconst HEAT_MAP_MAX_COLOR = \"#F33A21\";\r\nconst MAP_HOVER_COLOR = \"#83FE00\";\r\n\r\nam4core.useTheme(am4themes_animated);\r\n\r\nclass ScoreMap extends Component {\r\n    constructor() {\r\n      super();\r\n      this.modelAPI = new ModelAPI();\r\n  \r\n      this.state = {\r\n        areasList : [],\r\n        showState: false,\r\n        worldSeries: {},\r\n        usaSeries: {}\r\n      }\r\n  \r\n      this.modelAPI.areas(allAreas =>\r\n        this.setState({\r\n          areasList: allAreas\r\n        })\r\n      );\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.triggerRef(this);\r\n    }\r\n\r\n    onShowState = (value) =>{\r\n        this.setState({\r\n          showState: value\r\n        });\r\n    }\r\n\r\n    fetchData()\r\n    {\r\n        var args = arguments;\r\n        const {scoreType} = this.props;\r\n        if (!args[0]) {\r\n          //without dynamic map,show to latestscore\r\n          if (scoreType === \"reproduction\")\r\n          {\r\n            this.modelAPI.scores_all(\r\n              {\r\n                  weeks: this.props.latestWeek,\r\n              } , scores => {\r\n                let heatmapData = scores.map(d => {\r\n                return {\r\n                  id: d.area.iso_2,\r\n                  value: d.value > 0 ? d.value: 0,\r\n                  area: d.area,\r\n                  conf: d.conf\r\n                };\r\n              });\r\n              this.setState({ heatmapData }, this.initChart);\r\n            });\r\n          }\r\n          else\r\n          {\r\n            this.modelAPI.all_mrf_scores(\r\n              {\r\n                  weeks: this.props.latestWeek,\r\n              } , scores => {\r\n                let heatmapData = scores.map(d => {\r\n                return {\r\n                  id: d.area.iso_2,\r\n                  value: d.value > 0 ? d.value: 0,\r\n                  area: d.area,\r\n                  conf: d.conf\r\n                };\r\n              });\r\n              this.setState({ heatmapData }, this.initChart);\r\n            });\r\n          }  \r\n        } else {\r\n          if (scoreType === \"reproduction\")\r\n          {\r\n            this.modelAPI.scores_all(\r\n              {\r\n                  weeks: this.props.weeks,\r\n              }, scores =>{\r\n              let heatmapData = scores.map(d => {\r\n                  return {\r\n                      id: d.area.iso_2,\r\n                      value: d.value > 0 ? d.value: 0,\r\n                      area: d.area\r\n                  };\r\n                  });\r\n                  if (args[1])\r\n                  {\r\n                    this.setState({ heatmapData }, this.initChart);\r\n                  }\r\n                  else\r\n                  {\r\n                    this.setState({ heatmapData }, this.updateChart);\r\n                  }              \r\n              });\r\n          }\r\n          else\r\n          {\r\n            this.modelAPI.all_mrf_scores(\r\n              {\r\n                  weeks: this.props.weeks,\r\n              }, scores =>{\r\n              let heatmapData = scores.map(d => {\r\n                  return {\r\n                      id: d.area.iso_2,\r\n                      value: d.value > 0 ? d.value: 0,\r\n                      area: d.area\r\n                  };\r\n                  });\r\n                  if (args[1])\r\n                  {\r\n                    this.setState({ heatmapData }, this.initChart);\r\n                  }\r\n                  else\r\n                  {\r\n                    this.setState({ heatmapData }, this.updateChart);\r\n                  }\r\n              });\r\n          }\r\n           \r\n        }\r\n    }\r\n\r\n    initChart() {\r\n        // Create map instance\r\n        this.chart = am4core.create(\"chartdiv\", am4maps.MapChart);\r\n        // Set projection\r\n        this.chart.projection = new am4maps.projections.Mercator();\r\n        let worldSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n        worldSeries = this.createChartSeries(worldSeries, {\r\n          geodata: am4geodata_worldLow,\r\n          exclude: [\"AQ\"],\r\n          data: this.state.heatmapData\r\n        });\r\n        let usaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n        usaSeries = this.createChartSeries(usaSeries, {\r\n          geodata: am4geodata_usaLow,\r\n          data: this.state.heatmapData,\r\n          disabled: !this.state.showState\r\n        });\r\n        this.stateSeries = [usaSeries];\r\n        this.initChartInterface();\r\n        this.setState({\r\n          worldSeries,\r\n          usaSeries\r\n        });\r\n    }\r\n\r\n    updateChart(){\r\n      let worldSeries = this.state.worldSeries;\r\n      let usaSeries = this.state.usaSeries;\r\n      worldSeries.data = this.state.heatmapData;\r\n      usaSeries.data = this.state.heatmapData;\r\n    }\r\n\r\n    createChartSeries(series, seriesProps) {\r\n        const {scoreType} = this.props;\r\n        series = Object.assign(series, seriesProps);\r\n        let polygonTemplate = series.mapPolygons.template;\r\n        if (scoreType === \"reproduction\")\r\n        {\r\n          series.heatRules.push({\r\n            property: \"fill\",\r\n            target: polygonTemplate,\r\n            min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n            max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n            minValue: 0,\r\n            maxValue: 4\r\n          });\r\n        }\r\n        else\r\n        {\r\n          series.heatRules.push({\r\n            property: \"fill\",\r\n            target: polygonTemplate,\r\n            min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n            max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n            minValue: 0,\r\n            maxValue: 0.4\r\n          });\r\n        }  \r\n        // Configure series tooltip. Display the true value of infections.\r\n        polygonTemplate.tooltipText = \"{name}: {value}\";\r\n        polygonTemplate.nonScalingStroke = true;\r\n        polygonTemplate.strokeWidth = 0.5;\r\n    \r\n        // Create hover state and set alternative fill color.\r\n        let hs = polygonTemplate.states.create(\"hover\");\r\n        hs.properties.fill = am4core.color(MAP_HOVER_COLOR);\r\n    \r\n        // Change mouse cursor to pointer.\r\n        polygonTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n    \r\n        // Create click handler. Apparently ALL the series in the chart must have\r\n        // click handlers activated, so if this function is not running double-check\r\n        // that other series also have click handlers.\r\n        const { onMapClick, onNoData} = this.props;\r\n        polygonTemplate.events.on(\"hit\", e => {\r\n          const { id, value, area, name} = e.target.dataItem.dataContext;\r\n          if (area){\r\n            onMapClick(area);\r\n          }\r\n          else\r\n          {\r\n            onNoData(name);\r\n          }\r\n        });\r\n        return series;\r\n    }\r\n\r\n    initChartInterface() {\r\n        // Create a zoom control.\r\n        const {showState} = this.state;\r\n        this.chart.zoomControl = new am4maps.ZoomControl();\r\n        this.chart.zoomControl.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n    \r\n        // Create a toggle button to show/hide states/provinces.\r\n        let button = this.chart.chartContainer.createChild(am4core.Button);\r\n        //button.label.text = \"Show States/Provinces\";\r\n        button.label.text = `${\r\n          showState ? \"Hide\" : \"Show\"\r\n          } States/Provinces`;\r\n        button.togglable = true;\r\n        button.padding(5, 5, 5, 5);\r\n        button.align = \"right\";\r\n        button.marginRight = 15;\r\n        button.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n        button.events.on(\"hit\", () => {\r\n          this.onShowState(button.isActive);\r\n          const {showState} = this.state;\r\n          this.stateSeries.forEach(s => (s.disabled = !showState));\r\n          button.label.text = `${\r\n            showState ? \"Hide\" : \"Show\"\r\n            } States/Provinces`;\r\n        });\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        if (this.chart) {\r\n          this.chart.dispose();\r\n        }\r\n      }\r\n\r\n    render() {\r\n        return <div id=\"chartdiv\"></div>;\r\n    }\r\n}\r\n\r\nexport default ScoreMap;","import React, { PureComponent } from \"react\";\r\nimport ModelAPI from \"../modelapi\";\r\nimport { areaToStr, strToArea} from \"../covid19util\";\r\nimport ScoreGraph from \"./scoreGraph\";\r\nimport NewScoreGraph from \"./newScoreGraph\";\r\nimport ScoreMap from './scoreMap';\r\nimport \"./scorePage.css\";\r\n\r\nimport {\r\n    Form,\r\n    Select,\r\n    Slider,\r\n    Switch,\r\n    Alert,\r\n    Row,\r\n    Col,\r\n    Radio\r\n  } from \"antd\";\r\n\r\nconst { Option } = Select;\r\n\r\nclass ScorePage extends PureComponent{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            areas: this.props.areas || [],\r\n            areasList: [],\r\n            latestDate: \"\",\r\n            firstDate: \"\",\r\n            mainGraphData: {},\r\n            weeks: this.props.weeks || 0, // will later be set to be the weeks to the latest date as initial value\r\n            latestWeek: 0, //will change later and remain unchange until database updated\r\n            dynamicMapOn: false,\r\n            noDataError: false,\r\n            errorDescription: \"\",\r\n            scoreType: \"reproduction\"\r\n        }  \r\n        \r\n        this.addAreaByStr = this.addAreaByStr.bind(this);\r\n        this.removeAreaByStr = this.removeAreaByStr.bind(this);\r\n        this.onValuesChange = this.onValuesChange.bind(this);\r\n        this.onMapClick = this.onMapClick.bind(this);\r\n        this.onWeeksChange = this.onWeeksChange.bind(this);\r\n        this.switchDynamicMap = this.switchDynamicMap.bind(this);\r\n        this.onAlertClose = this.onAlertClose.bind(this);\r\n        this.onNoData = this.onNoData.bind(this);\r\n        this.generateMarks = this.generateMarks.bind(this);\r\n        this.handleScoreTypeSelect = this.handleScoreTypeSelect.bind(this);\r\n    }\r\n\r\n    componentDidMount = ()=>{\r\n        this.formRef = React.createRef();\r\n    \r\n        this.modelAPI = new ModelAPI();\r\n\r\n        this.modelAPI.latest_score_date(latestDate => \r\n            this.setState({\r\n                latestDate: latestDate[0].date,\r\n                weeks: latestDate[0].weeks,\r\n                latestWeek: latestDate[0].weeks,\r\n                firstDate: latestDate[0].firstDate\r\n            }, ()=>{\r\n                this.addAreaByStr('US');\r\n                this.formRef.current.setFieldsValue({\r\n                    weeks: this.state.latestWeek,\r\n                });\r\n                this.map.fetchData(this.state.dynamicMapOn);\r\n            })\r\n        );\r\n    \r\n        this.modelAPI.areas(allAreas =>\r\n          this.setState({\r\n            areasList: allAreas\r\n          })\r\n        );\r\n    }\r\n\r\n    onMapClick(area) {\r\n        if (!this.areaIsSelected(area)) {\r\n            this.addAreaByStr(areaToStr(area));\r\n        }\r\n    }\r\n\r\n    areaIsSelected(area) {\r\n        if (this.state.areas && area) {\r\n          const newAreaStr = areaToStr(area);\r\n          return this.state.areas.includes(newAreaStr);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    addAreaByStr(areaStr) {\r\n        const areaObj = strToArea(areaStr);\r\n    \r\n        this.setState(\r\n          prevState => ({\r\n            areas: [...prevState.areas, areaStr]\r\n          }),\r\n          () => {\r\n            this.modelAPI.scores(\r\n            {\r\n                state: areaObj.state,\r\n                country: areaObj.country,\r\n                weeks: this.state.latestWeek,\r\n            },\r\n            data => {\r\n                this.setState(prevState => ({\r\n                mainGraphData: {\r\n                    ...prevState.mainGraphData,\r\n                    [areaStr]: data\r\n                }\r\n                }));\r\n            }\r\n            );\r\n\r\n            this.formRef.current.setFieldsValue({\r\n              areas: this.state.areas\r\n            });\r\n          }\r\n        );\r\n    }\r\n    \r\n    removeAreaByStr(targetAreaStr) {\r\n        this.setState(prevState => {\r\n          return {\r\n            // Filter out the area / graph data corresponding to the target area\r\n            // string.\r\n            areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\r\n            mainGraphData: Object.keys(prevState.mainGraphData)\r\n              .filter(areaStr => areaStr !== targetAreaStr)\r\n              .reduce((newMainGraphData, areaStr) => {\r\n                return {\r\n                  ...newMainGraphData,\r\n                  [areaStr]: prevState.mainGraphData[areaStr]\r\n                };\r\n              }, {})\r\n          };\r\n        });\r\n    }\r\n    \r\n    onValuesChange(changedValues, allValues) {\r\n        // If we're here it means the user either added or deleted an area, so we\r\n        // can do a union / intersection to figure out what to add/remove.\r\n        const prevAreas = this.state.areas;\r\n        const newAreas = allValues.areas;\r\n        if (newAreas && prevAreas)\r\n        {\r\n            const areasToAdd = newAreas.filter(\r\n                areaStr => !prevAreas.includes(areaStr)\r\n                );\r\n                const areasToRemove = prevAreas.filter(\r\n                areaStr => !newAreas.includes(areaStr)\r\n                );\r\n        \r\n                areasToAdd.forEach(this.addAreaByStr);\r\n                areasToRemove.forEach(this.removeAreaByStr);\r\n        }\r\n        \r\n    }\r\n\r\n    onWeeksChange(weeks) {\r\n        this.setState({ weeks }, ()=>{\r\n            if (this.state.dynamicMapOn) {\r\n                this.map.fetchData(this.state.dynamicMapOn);\r\n            }    \r\n        });\r\n    }\r\n\r\n    bindRef = ref => { \r\n        this.map = ref \r\n    }\r\n\r\n\r\n    switchDynamicMap(checked) {\r\n        this.setState({\r\n          dynamicMapOn: checked\r\n        });\r\n        this.map.fetchData(checked);\r\n    }\r\n\r\n    //when closing the alert\r\n    onAlertClose = ()=>{\r\n        this.setState({\r\n        noDataError: false\r\n        });\r\n    }\r\n\r\n    //when encounter an no data error\r\n    onNoData = (name) =>{\r\n        this.setState({\r\n        noDataError: true,\r\n        errorDescription: `There is currently no data for ${name}`\r\n        })\r\n    }\r\n\r\n    generateMarks = ()=>{\r\n        const {weeks, lastDate, latestWeek, firstDate} = this.state;\r\n        let currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*weeks);\r\n        //get the date of the selected date on slider\r\n        let marks = {};\r\n        let i = 0;\r\n        while ( i <= 5 && weeks + i<=latestWeek)\r\n        {\r\n           marks[weeks+i] = `${currentDate.getMonth()+1}/${currentDate.getDate()}`;\r\n           currentDate.setDate(currentDate.getDate(Date) + 7);\r\n           i++;\r\n        }\r\n        i = 1\r\n        currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*(weeks-1));\r\n        while (i <= 5 && weeks - i >= 0)\r\n        {\r\n            marks[weeks - i] = `${currentDate.getMonth()+1}/${currentDate.getDate()}`;\r\n            currentDate.setDate(currentDate.getDate(Date) - 7);\r\n            i++;\r\n        }\r\n        currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*weeks);\r\n        return [currentDate, marks];\r\n      }\r\n\r\n    \r\n    handleScoreTypeSelect = e =>{\r\n        this.setState({\r\n            scoreType: e.target.value\r\n        }, ()=>{\r\n            const resetMap = true;\r\n            this.map.fetchData(this.state.dynamicMapOn, resetMap);\r\n        });\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            areas,\r\n            areasList,\r\n            weeks,\r\n            mainGraphData,\r\n            dynamicMapOn,\r\n            latestWeek,\r\n            noDataError,\r\n            errorDescription,\r\n            scoreType\r\n          } = this.state;\r\n        const countryOptions = areasList\r\n        .filter(area => !this.areaIsSelected(area))\r\n        .map(areaToStr)\r\n        .sort()\r\n        .map(s => {\r\n        return <Option key={s}> {s} </Option>;\r\n        });\r\n\r\n        const [currentDate, marks] = this.generateMarks();\r\n        const month = (currentDate.getMonth() + 1)<10?(`0${currentDate.getMonth() + 1}`):(currentDate.getMonth() + 1);\r\n        const date = (currentDate.getDate()<10)?(`0${currentDate.getDate()}`):currentDate.getDate();\r\n        const formatted_current_date = `${month}/${date}`;\r\n        return(\r\n            <div className=\"score-page\">\r\n                <Row type=\"flex\" justify=\"space-around\">\r\n                <Col span={10}>\r\n                    {noDataError?\r\n                        <Alert\r\n                        message= {`${errorDescription}`}\r\n                        description= \"Please wait for our updates.\"\r\n                        type=\"error\"\r\n                        closable\r\n                        onClose={this.onAlertClose}\r\n                        />: null\r\n                    }\r\n                    <div className=\"form-wrapper\">\r\n                        <Form\r\n                            ref={this.formRef}\r\n                            onValuesChange={this.onValuesChange}\r\n                        >\r\n                            <Form.Item\r\n                                label=\"Areas\"\r\n                                name=\"areas\"\r\n                                rules={[{ required: true, message: \"Please select areas!\" }]}\r\n                            >\r\n                                <Select\r\n                                mode=\"multiple\"\r\n                                style={{ width: \"100%\" }}\r\n                                placeholder=\"Select Areas\"\r\n                                >\r\n                                {countryOptions}\r\n                                </Select>\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"Week to check\"\r\n                                name=\"weeks\"\r\n                                rules={[\r\n                                { required: true, message: \"Please select the week you want to see\" }\r\n                                ]}\r\n                            >\r\n                                <Slider\r\n                                    marks={marks}\r\n                                    initialValue={weeks}\r\n                                    min ={weeks-5>=0?weeks-5: 0}\r\n                                    max={weeks+5<=latestWeek?weeks+5:latestWeek}\r\n                                    onAfterChange={this.onWeeksChange}\r\n                                />\r\n                            </Form.Item>\r\n                        </Form>\r\n                        <div className=\"radio-group\">Data Type:&nbsp;&nbsp;  \r\n                            <Radio.Group\r\n                                value={scoreType}\r\n                                onChange={this.handleScoreTypeSelect}\r\n                            >\r\n                                <Radio value=\"reproduction\">Dynamic Reproduction Number</Radio>\r\n                                <Radio value=\"mfr\">Model-based Fatality Rate</Radio>\r\n                            </Radio.Group>\r\n                        </div>\r\n                        <p>\r\n                        Dynamic Map:&nbsp;&nbsp;  \r\n                        <Switch \r\n                            onChange={this.switchDynamicMap} \r\n                        />\r\n                        </p>\r\n                    </div>\r\n                </Col>\r\n                <Col span={14}>\r\n                <div className=\"map-wrapper\">\r\n                    <ScoreMap className=\"score-map\"\r\n                    triggerRef={this.bindRef}\r\n                    dynamicMapOn={dynamicMapOn}\r\n                    weeks={weeks}\r\n                    latestWeek={latestWeek}\r\n                    onMapClick={this.onMapClick} \r\n                    onNoData = {this.onNoData}\r\n                    scoreType = {scoreType}\r\n                    />\r\n                </div>\r\n                </Col>\r\n                </Row>\r\n                {areas.length?\r\n                <Row>\r\n                <Col span={24}>\r\n                    <div className=\"graph-wrapper\">\r\n                    <NewScoreGraph\r\n                        data={mainGraphData}\r\n                        date={formatted_current_date}\r\n                        scoreType={scoreType}\r\n                    ></NewScoreGraph>\r\n                    </div>\r\n                </Col>\r\n                </Row>\r\n                : null}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ScorePage;","import React, { Component } from \"react\";\r\nimport {\r\n    Menu,\r\n    Row,\r\n    Col\r\n} from 'antd';\r\nimport \"./navbar.css\";\r\n\r\nclass NavBar extends Component {\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            activateItem: 'forecast'\r\n        };\r\n    }\r\n\r\n    handleItemClick = (e) => \r\n    {\r\n        const {redirectForecast, redirectAbout, redirectScore, redirectLeaderboard, redirectHighlights} = this.props;\r\n        const {key} = e;\r\n        this.setState({\r\n            activeItem: e.key\r\n        });\r\n        if (key === \"forecast\")\r\n        {\r\n            redirectForecast();\r\n        }\r\n        else if (key === \"information\")\r\n        {\r\n            redirectAbout();\r\n        }\r\n        else if (key === \"quarantine-score\")\r\n        {\r\n            redirectScore();\r\n        } else if (key === \"leaderboard\") {\r\n            redirectLeaderboard();\r\n        }\r\n        else if (key === \"highlights\") {\r\n            redirectHighlights();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let url = window.location.href;\r\n        return (\r\n            <Row className=\"navbar-container\">\r\n            <Col >\r\n                <img\r\n                    className=\"logo\"\r\n                    src=\"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png\"\r\n                    alt=\"USC\"\r\n                />\r\n            </Col>\r\n            <Col>\r\n                <Menu theme=\"light\"\r\n                    mode=\"horizontal\"\r\n                    onClick={this.handleItemClick}\r\n                    defaultSelectedKeys={\r\n                        url.includes(\"score\")?['quarantine-score']\r\n                        :url.includes(\"about\")?['information']\r\n                        :url.includes(\"leaderboard\")?['leaderboard']\r\n                        :url.includes(\"highlights\")?['highlights']\r\n                        :['forecast']\r\n                    }>\r\n                    <Menu.Item key=\"forecast\">COVID-19 Forecast</Menu.Item>\r\n                    <Menu.Item key=\"quarantine-score\">Reproduction Number</Menu.Item>\r\n                    <Menu.Item key=\"highlights\">Highlights</Menu.Item>\r\n                    <Menu.Item key=\"leaderboard\">Leaderboard</Menu.Item>\r\n                    <Menu.Item key=\"information\">About Us</Menu.Item>\r\n                </Menu>\r\n            </Col>\r\n        </Row>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NavBar;","import React, { Component } from \"react\";\r\nimport { List, Avatar, Row, Col } from 'antd';\r\nimport \"../covid19app.css\";\r\nimport \"./leaderboard.css\";\r\nimport nyt_graph from \"./img/nyt_graph.png\"\r\nimport jhu_graph from \"./img/jhu_graph.png\"\r\nimport usf_graph from \"./img/usf_graph.png\"\r\nimport all_graph from \"./img/all_graph.png\"\r\n\r\nconst data = {\r\n    jhu: {\r\nrunningAvgRankings: [\r\n    {\r\n     model: {\r\n name: \"SIkJa_USC\",\r\n description: \"This is our SI-kJalpha model.\",\r\n link: \"https://scc-usc.github.io/ReCOVER-COVID-19/\"\r\n},\r\n RMSE: 35.21\r\n},  {\r\n     model: {\r\n name: \"YYG_ParamSearch\",\r\n description: \"Based on the SEIR model to make daily projections regarding COVID-19 infections and deaths in 50 US states. The model's contributor is Youyang Gu.\",\r\n link: \"http://covid19-projections.com/about/\"\r\n},\r\n RMSE: 36.3\r\n},  {\r\n     model: {\r\n name: \"UCLA_SuEIR\",\r\n description: \"SEIR model by UCLA Statistical Machine Learning Lab.\",\r\n link: \"https://covid19.uclaml.org/\"\r\n},\r\n RMSE: 57.07\r\n},  {\r\n     model: {\r\n name: \"Covid19Sim_Simulator\",\r\n description: \"An interactive tool developed by researchers at Mass General Hospital, Harvard Medical School, Georgia Tech and Boston Medical Center.\",\r\n link: \"https://covid19sim.org/\"\r\n},\r\n RMSE: 64.88\r\n},  {\r\n     model: {\r\n name: \"CU_select\",\r\n description: \"A metapopulation county-level SEIR model by Columbia University.\",\r\n link: \"https://blogs.cuit.columbia.edu/jls106/publications/covid-19-findings-simulations/\"\r\n},\r\n RMSE: 68.17\r\n},  {\r\n     model: {\r\n name: \"JHU_IDD_CovidSP\",\r\n description: \"County-level metapopulation model by Johns Hopkins ID Dynamics COVID-19 Working Group.\",\r\n link: \"https://github.com/HopkinsIDD/COVIDScenarioPipeline\"\r\n},\r\n RMSE: 80.6\r\n},  {\r\n     model: {\r\n name: \"IowaStateLW_STEM\",\r\n description: \"A COVID19 forecast project led by Lily Wang in Iowa State University.\",\r\n link: \"https://covid19.stat.iastate.edu\"\r\n},\r\n RMSE: 84.1\r\n},  {\r\n     model: {\r\n name: \"CovidActNow_SEIR_CAN\",\r\n description: \"SEIR model by the CovidActNow research team.\",\r\n link: \"https://covidactnow.org/\"\r\n},\r\n RMSE: 110.82\r\n},],\r\nrecentRankings: [\r\n    {\r\n     model: {\r\n name: \"YYG_ParamSearch\",\r\n description: \"Based on the SEIR model to make daily projections regarding COVID-19 infections and deaths in 50 US states. The model's contributor is Youyang Gu.\",\r\n link: \"http://covid19-projections.com/about/\"\r\n},\r\n RMSE: 24.2\r\n},  {\r\n     model: {\r\n name: \"SIkJa_USC\",\r\n description: \"This is our SI-kJalpha model.\",\r\n link: \"https://scc-usc.github.io/ReCOVER-COVID-19/\"\r\n},\r\n RMSE: 25.41\r\n},  {\r\n     model: {\r\n name: \"UCLA_SuEIR\",\r\n description: \"SEIR model by UCLA Statistical Machine Learning Lab.\",\r\n link: \"https://covid19.uclaml.org/\"\r\n},\r\n RMSE: 28.03\r\n},  {\r\n     model: {\r\n name: \"Covid19Sim_Simulator\",\r\n description: \"An interactive tool developed by researchers at Mass General Hospital, Harvard Medical School, Georgia Tech and Boston Medical Center.\",\r\n link: \"https://covid19sim.org/\"\r\n},\r\n RMSE: 28.83\r\n},  {\r\n     model: {\r\n name: \"IowaStateLW_STEM\",\r\n description: \"A COVID19 forecast project led by Lily Wang in Iowa State University.\",\r\n link: \"https://covid19.stat.iastate.edu\"\r\n},\r\n RMSE: 35.14\r\n},  {\r\n     model: {\r\n name: \"CU_select\",\r\n description: \"A metapopulation county-level SEIR model by Columbia University.\",\r\n link: \"https://blogs.cuit.columbia.edu/jls106/publications/covid-19-findings-simulations/\"\r\n},\r\n RMSE: 36.93\r\n},  {\r\n     model: {\r\n name: \"JHU_IDD_CovidSP\",\r\n description: \"County-level metapopulation model by Johns Hopkins ID Dynamics COVID-19 Working Group.\",\r\n link: \"https://github.com/HopkinsIDD/COVIDScenarioPipeline\"\r\n},\r\n RMSE: 45.56\r\n},  {\r\n     model: {\r\n name: \"CovidActNow_SEIR_CAN\",\r\n description: \"SEIR model by the CovidActNow research team.\",\r\n link: \"https://covidactnow.org/\"\r\n},\r\n RMSE: NaN\r\n},]\r\n    }\r\n};\r\n\r\nclass Leaderboard extends Component {\r\n    getAvatar(number) {\r\n        let icon_src = \"\";\r\n        switch (number) {\r\n            case 1:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal2.png\";\r\n                break;\r\n            case 2:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal-second-place.png\";\r\n                break;\r\n            case 3:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal2-third-place.png\";\r\n                break;\r\n            default:\r\n                icon_src = \"https://img.icons8.com/carbon-copy/100/000000/\" + number + \"-circle.png\";\r\n                break;\r\n        }\r\n\r\n        return <Avatar className=\"rank-number\" src={icon_src} alt=\"\" />;\r\n\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"page-wrapper\">\r\n                <div className=\"grid\">\r\n                    <Row>\r\n                        \r\n                        <Col span={12}>\r\n                            <h2 className=\"title\">Running Average Performance</h2>\r\n                            <List className=\"leaderboard\"\r\n                                itemLayout=\"horizontal\"\r\n                                dataSource={data.jhu.runningAvgRankings}\r\n                                renderItem={item => (\r\n                                    <List.Item>\r\n                                        <List.Item.Meta\r\n                                            avatar={this.getAvatar(data.jhu.runningAvgRankings.indexOf(item) + 1)}\r\n                                            title={<a className=\"model-name\" href={item.model.link}>{item.model.name}</a>}\r\n                                            description={item.model.description}\r\n                                        />\r\n                                        <div className=\"content\">\r\n                                            <span>RMSE: <span className=\"score\">{item.RMSE}</span></span>\r\n                                        </div>\r\n                                    </List.Item>\r\n                                )}\r\n                            />\r\n                        </Col>\r\n                        <Col span={12}>\r\n                            <h2 className=\"title\">Recent Performance (from 2020-08-30)</h2>\r\n                            <List className=\"leaderboard\"\r\n                                itemLayout=\"horizontal\"\r\n                                dataSource={data.jhu.recentRankings}\r\n                                renderItem={item => (\r\n                                    <List.Item>\r\n                                        <List.Item.Meta\r\n                                            avatar={this.getAvatar(data.jhu.recentRankings.indexOf(item) + 1)}\r\n                                            title={<a className=\"model-name\" href={item.model.link}>{item.model.name}</a>}\r\n                                            description={item.model.description}\r\n                                        />\r\n                                        <div className=\"content\">\r\n                                            <span>RMSE: <span className=\"score\">{item.RMSE}</span></span>\r\n                                        </div>\r\n                                    </List.Item>\r\n                                )}\r\n                            />\r\n                        </Col>\r\n                    </Row> \r\n\r\n                    <Row>\r\n                        <div className=\"main-graph-container\">\r\n                            <img className=\"graph\" src={all_graph} />\r\n                        </div>\r\n                        \r\n                    </Row>\r\n\r\n\t\t            <p className=\"clarification\">\r\n                        <b>Evaluation method:</b> We have recently moved the evaluation to JHU dataset only as majority of the forecasting teams are now using it. <br />\r\n                        Our forecasts used here are taken from the our <a href='https://github.com/scc-usc/ReCOVER-COVID-19/tree/master/results/forecasts'> github repo </a>.\r\n                        The chosen evaluation metric is Root Mean Squared Error (RMSE) of weekly new deaths computed <br />\r\n                        over the next two weeks from the day of the forecasts. <br />\r\n                        Please contact us at <a className=\"article-anchor\" href=\"mailto:ajiteshs@usc.edu\">ajiteshs@usc.edu</a>  \r\n                        to add your model to the leaderboard.\r\n                    </p>\r\n                    <p className=\"disclaimer\">\r\n                        <b>Disclaimer:</b> The above Covid-19 forecast reports may have copyright restrictions. \r\n                        You may visit the website of their original work by clicking on their model names. <br />\r\n                        All credits for predictions go to the respective owners of the forecast reports.\r\n                        The ReCover-Covid-19 website does not hold responsibility or liability for prediction accuracy\r\n                        of prediction reports that are not generated by USC Data Science lab.\r\n                    </p> \r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Leaderboard;","import React, { useState } from \"react\";\r\nimport { Document, Page, pdfjs} from \"react-pdf\";\r\nimport \"./all_page_pdf.css\";\r\nimport { SizeMe } from 'react-sizeme';\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\n\r\nexport default function AllPages(props) {\r\n  const [numPages, setNumPages] = useState(null);\r\n\r\n  function onDocumentLoadSuccess({ numPages }) {\r\n    setNumPages(numPages);\r\n    removeTextLayerOffset();\r\n  }\r\n  \r\n  function removeTextLayerOffset() {\r\n    const textLayers = document.querySelectorAll(\".react-pdf__Page__textContent\");\r\n      textLayers.forEach(layer => {\r\n        const { style } = layer;\r\n        style.top = \"0\";\r\n        style.left = \"0\";\r\n        style.transform = \"\";\r\n    });\r\n  }\r\n\r\n  const { pdf } = props;\r\n  return (\r\n    <SizeMe \r\n      monitorHeight\r\n      refreshRate={128}\r\n      refreshMode={\"debounce\"}\r\n      render={({ size }) =>\r\n      <div>\r\n        <Document\r\n          file={pdf}\r\n          options={{ workerSrc: \"pdf.worker.js\" }}\r\n          onLoadSuccess={onDocumentLoadSuccess}\r\n        >\r\n          {Array.from(new Array(numPages), (el, index) => (\r\n              <Page width = {size.width} key={`page_${index + 1}`} pageNumber={index + 1} />\r\n          ))}\r\n        </Document>\r\n      </div>\r\n    }\r\n    />\r\n  );\r\n}","import React, { Component } from \"react\";\r\nimport Covid19Predict from \"./covid19predict\";\r\nimport AboutUS from \"./aboutus\";\r\nimport ScorePage from './scorePage/scorePage';\r\nimport {HashRouter, Route, Redirect, Switch} from 'react-router-dom'; \r\nimport Navbar from \"./navbar/navbar\";\r\nimport 'semantic-ui-css/semantic.min.css';\r\nimport \"./covid19app.css\";\r\nimport Leaderboard from \"./leaderboard/leaderboard\";\r\nimport AllPage from \"./all_page_pdf/all_page_pdf\";\r\n\r\nimport pdf from \"./highlights.pdf\";\r\n\r\nclass Covid19App extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    }\r\n  }\r\n\r\n  redirectForecast = ()=>{\r\n    this.setState({\r\n      redirectForecast:true,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectAbout = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout:true,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectScore = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout:false,\r\n      redirectScore: true,\r\n      redirectHighlights: false,\r\n      redirectLeaderboard: false\r\n    });\r\n  }\r\n\r\n  redirectLeaderboard = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: true,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectHighlights = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: true\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {redirectForecast, redirectAbout, redirectScore, redirectLeaderboard, redirectHighlights} = this.state;\r\n    return (\r\n      <HashRouter basename=\"/\">\r\n        {redirectForecast?<Redirect to=\"/\"/>:null}\r\n        {redirectHighlights?<Redirect to=\"/highlights\"/>:null}\r\n        {redirectScore?<Redirect to=\"/score\"/>:null}\r\n        {redirectAbout?<Redirect to=\"/about\"/>:null}\r\n        {redirectLeaderboard?<Redirect to=\"/leaderboard\"/>:null}\r\n        <Navbar redirectForecast = {this.redirectForecast}\r\n        \t\tredirectHighlights = {this.redirectHighlights}\r\n                redirectScore = {this.redirectScore}\r\n                redirectAbout = {this.redirectAbout}\r\n                redirectLeaderboard = {this.redirectLeaderboard}\r\n        />\r\n        <Switch>\r\n          <Route exact path='/' \r\n            render={(props) => <Covid19Predict {...props} />}/>\r\n          <Route exact path='/score' \r\n            render={(props) => <ScorePage {...props}/>}\r\n          />\r\n          <Route exact path='/about'\r\n            render={(props) => <AboutUS {...props} />} />\r\n          <Route exact path='/leaderboard' \r\n            render={(props) => <Leaderboard {...props} />}/>\r\n          <Route exact path='/highlights'>\r\n             <AllPage pdf={pdf}/>\r\n          </Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport Covid19App from \"./covid19app\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(<Covid19App />, document.getElementById(\"root\"));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 304;","module.exports = __webpack_public_path__ + \"static/media/all_graph.8651bee5.png\";","module.exports = __webpack_public_path__ + \"static/media/highlights.37456599.pdf\";","module.exports = __webpack_public_path__ + \"static/media/nyt_graph.b82f8664.png\";","module.exports = __webpack_public_path__ + \"static/media/jhu_graph.39518de8.png\";","module.exports = __webpack_public_path__ + \"static/media/usf_graph.35c9b379.png\";"],"sourceRoot":""}