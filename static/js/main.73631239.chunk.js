(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{391:function(e,a,t){},458:function(e,a,t){e.exports=t(715)},463:function(e,a,t){},715:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),i=t(56),s=t.n(i),c=(t(463),t(44)),o=t(40),l=t(99),u=t(98),d=(t(464),t(317)),h=(t(466),t(208)),m=(t(468),t(421)),p=(t(470),t(147)),f=(t(472),t(259)),v=(t(474),t(420)),g=(t(716),t(179)),y=(t(320),t(200)),b=t(195),S=t(128),E=t(201),k=t(112),O=(t(717),t(257)),w=t(74),C=t(392),D=t(205),j=t.n(D),x=t(314),A=t.n(x),M=t(130);var P=function(e){var a=e.series,t=e.lineGenerator,n=e.xScale,i=e.yScale;return a.map((function(e){var a=e.id,s=e.data,c=e.color,o=e.predicted,l=e.distancing,u={strokeWidth:3};return o&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:a,d:t(s.map((function(e){return{x:n(e.data.x),y:i(e.data.y)}}))),fill:"none",stroke:c,style:u})}))},I={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},N=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"parseDate",value:function(e){var a=e.split("-").map(Number),t=Object(w.a)(a,3),n=t[0],r=t[1],i=t[2];return new Date(n,r-=1,i)}},{key:"getCumulativeData",value:function(e){var a=this;return e.map((function(e){return{x:a.parseDate(e.date),y:e.value}}))}},{key:"getDeltaData",value:function(e,a){var t=this;return e.map((function(n,r){return 0===r?{x:t.parseDate(n.date),y:n.value-a}:{x:t.parseDate(n.date),y:n.value-e[r-1].value}}))}},{key:"processData",value:function(e,a){var t=a.statistic,n=a.yScale,r=a.initialVal,i="delta"===t?this.getDeltaData(e,r):this.getCumulativeData(e);return"log"===n&&(i=i.filter((function(e){e.x;return e.y>0}))),i}},{key:"getDataMax",value:function(){var e=this.props.data,a=0;return Object.keys(e).forEach((function(t){var n=e[t],r=n.observed,i=n.predictions;a=Math.max(a,Math.max.apply(Math,Object(E.a)(r.map((function(e){return e.value}))))),i.forEach((function(e){var t=e.time_series;a=Math.max(a,Math.max.apply(Math,Object(E.a)(t.map((function(e){return e.value})))))}))})),a}},{key:"getYAxisProps",value:function(){for(var e=this.props,a=e.statistic,t=e.yScale,n={format:function(e){return A()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===a?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},r=[],i=0;i<=Math.ceil(Math.log10(this.getDataMax()));i++)r.push(Math.pow(10,i));var s=Object(S.a)(Object(S.a)({},n),{},{tickValues:r});return"log"===t?{axisLeft:s,gridYValues:r,yScale:{type:"log",base:10,min:Math.min.apply(Math,r),max:Math.max.apply(Math,r)}}:{axisLeft:n,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,a=this.props.data,t=this.props,n=t.statistic,i=t.yScale,s=[],c=[];Object.keys(a).sort().forEach((function(t,r){var o=function(e){var a=[M.red.primary,M.gold.primary,M.lime.primary,M.cyan.primary,M.geekblue.primary,M.purple.primary,M.magenta.primary];return a[e%a.length]}(r),l=a[t].observed;s.push({id:t,data:e.processData(l,{statistic:n,yScale:i,initialVal:0}),predicted:!1}),c.push(o),a[t].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(a){a.model.name;var r=a.distancing,u=a.time_series;s.push({id:"".concat(t," (").concat(a.model.name,", distancing=").concat(r,")"),data:e.processData(u,{statistic:n,yScale:i,initialVal:l[l.length-1].value}),predicted:!0,distancing:r}),c.push(o)}))}));var o="every week";if(s.length>0){var l=s[0].data[0].x,u=s[0].data[0].x;s.forEach((function(e){e.data.forEach((function(e){var a=e.x;l=Math.min(l,a),u=Math.max(u,a)}))})),l=j()(l),(u=j()(u)).diff(l,"days")>150&&(o="every month")}return r.a.createElement(C.a,Object.assign({data:s,colors:c,margin:{top:50,right:50,bottom:50,left:80},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:o,format:function(e){return j()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var a=e.slice;return r.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},r.a.createElement("div",null,j()(a.points[0].data.x).format("MMM Do YYYY")),a.points.map((function(e){return r.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},r.a.createElement("strong",null,e.serieId),"[",A()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",P,"slices","points","axes","legends"],theme:I}))}}]),t}(n.Component),R=t(178),V=t.n(R),T="https://dslab-covid19-backend.herokuapp.com/api",_=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var a="".concat(T,"/areas");V.a.get(a).then((function(a){var t=a.data;console.log(t),e(t)}))}},{key:"models",value:function(e){var a="".concat(T,"/models");V.a.get(a).then((function(a){var t=a.data;console.log(t),e(t)}))}},{key:"cumulative_infections",value:function(e){var a="".concat(T,"/cumulative_infections");V.a.get(a).then((function(a){return e(a.data)}))}},{key:"predict_all",value:function(e,a){var t="".concat(T,"/predict_all");V.a.get(t,{params:e}).then((function(e){return a(e.data)}))}},{key:"predict",value:function(e,a){var t="".concat(T,"/predict");console.log(e),V.a.get(t,{params:e}).then((function(e){a(e.data)}))}}]),e}();function L(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}var B=t(103),F=t(206),G=t(315),z=t(316),Y=t(404),U=t(405),W=t(406),q=t(422);B.e(q.a);var H=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){var e;return Object(c.a)(this,t),(e=a.call(this)).modelAPI=new _,e.modelAPI.areas((function(a){return e.setState({areasList:a})})),e}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn)}},{key:"fetchData",value:function(e){var a=this;e&&""!==this.props.model?this.modelAPI.predict_all({days:this.props.days,model:this.props.model},(function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.resetChart)})):this.modelAPI.cumulative_infections((function(e){var t=e.map((function(e){return{id:e.area.iso_2,value:e.value>0?Math.log(e.value):0,valueTrue:e.value,area:e.area}}));a.setState({heatmapData:t},a.createChart)}))}},{key:"initChart",value:function(){this.chart=B.d("chartdiv",F.a),this.chart.projection=new F.d.Mercator}},{key:"createChartSeries",value:function(e){var a=this.chart.series.push(new F.b),t=(a=Object.assign(a,e)).mapPolygons.template;a.heatRules.push({property:"fill",target:t,min:B.c("#fcbba0"),max:B.c("#66000d"),maxValue:Math.log(5e6)}),t.tooltipText="{name}: {valueTrue}",t.nonScalingStroke=!0,t.strokeWidth=.5,t.states.create("hover").properties.fill=B.c("#e43027"),t.cursorOverStyle=B.b.pointer;var n=this.props.onMapClick;return t.events.on("hit",(function(e){var a=e.target.dataItem.dataContext,t=(a.id,a.value,a.area);n(t)})),a}},{key:"initChartInterface",value:function(){var e=this;this.chart.zoomControl=new F.c,this.chart.zoomControl.cursorOverStyle=B.b.pointer;var a=this.chart.chartContainer.createChild(B.a);a.label.text="Show States/Provinces",a.togglable=!0,a.padding(5,5,5,5),a.align="right",a.marginRight=15,a.cursorOverStyle=B.b.pointer,a.events.on("hit",(function(){e.stateSeries.forEach((function(e){return e.disabled=!a.isActive})),a.label.text="".concat(a.isActive?"Hide":"Show"," States/Provinces")}))}},{key:"createChart",value:function(){var e=this.state.heatmapData;this.initChart();this.createChartSeries({geodata:G.a,exclude:["AQ"],data:e});var a=this.createChartSeries({geodata:Y.a,data:e,disabled:!0}),t=this.createChartSeries({geodata:z.a,data:e,disabled:!0}),n=this.createChartSeries({geodata:U.a,data:e,disabled:!0}),r=this.createChartSeries({geodata:W.a,data:e,disabled:!0});this.stateSeries=[a,t,n,r],this.initChartInterface()}},{key:"resetChart",value:function(){var e=this.state.heatmapData,a=(this.createChartSeries({geodata:G.a,exclude:["AQ"],data:e}),this.createChartSeries({geodata:z.a,data:e,disabled:!0}));this.stateSeries=[a]}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return r.a.createElement("div",{id:"chartdiv"})}}]),t}(n.Component),J=O.a.Option,K=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(c.a)(this,t),(n=a.call(this,e)).handleYScaleSelect=function(e){n.setState({yScale:e.target.value})},n.handleStatisticSelect=function(e){n.setState({statistic:e.target.value})},n.bindRef=function(e){n.map=e},n.formRef=r.a.createRef(),n.modelAPI=new _,n.modelAPI.areas((function(e){return n.setState({areasList:e})})),n.modelAPI.models((function(e){return n.setState({modelsList:e})})),n.state={areas:n.props.areas||[],areasList:[],models:n.props.models||[],modelsList:[],distancingOn:!0,distancingOff:!1,mainGraphData:{},days:10,dynamicMapOn:!1,statistic:"cumulative",yScale:"linear"},n.addAreaByStr=n.addAreaByStr.bind(Object(k.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(k.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(k.a)(n)),n.onMapClick=n.onMapClick.bind(Object(k.a)(n)),n.onDaysToPredictChange=n.onDaysToPredictChange.bind(Object(k.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(k.a)(n)),n}return Object(o.a)(t,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(L(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var a=L(e);return this.state.areas.includes(a)}return!1}},{key:"addAreaByStr",value:function(e){var a=this,t=function(e){var a=e.split("/");return{country:a[0].trim(),state:2===a.length?a[1].trim():""}}(e);this.setState((function(a){return{areas:[].concat(Object(E.a)(a.areas),[e])}}),(function(){a.modelAPI.predict({state:t.state,country:t.country,models:a.state.models,days:a.state.days,distancingOn:a.state.distancingOn,distancingOff:a.state.distancingOff},(function(t){a.setState((function(a){return{mainGraphData:Object(S.a)(Object(S.a)({},a.mainGraphData),{},Object(b.a)({},e,t))}}))})),a.formRef.current.setFieldsValue({areas:a.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(a){return{areas:a.areas.filter((function(a){return a!==e})),mainGraphData:Object.keys(a.mainGraphData).filter((function(a){return a!=e})).reduce((function(e,t){return Object(S.a)(Object(S.a)({},e),{},Object(b.a)({},t,a.mainGraphData[t]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var a="".concat(e.name);return this.state.models.includes(a)}return!1}},{key:"onValuesChange",value:function(e,a){var t=this;if("socialDistancing"in e||"models"in e)this.setState({models:a.models,distancingOn:a.socialDistancing.includes("distancingOn"),distancingOff:a.socialDistancing.includes("distancingOff")},(function(){t.reloadAll()}));else{var n=this.state.areas,r=a.areas,i=r.filter((function(e){return!n.includes(e)})),s=n.filter((function(e){return!r.includes(e)}));i.forEach(this.addAreaByStr),s.forEach(this.removeAreaByStr)}}},{key:"onDaysToPredictChange",value:function(e){var a=this;this.state.areas;this.setState({days:e},(function(){a.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,a=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){a.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,a=this.state,t=a.areas,n=a.areasList,i=a.modelsList,s=a.days,c=a.mainGraphData,o=(a.dynamicMapOn,a.statistic),l=a.yScale,u=n.filter((function(a){return!e.areaIsSelected(a)})).map(L).sort().map((function(e){return r.a.createElement(J,{key:e}," ",e," ")})),d=i.filter((function(a){return!e.modelIsSelected(a)})).map((function(e){return r.a.createElement(J,{key:e.name},r.a.createElement(y.a,{title:e.description,placement:"right"},e.name))}));return r.a.createElement("div",{className:"covid-19-predict"},r.a.createElement("div",{className:"left-col"},r.a.createElement("div",{className:"form-wrapper"},r.a.createElement(g.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:t,days:10,socialDistancing:["distancingOn"]}},r.a.createElement(g.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},u)),r.a.createElement(g.a.Item,{label:"Under-reporting Cases:",name:"models",rules:[{required:!0,message:"Please select reporting ratio!"}]},r.a.createElement(O.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Reporting Ratio"},d)),r.a.createElement(g.a.Item,{label:"Days to Predict",name:"days",rules:[{required:!0,message:"Please select number of days!"}]},r.a.createElement(v.a,{min:0,initialValue:15,max:99,onAfterChange:this.onDaysToPredictChange})),r.a.createElement(y.a,{title:'The trend until March 18th has been used as a proxy for "Social distancing off".  For modeling details, please see: https://arxiv.org/abs/2004.11372',placement:"topLeft"},r.a.createElement(g.a.Item,{label:"Social Distancing",name:"socialDistancing"},r.a.createElement(f.a.Group,null,r.a.createElement(f.a,{defaultChecked:!0,value:"distancingOn"},"On"),r.a.createElement(f.a,{value:"distancingOff"},"Off"))))),r.a.createElement("div",null,"Statistic:\xa0\xa0",r.a.createElement(p.a.Group,{value:o,onChange:this.handleStatisticSelect},r.a.createElement(p.a,{value:"cumulative"},"Cumulative Cases"),r.a.createElement(p.a,{value:"delta"},"New Cases"))),r.a.createElement("br",null),r.a.createElement("div",null,"Scale:\xa0\xa0",r.a.createElement(p.a.Group,{value:l,onChange:this.handleYScaleSelect},r.a.createElement(p.a,{value:"linear"},"linear"),r.a.createElement(p.a,{value:"log"},"logarithmic"))),r.a.createElement("br",null),r.a.createElement("p",null,"Dynamic Map:\xa0\xa0",r.a.createElement(m.a,{onChange:this.switchDynamicMap}))),r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(H,{triggerRef:this.bindRef,dynamicMapOn:this.state.dynamicMapOn,days:s,model:null==this.state.models||0===this.state.models.length?"":this.state.models[this.state.models.length-1],onMapClick:this.onMapClick}))),r.a.createElement("div",{className:"right-col"},r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(N,{data:c,statistic:o,yScale:l}))))}}]),t}(n.PureComponent),X=(t(391),function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"article"},r.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),r.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is a NSF-funded project on COVID-19 forecasting directed by Viktor K. Prasanna (",r.a.createElement("a",{href:"mailto:prasanna@usc.edu"},"prasanna@usc.edu"),") and Ajitesh Srivastava (",r.a.createElement("a",{href:"mailto:ajiteshs@usc.edu"},"ajiteshs@usc.edu"),") from the Data Science Lab in the University of Southern California."),r.a.createElement("h2",null,"Our Model"),r.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called SI-kJalpha -- Heterogeneous Infection Rate with Human Mobility, which is a preliminary version of what we have successfully used during ",r.a.createElement("a",{href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". By linearizing the model and using weighted least squares, our model is able to quickly adapt to changing trends and provide extremely accurate predictions of confirmed cases at the level of countries and states of the United States. Training the model to forecast also enables learning characteristics of the epidemic. In particular, we have shown that changes in model parameters over time can help us quantify how well a state or a country has responded to the epidemic. The variations in parameters also allow us to forecast different scenarios such as what would happen if we were to disregard social distancing suggestions. This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),r.a.createElement("p",{className:"article-paragraph"},"Details of our initial approach can be found in our ",r.a.createElement("a",{href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"webinar"),"."),r.a.createElement("p",{className:"article-paragraph"},"The Github repository for this project is ",r.a.createElement("a",{href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"},"publicly available")," ."),r.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available of ",r.a.createElement("a",{href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),"."),r.a.createElement("p",{className:"article-paragraph"},"The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, and Frost Tianjian Xu."),r.a.createElement("h2",null,"USC Data Science Lab"),r.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",r.a.createElement("a",{href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),"."),r.a.createElement("h2",null,"Related Publications"),r.a.createElement("p",{className:"disclaimer"},r.a.createElement("b",null,"Disclaimer:")," The following papers may have copyright restrictions. Downloads will have to adhere to these restrictions. They may not be reposted without explicit permission from the copyright holder. Any opinions, findings, and conclusions or recommendations expressed in these materials are those of the author(s) and do not necessarily reflect the views of the sponsors including National Science Foundation (NSF), Defense Advanced Research Projects Agency (DARPA), and any other sponsors listed in the publications."),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{href:"https://arxiv.org/abs/2004.11372",target:"_blank"}," \u201cLearning to Forecast and Forecasting to Learn from the COVID-19 Pandemic\u201d")," [arXiv]."),r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{href:"https://arxiv.org/abs/2004.12250",target:"_blank"}," \u201cAgent-Level Pandemic Simulation (ALPS) for Analyzing Effects of Lockdown Measures\u201d")," [arXiv]."))))}}]),t}(n.Component)),Q=(h.a.Header,h.a.Content,h.a.Footer,d.a.TabPane),$=function(e){Object(l.a)(t,e);var a=Object(u.a)(t);function t(){return Object(c.a)(this,t),a.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(h.a,{className:"app-layout"},r.a.createElement(d.a,{className:"nav-bar",defaultActiveKey:"1",type:"card"},r.a.createElement(Q,{tab:r.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})}),r.a.createElement(Q,{tab:"Covid-19 Forecast",key:"1"},r.a.createElement(K,null)),r.a.createElement(Q,{tab:"About us",key:"2"},r.a.createElement(X,null)))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[458,1,3]]]);
//# sourceMappingURL=main.73631239.chunk.js.map